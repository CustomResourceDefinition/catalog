{
  "description": "The `PrometheusRule` custom resource definition (CRD) defines [alerting](https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules/) and [recording](https://prometheus.io/docs/prometheus/latest/configuration/recording_rules/) rules to be evaluated by `Prometheus` or `ThanosRuler` objects.\n\n`Prometheus` and `ThanosRuler` objects select `PrometheusRule` objects using label and namespace selectors.",
  "type": "object",
  "required": [
    "spec"
  ],
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object.\nServers should convert recognized schemas to the latest internal value, and\nmay reject unrecognized values.\nMore info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": "string"
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents.\nServers may infer this from the endpoint the client submits requests to.\nCannot be updated.\nIn CamelCase.\nMore info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "description": "spec defines the specification of desired alerting rule definitions for Prometheus.",
      "type": "object",
      "properties": {
        "groups": {
          "description": "groups defines the content of Prometheus rule file",
          "type": "array",
          "items": {
            "description": "RuleGroup is a list of sequentially evaluated recording and alerting rules.",
            "type": "object",
            "required": [
              "name"
            ],
            "properties": {
              "interval": {
                "description": "interval defines how often rules in the group are evaluated.",
                "type": "string",
                "pattern": "^(0|(([0-9]+)y)?(([0-9]+)w)?(([0-9]+)d)?(([0-9]+)h)?(([0-9]+)m)?(([0-9]+)s)?(([0-9]+)ms)?)$"
              },
              "labels": {
                "description": "labels define the labels to add or overwrite before storing the result for its rules.\nThe labels defined at the rule level take precedence.\n\nIt requires Prometheus \u003e= 3.0.0.\nThe field is ignored for Thanos Ruler.",
                "type": "object",
                "additionalProperties": {
                  "type": "string"
                }
              },
              "limit": {
                "description": "limit defines the number of alerts an alerting rule and series a recording\nrule can produce.\nLimit is supported starting with Prometheus \u003e= 2.31 and Thanos Ruler \u003e= 0.24.",
                "type": "integer"
              },
              "name": {
                "description": "name defines the name of the rule group.",
                "type": "string",
                "minLength": 1
              },
              "partial_response_strategy": {
                "description": "partial_response_strategy is only used by ThanosRuler and will\nbe ignored by Prometheus instances.\nMore info: https://github.com/thanos-io/thanos/blob/main/docs/components/rule.md#partial-response",
                "type": "string",
                "pattern": "^(?i)(abort|warn)?$"
              },
              "query_offset": {
                "description": "query_offset defines the offset the rule evaluation timestamp of this particular group by the specified duration into the past.\n\nIt requires Prometheus \u003e= v2.53.0.\nIt is not supported for ThanosRuler.",
                "type": "string",
                "pattern": "^(0|(([0-9]+)y)?(([0-9]+)w)?(([0-9]+)d)?(([0-9]+)h)?(([0-9]+)m)?(([0-9]+)s)?(([0-9]+)ms)?)$"
              },
              "rules": {
                "description": "rules defines the list of alerting and recording rules.",
                "type": "array",
                "items": {
                  "description": "Rule describes an alerting or recording rule\nSee Prometheus documentation: [alerting](https://www.prometheus.io/docs/prometheus/latest/configuration/alerting_rules/) or [recording](https://www.prometheus.io/docs/prometheus/latest/configuration/recording_rules/#recording-rules) rule",
                  "type": "object",
                  "required": [
                    "expr"
                  ],
                  "properties": {
                    "alert": {
                      "description": "alert defines the name of the alert. Must be a valid label value.\nOnly one of `record` and `alert` must be set.",
                      "type": "string"
                    },
                    "annotations": {
                      "description": "annotations defines annotations to add to each alert.\nOnly valid for alerting rules.",
                      "type": "object",
                      "additionalProperties": {
                        "type": "string"
                      }
                    },
                    "expr": {
                      "description": "expr defines the PromQL expression to evaluate.",
                      "anyOf": [
                        {
                          "type": "integer"
                        },
                        {
                          "type": "string"
                        }
                      ],
                      "x-kubernetes-int-or-string": true
                    },
                    "for": {
                      "description": "for defines how alerts are considered firing once they have been returned for this long.",
                      "type": "string",
                      "pattern": "^(0|(([0-9]+)y)?(([0-9]+)w)?(([0-9]+)d)?(([0-9]+)h)?(([0-9]+)m)?(([0-9]+)s)?(([0-9]+)ms)?)$"
                    },
                    "keep_firing_for": {
                      "description": "keep_firing_for defines how long an alert will continue firing after the condition that triggered it has cleared.",
                      "type": "string",
                      "minLength": 1,
                      "pattern": "^(0|(([0-9]+)y)?(([0-9]+)w)?(([0-9]+)d)?(([0-9]+)h)?(([0-9]+)m)?(([0-9]+)s)?(([0-9]+)ms)?)$"
                    },
                    "labels": {
                      "description": "labels defines labels to add or overwrite.",
                      "type": "object",
                      "additionalProperties": {
                        "type": "string"
                      }
                    },
                    "record": {
                      "description": "record defines the name of the time series to output to. Must be a valid metric name.\nOnly one of `record` and `alert` must be set.",
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                }
              }
            },
            "additionalProperties": false
          },
          "x-kubernetes-list-map-keys": [
            "name"
          ],
          "x-kubernetes-list-type": "map"
        }
      },
      "additionalProperties": false
    },
    "status": {
      "description": "status defines the status subresource. It is under active development and is updated only when the\n\"StatusForConfigurationResources\" feature gate is enabled.\n\nMost recent observed status of the PrometheusRule. Read-only.\nMore info:\nhttps://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#spec-and-status",
      "type": "object",
      "properties": {
        "bindings": {
          "description": "bindings defines the list of workload resources (Prometheus, PrometheusAgent, ThanosRuler or Alertmanager) which select the configuration resource.",
          "type": "array",
          "items": {
            "description": "WorkloadBinding is a link between a configuration resource and a workload resource.",
            "type": "object",
            "required": [
              "group",
              "name",
              "namespace",
              "resource"
            ],
            "properties": {
              "conditions": {
                "description": "conditions defines the current state of the configuration resource when bound to the referenced Workload object.",
                "type": "array",
                "items": {
                  "description": "ConfigResourceCondition describes the status of configuration resources linked to Prometheus, PrometheusAgent, Alertmanager or ThanosRuler.",
                  "type": "object",
                  "required": [
                    "lastTransitionTime",
                    "status",
                    "type"
                  ],
                  "properties": {
                    "lastTransitionTime": {
                      "description": "lastTransitionTime defines the time of the last update to the current status property.",
                      "type": "string",
                      "format": "date-time"
                    },
                    "message": {
                      "description": "message defines the human-readable message indicating details for the condition's last transition.",
                      "type": "string"
                    },
                    "observedGeneration": {
                      "description": "observedGeneration defines the .metadata.generation that the\ncondition was set based upon. For instance, if `.metadata.generation` is\ncurrently 12, but the `.status.conditions[].observedGeneration` is 9, the\ncondition is out of date with respect to the current state of the object.",
                      "type": "integer",
                      "format": "int64"
                    },
                    "reason": {
                      "description": "reason for the condition's last transition.",
                      "type": "string"
                    },
                    "status": {
                      "description": "status of the condition.",
                      "type": "string",
                      "minLength": 1
                    },
                    "type": {
                      "description": "type of the condition being reported.\nCurrently, only \"Accepted\" is supported.",
                      "type": "string",
                      "minLength": 1,
                      "enum": [
                        "Accepted"
                      ]
                    }
                  },
                  "additionalProperties": false
                },
                "x-kubernetes-list-map-keys": [
                  "type"
                ],
                "x-kubernetes-list-type": "map"
              },
              "group": {
                "description": "group defines the group of the referenced resource.",
                "type": "string",
                "enum": [
                  "monitoring.coreos.com"
                ]
              },
              "name": {
                "description": "name defines the name of the referenced object.",
                "type": "string",
                "minLength": 1
              },
              "namespace": {
                "description": "namespace defines the namespace of the referenced object.",
                "type": "string",
                "minLength": 1
              },
              "resource": {
                "description": "resource defines the type of resource being referenced (e.g. Prometheus, PrometheusAgent, ThanosRuler or Alertmanager).",
                "type": "string",
                "enum": [
                  "prometheuses",
                  "prometheusagents",
                  "thanosrulers",
                  "alertmanagers"
                ]
              }
            },
            "additionalProperties": false
          },
          "x-kubernetes-list-map-keys": [
            "group",
            "resource",
            "name",
            "namespace"
          ],
          "x-kubernetes-list-type": "map"
        }
      },
      "additionalProperties": false
    }
  }
}
