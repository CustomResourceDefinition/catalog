{
  "properties": {
    "apiVersion": {
      "type": "string"
    },
    "kind": {
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "additionalProperties": false,
      "anyOf": [
        {
          "additionalProperties": false,
          "properties": {
            "ingress": {}
          },
          "required": [
            "ingress"
          ]
        },
        {
          "additionalProperties": false,
          "properties": {
            "ingressDeny": {}
          },
          "required": [
            "ingressDeny"
          ]
        },
        {
          "additionalProperties": false,
          "properties": {
            "egress": {}
          },
          "required": [
            "egress"
          ]
        },
        {
          "additionalProperties": false,
          "properties": {
            "egressDeny": {}
          },
          "required": [
            "egressDeny"
          ]
        }
      ],
      "oneOf": [
        {
          "additionalProperties": false,
          "properties": {
            "endpointSelector": {}
          },
          "required": [
            "endpointSelector"
          ]
        },
        {
          "additionalProperties": false,
          "properties": {
            "nodeSelector": {}
          },
          "required": [
            "nodeSelector"
          ]
        }
      ],
      "properties": {
        "description": {
          "type": "string"
        },
        "egress": {
          "items": {
            "additionalProperties": false,
            "properties": {
              "authentication": {
                "additionalProperties": false,
                "properties": {
                  "mode": {
                    "enum": [
                      "disabled",
                      "required",
                      "test-always-fail"
                    ],
                    "type": "string"
                  }
                },
                "required": [
                  "mode"
                ],
                "type": "object"
              },
              "icmps": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "fields": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "family": {
                            "default": "IPv4",
                            "enum": [
                              "IPv4",
                              "IPv6"
                            ],
                            "type": "string"
                          },
                          "type": {
                            "anyOf": [
                              {
                                "type": "integer"
                              },
                              {
                                "type": "string"
                              }
                            ],
                            "pattern": "^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]|EchoReply|DestinationUnreachable|Redirect|Echo|RouterAdvertisement|RouterSelection|TimeExceeded|ParameterProblem|Timestamp|TimestampReply|Photuris|ExtendedEchoRequest|ExtendedEcho Reply|PacketTooBig|ParameterProblem|EchoRequest|MulticastListenerQuery|MulticastListenerReport|MulticastListenerDone|RouterSolicitation|RouterAdvertisement|NeighborSolicitation|NeighborAdvertisement|RedirectMessage|RouterRenumbering|ICMPNodeInformationQuery|ICMPNodeInformationResponse|InverseNeighborDiscoverySolicitation|InverseNeighborDiscoveryAdvertisement|HomeAgentAddressDiscoveryRequest|HomeAgentAddressDiscoveryReply|MobilePrefixSolicitation|MobilePrefixAdvertisement|DuplicateAddressRequestCodeSuffix|DuplicateAddressConfirmationCodeSuffix)$",
                            "x-kubernetes-int-or-string": true
                          }
                        },
                        "required": [
                          "type"
                        ],
                        "type": "object"
                      },
                      "maxItems": 40,
                      "type": "array"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "toCIDR": {
                "items": {
                  "format": "cidr",
                  "type": "string"
                },
                "type": "array"
              },
              "toCIDRSet": {
                "items": {
                  "additionalProperties": false,
                  "oneOf": [
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidr": {}
                      },
                      "required": [
                        "cidr"
                      ]
                    },
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidrGroupRef": {}
                      },
                      "required": [
                        "cidrGroupRef"
                      ]
                    },
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidrGroupSelector": {}
                      },
                      "required": [
                        "cidrGroupSelector"
                      ]
                    }
                  ],
                  "properties": {
                    "cidr": {
                      "format": "cidr",
                      "type": "string"
                    },
                    "cidrGroupRef": {
                      "maxLength": 253,
                      "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$",
                      "type": "string"
                    },
                    "cidrGroupSelector": {
                      "additionalProperties": false,
                      "properties": {
                        "matchExpressions": {
                          "items": {
                            "additionalProperties": false,
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ],
                                "type": "string"
                              },
                              "values": {
                                "items": {
                                  "type": "string"
                                },
                                "type": "array",
                                "x-kubernetes-list-type": "atomic"
                              }
                            },
                            "required": [
                              "key",
                              "operator"
                            ],
                            "type": "object"
                          },
                          "type": "array",
                          "x-kubernetes-list-type": "atomic"
                        },
                        "matchLabels": {
                          "additionalProperties": {
                            "maxLength": 63,
                            "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                            "type": "string"
                          },
                          "type": "object"
                        }
                      },
                      "type": "object",
                      "x-kubernetes-map-type": "atomic"
                    },
                    "except": {
                      "items": {
                        "format": "cidr",
                        "type": "string"
                      },
                      "type": "array"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "toEndpoints": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "toEntities": {
                "items": {
                  "enum": [
                    "all",
                    "world",
                    "cluster",
                    "host",
                    "init",
                    "ingress",
                    "unmanaged",
                    "remote-node",
                    "health",
                    "none",
                    "kube-apiserver"
                  ],
                  "type": "string"
                },
                "type": "array"
              },
              "toFQDNs": {
                "items": {
                  "additionalProperties": false,
                  "oneOf": [
                    {
                      "additionalProperties": false,
                      "properties": {
                        "matchName": {}
                      },
                      "required": [
                        "matchName"
                      ]
                    },
                    {
                      "additionalProperties": false,
                      "properties": {
                        "matchPattern": {}
                      },
                      "required": [
                        "matchPattern"
                      ]
                    }
                  ],
                  "properties": {
                    "matchName": {
                      "maxLength": 255,
                      "pattern": "^([-a-zA-Z0-9_]+[.]?)+$",
                      "type": "string"
                    },
                    "matchPattern": {
                      "maxLength": 255,
                      "pattern": "^([-a-zA-Z0-9_*]+[.]?)+$",
                      "type": "string"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "toGroups": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "aws": {
                      "additionalProperties": false,
                      "properties": {
                        "labels": {
                          "additionalProperties": {
                            "type": "string"
                          },
                          "type": "object"
                        },
                        "region": {
                          "type": "string"
                        },
                        "securityGroupsIds": {
                          "items": {
                            "type": "string"
                          },
                          "type": "array"
                        },
                        "securityGroupsNames": {
                          "items": {
                            "type": "string"
                          },
                          "type": "array"
                        }
                      },
                      "type": "object"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "toNodes": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "toPorts": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "listener": {
                      "additionalProperties": false,
                      "properties": {
                        "envoyConfig": {
                          "additionalProperties": false,
                          "properties": {
                            "kind": {
                              "enum": [
                                "CiliumEnvoyConfig",
                                "CiliumClusterwideEnvoyConfig"
                              ],
                              "type": "string"
                            },
                            "name": {
                              "minLength": 1,
                              "type": "string"
                            }
                          },
                          "required": [
                            "name"
                          ],
                          "type": "object"
                        },
                        "name": {
                          "minLength": 1,
                          "type": "string"
                        },
                        "priority": {
                          "maximum": 100,
                          "minimum": 1,
                          "type": "integer"
                        }
                      },
                      "required": [
                        "envoyConfig",
                        "name"
                      ],
                      "type": "object"
                    },
                    "originatingTLS": {
                      "additionalProperties": false,
                      "properties": {
                        "certificate": {
                          "type": "string"
                        },
                        "privateKey": {
                          "type": "string"
                        },
                        "secret": {
                          "additionalProperties": false,
                          "properties": {
                            "name": {
                              "type": "string"
                            },
                            "namespace": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name"
                          ],
                          "type": "object"
                        },
                        "trustedCA": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "secret"
                      ],
                      "type": "object"
                    },
                    "ports": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "endPort": {
                            "format": "int32",
                            "maximum": 65535,
                            "minimum": 0,
                            "type": "integer"
                          },
                          "port": {
                            "pattern": "^(6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{4}|[0-9]{1,4})|([a-zA-Z0-9]-?)*[a-zA-Z](-?[a-zA-Z0-9])*$",
                            "type": "string"
                          },
                          "protocol": {
                            "enum": [
                              "TCP",
                              "UDP",
                              "SCTP",
                              "ANY"
                            ],
                            "type": "string"
                          }
                        },
                        "required": [
                          "port"
                        ],
                        "type": "object"
                      },
                      "maxItems": 40,
                      "type": "array"
                    },
                    "rules": {
                      "additionalProperties": false,
                      "oneOf": [
                        {
                          "additionalProperties": false,
                          "properties": {
                            "http": {}
                          },
                          "required": [
                            "http"
                          ]
                        },
                        {
                          "additionalProperties": false,
                          "properties": {
                            "kafka": {}
                          },
                          "required": [
                            "kafka"
                          ]
                        },
                        {
                          "additionalProperties": false,
                          "properties": {
                            "dns": {}
                          },
                          "required": [
                            "dns"
                          ]
                        },
                        {
                          "additionalProperties": false,
                          "properties": {
                            "l7proto": {}
                          },
                          "required": [
                            "l7proto"
                          ]
                        }
                      ],
                      "properties": {
                        "dns": {
                          "items": {
                            "additionalProperties": false,
                            "oneOf": [
                              {
                                "additionalProperties": false,
                                "properties": {
                                  "matchName": {}
                                },
                                "required": [
                                  "matchName"
                                ]
                              },
                              {
                                "additionalProperties": false,
                                "properties": {
                                  "matchPattern": {}
                                },
                                "required": [
                                  "matchPattern"
                                ]
                              }
                            ],
                            "properties": {
                              "matchName": {
                                "maxLength": 255,
                                "pattern": "^([-a-zA-Z0-9_]+[.]?)+$",
                                "type": "string"
                              },
                              "matchPattern": {
                                "maxLength": 255,
                                "pattern": "^([-a-zA-Z0-9_*]+[.]?)+$",
                                "type": "string"
                              }
                            },
                            "type": "object"
                          },
                          "type": "array"
                        },
                        "http": {
                          "items": {
                            "additionalProperties": false,
                            "properties": {
                              "headerMatches": {
                                "items": {
                                  "additionalProperties": false,
                                  "properties": {
                                    "mismatch": {
                                      "enum": [
                                        "LOG",
                                        "ADD",
                                        "DELETE",
                                        "REPLACE"
                                      ],
                                      "type": "string"
                                    },
                                    "name": {
                                      "minLength": 1,
                                      "type": "string"
                                    },
                                    "secret": {
                                      "additionalProperties": false,
                                      "properties": {
                                        "name": {
                                          "type": "string"
                                        },
                                        "namespace": {
                                          "type": "string"
                                        }
                                      },
                                      "required": [
                                        "name"
                                      ],
                                      "type": "object"
                                    },
                                    "value": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name"
                                  ],
                                  "type": "object"
                                },
                                "type": "array"
                              },
                              "headers": {
                                "items": {
                                  "type": "string"
                                },
                                "type": "array"
                              },
                              "host": {
                                "format": "idn-hostname",
                                "type": "string"
                              },
                              "method": {
                                "type": "string"
                              },
                              "path": {
                                "type": "string"
                              }
                            },
                            "type": "object"
                          },
                          "type": "array"
                        },
                        "kafka": {
                          "items": {
                            "additionalProperties": false,
                            "properties": {
                              "apiKey": {
                                "type": "string"
                              },
                              "apiVersion": {
                                "type": "string"
                              },
                              "clientID": {
                                "type": "string"
                              },
                              "role": {
                                "enum": [
                                  "produce",
                                  "consume"
                                ],
                                "type": "string"
                              },
                              "topic": {
                                "maxLength": 255,
                                "type": "string"
                              }
                            },
                            "type": "object"
                          },
                          "type": "array"
                        },
                        "l7": {
                          "items": {
                            "additionalProperties": {
                              "type": "string"
                            },
                            "type": "object"
                          },
                          "type": "array"
                        },
                        "l7proto": {
                          "type": "string"
                        }
                      },
                      "type": "object"
                    },
                    "serverNames": {
                      "items": {
                        "type": "string"
                      },
                      "type": "array"
                    },
                    "terminatingTLS": {
                      "additionalProperties": false,
                      "properties": {
                        "certificate": {
                          "type": "string"
                        },
                        "privateKey": {
                          "type": "string"
                        },
                        "secret": {
                          "additionalProperties": false,
                          "properties": {
                            "name": {
                              "type": "string"
                            },
                            "namespace": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name"
                          ],
                          "type": "object"
                        },
                        "trustedCA": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "secret"
                      ],
                      "type": "object"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "toRequires": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "toServices": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "k8sService": {
                      "additionalProperties": false,
                      "properties": {
                        "namespace": {
                          "type": "string"
                        },
                        "serviceName": {
                          "type": "string"
                        }
                      },
                      "type": "object"
                    },
                    "k8sServiceSelector": {
                      "additionalProperties": false,
                      "properties": {
                        "namespace": {
                          "type": "string"
                        },
                        "selector": {
                          "additionalProperties": false,
                          "properties": {
                            "matchExpressions": {
                              "items": {
                                "additionalProperties": false,
                                "properties": {
                                  "key": {
                                    "type": "string"
                                  },
                                  "operator": {
                                    "enum": [
                                      "In",
                                      "NotIn",
                                      "Exists",
                                      "DoesNotExist"
                                    ],
                                    "type": "string"
                                  },
                                  "values": {
                                    "items": {
                                      "type": "string"
                                    },
                                    "type": "array",
                                    "x-kubernetes-list-type": "atomic"
                                  }
                                },
                                "required": [
                                  "key",
                                  "operator"
                                ],
                                "type": "object"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            },
                            "matchLabels": {
                              "additionalProperties": {
                                "maxLength": 63,
                                "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                                "type": "string"
                              },
                              "type": "object"
                            }
                          },
                          "type": "object",
                          "x-kubernetes-map-type": "atomic"
                        }
                      },
                      "required": [
                        "selector"
                      ],
                      "type": "object"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              }
            },
            "type": "object"
          },
          "type": "array"
        },
        "egressDeny": {
          "items": {
            "additionalProperties": false,
            "properties": {
              "icmps": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "fields": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "family": {
                            "default": "IPv4",
                            "enum": [
                              "IPv4",
                              "IPv6"
                            ],
                            "type": "string"
                          },
                          "type": {
                            "anyOf": [
                              {
                                "type": "integer"
                              },
                              {
                                "type": "string"
                              }
                            ],
                            "pattern": "^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]|EchoReply|DestinationUnreachable|Redirect|Echo|RouterAdvertisement|RouterSelection|TimeExceeded|ParameterProblem|Timestamp|TimestampReply|Photuris|ExtendedEchoRequest|ExtendedEcho Reply|PacketTooBig|ParameterProblem|EchoRequest|MulticastListenerQuery|MulticastListenerReport|MulticastListenerDone|RouterSolicitation|RouterAdvertisement|NeighborSolicitation|NeighborAdvertisement|RedirectMessage|RouterRenumbering|ICMPNodeInformationQuery|ICMPNodeInformationResponse|InverseNeighborDiscoverySolicitation|InverseNeighborDiscoveryAdvertisement|HomeAgentAddressDiscoveryRequest|HomeAgentAddressDiscoveryReply|MobilePrefixSolicitation|MobilePrefixAdvertisement|DuplicateAddressRequestCodeSuffix|DuplicateAddressConfirmationCodeSuffix)$",
                            "x-kubernetes-int-or-string": true
                          }
                        },
                        "required": [
                          "type"
                        ],
                        "type": "object"
                      },
                      "maxItems": 40,
                      "type": "array"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "toCIDR": {
                "items": {
                  "format": "cidr",
                  "type": "string"
                },
                "type": "array"
              },
              "toCIDRSet": {
                "items": {
                  "additionalProperties": false,
                  "oneOf": [
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidr": {}
                      },
                      "required": [
                        "cidr"
                      ]
                    },
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidrGroupRef": {}
                      },
                      "required": [
                        "cidrGroupRef"
                      ]
                    },
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidrGroupSelector": {}
                      },
                      "required": [
                        "cidrGroupSelector"
                      ]
                    }
                  ],
                  "properties": {
                    "cidr": {
                      "format": "cidr",
                      "type": "string"
                    },
                    "cidrGroupRef": {
                      "maxLength": 253,
                      "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$",
                      "type": "string"
                    },
                    "cidrGroupSelector": {
                      "additionalProperties": false,
                      "properties": {
                        "matchExpressions": {
                          "items": {
                            "additionalProperties": false,
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ],
                                "type": "string"
                              },
                              "values": {
                                "items": {
                                  "type": "string"
                                },
                                "type": "array",
                                "x-kubernetes-list-type": "atomic"
                              }
                            },
                            "required": [
                              "key",
                              "operator"
                            ],
                            "type": "object"
                          },
                          "type": "array",
                          "x-kubernetes-list-type": "atomic"
                        },
                        "matchLabels": {
                          "additionalProperties": {
                            "maxLength": 63,
                            "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                            "type": "string"
                          },
                          "type": "object"
                        }
                      },
                      "type": "object",
                      "x-kubernetes-map-type": "atomic"
                    },
                    "except": {
                      "items": {
                        "format": "cidr",
                        "type": "string"
                      },
                      "type": "array"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "toEndpoints": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "toEntities": {
                "items": {
                  "enum": [
                    "all",
                    "world",
                    "cluster",
                    "host",
                    "init",
                    "ingress",
                    "unmanaged",
                    "remote-node",
                    "health",
                    "none",
                    "kube-apiserver"
                  ],
                  "type": "string"
                },
                "type": "array"
              },
              "toGroups": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "aws": {
                      "additionalProperties": false,
                      "properties": {
                        "labels": {
                          "additionalProperties": {
                            "type": "string"
                          },
                          "type": "object"
                        },
                        "region": {
                          "type": "string"
                        },
                        "securityGroupsIds": {
                          "items": {
                            "type": "string"
                          },
                          "type": "array"
                        },
                        "securityGroupsNames": {
                          "items": {
                            "type": "string"
                          },
                          "type": "array"
                        }
                      },
                      "type": "object"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "toNodes": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "toPorts": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "ports": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "endPort": {
                            "format": "int32",
                            "maximum": 65535,
                            "minimum": 0,
                            "type": "integer"
                          },
                          "port": {
                            "pattern": "^(6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{4}|[0-9]{1,4})|([a-zA-Z0-9]-?)*[a-zA-Z](-?[a-zA-Z0-9])*$",
                            "type": "string"
                          },
                          "protocol": {
                            "enum": [
                              "TCP",
                              "UDP",
                              "SCTP",
                              "ANY"
                            ],
                            "type": "string"
                          }
                        },
                        "required": [
                          "port"
                        ],
                        "type": "object"
                      },
                      "type": "array"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "toRequires": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "toServices": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "k8sService": {
                      "additionalProperties": false,
                      "properties": {
                        "namespace": {
                          "type": "string"
                        },
                        "serviceName": {
                          "type": "string"
                        }
                      },
                      "type": "object"
                    },
                    "k8sServiceSelector": {
                      "additionalProperties": false,
                      "properties": {
                        "namespace": {
                          "type": "string"
                        },
                        "selector": {
                          "additionalProperties": false,
                          "properties": {
                            "matchExpressions": {
                              "items": {
                                "additionalProperties": false,
                                "properties": {
                                  "key": {
                                    "type": "string"
                                  },
                                  "operator": {
                                    "enum": [
                                      "In",
                                      "NotIn",
                                      "Exists",
                                      "DoesNotExist"
                                    ],
                                    "type": "string"
                                  },
                                  "values": {
                                    "items": {
                                      "type": "string"
                                    },
                                    "type": "array",
                                    "x-kubernetes-list-type": "atomic"
                                  }
                                },
                                "required": [
                                  "key",
                                  "operator"
                                ],
                                "type": "object"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            },
                            "matchLabels": {
                              "additionalProperties": {
                                "maxLength": 63,
                                "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                                "type": "string"
                              },
                              "type": "object"
                            }
                          },
                          "type": "object",
                          "x-kubernetes-map-type": "atomic"
                        }
                      },
                      "required": [
                        "selector"
                      ],
                      "type": "object"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              }
            },
            "type": "object"
          },
          "type": "array"
        },
        "enableDefaultDeny": {
          "additionalProperties": false,
          "properties": {
            "egress": {
              "type": "boolean"
            },
            "ingress": {
              "type": "boolean"
            }
          },
          "type": "object"
        },
        "endpointSelector": {
          "additionalProperties": false,
          "properties": {
            "matchExpressions": {
              "items": {
                "additionalProperties": false,
                "properties": {
                  "key": {
                    "type": "string"
                  },
                  "operator": {
                    "enum": [
                      "In",
                      "NotIn",
                      "Exists",
                      "DoesNotExist"
                    ],
                    "type": "string"
                  },
                  "values": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array",
                    "x-kubernetes-list-type": "atomic"
                  }
                },
                "required": [
                  "key",
                  "operator"
                ],
                "type": "object"
              },
              "type": "array",
              "x-kubernetes-list-type": "atomic"
            },
            "matchLabels": {
              "additionalProperties": {
                "maxLength": 63,
                "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                "type": "string"
              },
              "type": "object"
            }
          },
          "type": "object",
          "x-kubernetes-map-type": "atomic"
        },
        "ingress": {
          "items": {
            "additionalProperties": false,
            "properties": {
              "authentication": {
                "additionalProperties": false,
                "properties": {
                  "mode": {
                    "enum": [
                      "disabled",
                      "required",
                      "test-always-fail"
                    ],
                    "type": "string"
                  }
                },
                "required": [
                  "mode"
                ],
                "type": "object"
              },
              "fromCIDR": {
                "items": {
                  "format": "cidr",
                  "type": "string"
                },
                "type": "array"
              },
              "fromCIDRSet": {
                "items": {
                  "additionalProperties": false,
                  "oneOf": [
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidr": {}
                      },
                      "required": [
                        "cidr"
                      ]
                    },
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidrGroupRef": {}
                      },
                      "required": [
                        "cidrGroupRef"
                      ]
                    },
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidrGroupSelector": {}
                      },
                      "required": [
                        "cidrGroupSelector"
                      ]
                    }
                  ],
                  "properties": {
                    "cidr": {
                      "format": "cidr",
                      "type": "string"
                    },
                    "cidrGroupRef": {
                      "maxLength": 253,
                      "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$",
                      "type": "string"
                    },
                    "cidrGroupSelector": {
                      "additionalProperties": false,
                      "properties": {
                        "matchExpressions": {
                          "items": {
                            "additionalProperties": false,
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ],
                                "type": "string"
                              },
                              "values": {
                                "items": {
                                  "type": "string"
                                },
                                "type": "array",
                                "x-kubernetes-list-type": "atomic"
                              }
                            },
                            "required": [
                              "key",
                              "operator"
                            ],
                            "type": "object"
                          },
                          "type": "array",
                          "x-kubernetes-list-type": "atomic"
                        },
                        "matchLabels": {
                          "additionalProperties": {
                            "maxLength": 63,
                            "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                            "type": "string"
                          },
                          "type": "object"
                        }
                      },
                      "type": "object",
                      "x-kubernetes-map-type": "atomic"
                    },
                    "except": {
                      "items": {
                        "format": "cidr",
                        "type": "string"
                      },
                      "type": "array"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "fromEndpoints": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "fromEntities": {
                "items": {
                  "enum": [
                    "all",
                    "world",
                    "cluster",
                    "host",
                    "init",
                    "ingress",
                    "unmanaged",
                    "remote-node",
                    "health",
                    "none",
                    "kube-apiserver"
                  ],
                  "type": "string"
                },
                "type": "array"
              },
              "fromGroups": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "aws": {
                      "additionalProperties": false,
                      "properties": {
                        "labels": {
                          "additionalProperties": {
                            "type": "string"
                          },
                          "type": "object"
                        },
                        "region": {
                          "type": "string"
                        },
                        "securityGroupsIds": {
                          "items": {
                            "type": "string"
                          },
                          "type": "array"
                        },
                        "securityGroupsNames": {
                          "items": {
                            "type": "string"
                          },
                          "type": "array"
                        }
                      },
                      "type": "object"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "fromNodes": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "fromRequires": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "icmps": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "fields": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "family": {
                            "default": "IPv4",
                            "enum": [
                              "IPv4",
                              "IPv6"
                            ],
                            "type": "string"
                          },
                          "type": {
                            "anyOf": [
                              {
                                "type": "integer"
                              },
                              {
                                "type": "string"
                              }
                            ],
                            "pattern": "^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]|EchoReply|DestinationUnreachable|Redirect|Echo|RouterAdvertisement|RouterSelection|TimeExceeded|ParameterProblem|Timestamp|TimestampReply|Photuris|ExtendedEchoRequest|ExtendedEcho Reply|PacketTooBig|ParameterProblem|EchoRequest|MulticastListenerQuery|MulticastListenerReport|MulticastListenerDone|RouterSolicitation|RouterAdvertisement|NeighborSolicitation|NeighborAdvertisement|RedirectMessage|RouterRenumbering|ICMPNodeInformationQuery|ICMPNodeInformationResponse|InverseNeighborDiscoverySolicitation|InverseNeighborDiscoveryAdvertisement|HomeAgentAddressDiscoveryRequest|HomeAgentAddressDiscoveryReply|MobilePrefixSolicitation|MobilePrefixAdvertisement|DuplicateAddressRequestCodeSuffix|DuplicateAddressConfirmationCodeSuffix)$",
                            "x-kubernetes-int-or-string": true
                          }
                        },
                        "required": [
                          "type"
                        ],
                        "type": "object"
                      },
                      "maxItems": 40,
                      "type": "array"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "toPorts": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "listener": {
                      "additionalProperties": false,
                      "properties": {
                        "envoyConfig": {
                          "additionalProperties": false,
                          "properties": {
                            "kind": {
                              "enum": [
                                "CiliumEnvoyConfig",
                                "CiliumClusterwideEnvoyConfig"
                              ],
                              "type": "string"
                            },
                            "name": {
                              "minLength": 1,
                              "type": "string"
                            }
                          },
                          "required": [
                            "name"
                          ],
                          "type": "object"
                        },
                        "name": {
                          "minLength": 1,
                          "type": "string"
                        },
                        "priority": {
                          "maximum": 100,
                          "minimum": 1,
                          "type": "integer"
                        }
                      },
                      "required": [
                        "envoyConfig",
                        "name"
                      ],
                      "type": "object"
                    },
                    "originatingTLS": {
                      "additionalProperties": false,
                      "properties": {
                        "certificate": {
                          "type": "string"
                        },
                        "privateKey": {
                          "type": "string"
                        },
                        "secret": {
                          "additionalProperties": false,
                          "properties": {
                            "name": {
                              "type": "string"
                            },
                            "namespace": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name"
                          ],
                          "type": "object"
                        },
                        "trustedCA": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "secret"
                      ],
                      "type": "object"
                    },
                    "ports": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "endPort": {
                            "format": "int32",
                            "maximum": 65535,
                            "minimum": 0,
                            "type": "integer"
                          },
                          "port": {
                            "pattern": "^(6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{4}|[0-9]{1,4})|([a-zA-Z0-9]-?)*[a-zA-Z](-?[a-zA-Z0-9])*$",
                            "type": "string"
                          },
                          "protocol": {
                            "enum": [
                              "TCP",
                              "UDP",
                              "SCTP",
                              "ANY"
                            ],
                            "type": "string"
                          }
                        },
                        "required": [
                          "port"
                        ],
                        "type": "object"
                      },
                      "maxItems": 40,
                      "type": "array"
                    },
                    "rules": {
                      "additionalProperties": false,
                      "oneOf": [
                        {
                          "additionalProperties": false,
                          "properties": {
                            "http": {}
                          },
                          "required": [
                            "http"
                          ]
                        },
                        {
                          "additionalProperties": false,
                          "properties": {
                            "kafka": {}
                          },
                          "required": [
                            "kafka"
                          ]
                        },
                        {
                          "additionalProperties": false,
                          "properties": {
                            "dns": {}
                          },
                          "required": [
                            "dns"
                          ]
                        },
                        {
                          "additionalProperties": false,
                          "properties": {
                            "l7proto": {}
                          },
                          "required": [
                            "l7proto"
                          ]
                        }
                      ],
                      "properties": {
                        "dns": {
                          "items": {
                            "additionalProperties": false,
                            "oneOf": [
                              {
                                "additionalProperties": false,
                                "properties": {
                                  "matchName": {}
                                },
                                "required": [
                                  "matchName"
                                ]
                              },
                              {
                                "additionalProperties": false,
                                "properties": {
                                  "matchPattern": {}
                                },
                                "required": [
                                  "matchPattern"
                                ]
                              }
                            ],
                            "properties": {
                              "matchName": {
                                "maxLength": 255,
                                "pattern": "^([-a-zA-Z0-9_]+[.]?)+$",
                                "type": "string"
                              },
                              "matchPattern": {
                                "maxLength": 255,
                                "pattern": "^([-a-zA-Z0-9_*]+[.]?)+$",
                                "type": "string"
                              }
                            },
                            "type": "object"
                          },
                          "type": "array"
                        },
                        "http": {
                          "items": {
                            "additionalProperties": false,
                            "properties": {
                              "headerMatches": {
                                "items": {
                                  "additionalProperties": false,
                                  "properties": {
                                    "mismatch": {
                                      "enum": [
                                        "LOG",
                                        "ADD",
                                        "DELETE",
                                        "REPLACE"
                                      ],
                                      "type": "string"
                                    },
                                    "name": {
                                      "minLength": 1,
                                      "type": "string"
                                    },
                                    "secret": {
                                      "additionalProperties": false,
                                      "properties": {
                                        "name": {
                                          "type": "string"
                                        },
                                        "namespace": {
                                          "type": "string"
                                        }
                                      },
                                      "required": [
                                        "name"
                                      ],
                                      "type": "object"
                                    },
                                    "value": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "name"
                                  ],
                                  "type": "object"
                                },
                                "type": "array"
                              },
                              "headers": {
                                "items": {
                                  "type": "string"
                                },
                                "type": "array"
                              },
                              "host": {
                                "format": "idn-hostname",
                                "type": "string"
                              },
                              "method": {
                                "type": "string"
                              },
                              "path": {
                                "type": "string"
                              }
                            },
                            "type": "object"
                          },
                          "type": "array"
                        },
                        "kafka": {
                          "items": {
                            "additionalProperties": false,
                            "properties": {
                              "apiKey": {
                                "type": "string"
                              },
                              "apiVersion": {
                                "type": "string"
                              },
                              "clientID": {
                                "type": "string"
                              },
                              "role": {
                                "enum": [
                                  "produce",
                                  "consume"
                                ],
                                "type": "string"
                              },
                              "topic": {
                                "maxLength": 255,
                                "type": "string"
                              }
                            },
                            "type": "object"
                          },
                          "type": "array"
                        },
                        "l7": {
                          "items": {
                            "additionalProperties": {
                              "type": "string"
                            },
                            "type": "object"
                          },
                          "type": "array"
                        },
                        "l7proto": {
                          "type": "string"
                        }
                      },
                      "type": "object"
                    },
                    "serverNames": {
                      "items": {
                        "type": "string"
                      },
                      "type": "array"
                    },
                    "terminatingTLS": {
                      "additionalProperties": false,
                      "properties": {
                        "certificate": {
                          "type": "string"
                        },
                        "privateKey": {
                          "type": "string"
                        },
                        "secret": {
                          "additionalProperties": false,
                          "properties": {
                            "name": {
                              "type": "string"
                            },
                            "namespace": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "name"
                          ],
                          "type": "object"
                        },
                        "trustedCA": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "secret"
                      ],
                      "type": "object"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              }
            },
            "type": "object"
          },
          "type": "array"
        },
        "ingressDeny": {
          "items": {
            "additionalProperties": false,
            "properties": {
              "fromCIDR": {
                "items": {
                  "format": "cidr",
                  "type": "string"
                },
                "type": "array"
              },
              "fromCIDRSet": {
                "items": {
                  "additionalProperties": false,
                  "oneOf": [
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidr": {}
                      },
                      "required": [
                        "cidr"
                      ]
                    },
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidrGroupRef": {}
                      },
                      "required": [
                        "cidrGroupRef"
                      ]
                    },
                    {
                      "additionalProperties": false,
                      "properties": {
                        "cidrGroupSelector": {}
                      },
                      "required": [
                        "cidrGroupSelector"
                      ]
                    }
                  ],
                  "properties": {
                    "cidr": {
                      "format": "cidr",
                      "type": "string"
                    },
                    "cidrGroupRef": {
                      "maxLength": 253,
                      "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$",
                      "type": "string"
                    },
                    "cidrGroupSelector": {
                      "additionalProperties": false,
                      "properties": {
                        "matchExpressions": {
                          "items": {
                            "additionalProperties": false,
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ],
                                "type": "string"
                              },
                              "values": {
                                "items": {
                                  "type": "string"
                                },
                                "type": "array",
                                "x-kubernetes-list-type": "atomic"
                              }
                            },
                            "required": [
                              "key",
                              "operator"
                            ],
                            "type": "object"
                          },
                          "type": "array",
                          "x-kubernetes-list-type": "atomic"
                        },
                        "matchLabels": {
                          "additionalProperties": {
                            "maxLength": 63,
                            "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                            "type": "string"
                          },
                          "type": "object"
                        }
                      },
                      "type": "object",
                      "x-kubernetes-map-type": "atomic"
                    },
                    "except": {
                      "items": {
                        "format": "cidr",
                        "type": "string"
                      },
                      "type": "array"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "fromEndpoints": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "fromEntities": {
                "items": {
                  "enum": [
                    "all",
                    "world",
                    "cluster",
                    "host",
                    "init",
                    "ingress",
                    "unmanaged",
                    "remote-node",
                    "health",
                    "none",
                    "kube-apiserver"
                  ],
                  "type": "string"
                },
                "type": "array"
              },
              "fromGroups": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "aws": {
                      "additionalProperties": false,
                      "properties": {
                        "labels": {
                          "additionalProperties": {
                            "type": "string"
                          },
                          "type": "object"
                        },
                        "region": {
                          "type": "string"
                        },
                        "securityGroupsIds": {
                          "items": {
                            "type": "string"
                          },
                          "type": "array"
                        },
                        "securityGroupsNames": {
                          "items": {
                            "type": "string"
                          },
                          "type": "array"
                        }
                      },
                      "type": "object"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "fromNodes": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "fromRequires": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "matchExpressions": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "operator": {
                            "enum": [
                              "In",
                              "NotIn",
                              "Exists",
                              "DoesNotExist"
                            ],
                            "type": "string"
                          },
                          "values": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          }
                        },
                        "required": [
                          "key",
                          "operator"
                        ],
                        "type": "object"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    },
                    "matchLabels": {
                      "additionalProperties": {
                        "maxLength": 63,
                        "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object",
                  "x-kubernetes-map-type": "atomic"
                },
                "type": "array"
              },
              "icmps": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "fields": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "family": {
                            "default": "IPv4",
                            "enum": [
                              "IPv4",
                              "IPv6"
                            ],
                            "type": "string"
                          },
                          "type": {
                            "anyOf": [
                              {
                                "type": "integer"
                              },
                              {
                                "type": "string"
                              }
                            ],
                            "pattern": "^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]|EchoReply|DestinationUnreachable|Redirect|Echo|RouterAdvertisement|RouterSelection|TimeExceeded|ParameterProblem|Timestamp|TimestampReply|Photuris|ExtendedEchoRequest|ExtendedEcho Reply|PacketTooBig|ParameterProblem|EchoRequest|MulticastListenerQuery|MulticastListenerReport|MulticastListenerDone|RouterSolicitation|RouterAdvertisement|NeighborSolicitation|NeighborAdvertisement|RedirectMessage|RouterRenumbering|ICMPNodeInformationQuery|ICMPNodeInformationResponse|InverseNeighborDiscoverySolicitation|InverseNeighborDiscoveryAdvertisement|HomeAgentAddressDiscoveryRequest|HomeAgentAddressDiscoveryReply|MobilePrefixSolicitation|MobilePrefixAdvertisement|DuplicateAddressRequestCodeSuffix|DuplicateAddressConfirmationCodeSuffix)$",
                            "x-kubernetes-int-or-string": true
                          }
                        },
                        "required": [
                          "type"
                        ],
                        "type": "object"
                      },
                      "maxItems": 40,
                      "type": "array"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              },
              "toPorts": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "ports": {
                      "items": {
                        "additionalProperties": false,
                        "properties": {
                          "endPort": {
                            "format": "int32",
                            "maximum": 65535,
                            "minimum": 0,
                            "type": "integer"
                          },
                          "port": {
                            "pattern": "^(6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{4}|[0-9]{1,4})|([a-zA-Z0-9]-?)*[a-zA-Z](-?[a-zA-Z0-9])*$",
                            "type": "string"
                          },
                          "protocol": {
                            "enum": [
                              "TCP",
                              "UDP",
                              "SCTP",
                              "ANY"
                            ],
                            "type": "string"
                          }
                        },
                        "required": [
                          "port"
                        ],
                        "type": "object"
                      },
                      "type": "array"
                    }
                  },
                  "type": "object"
                },
                "type": "array"
              }
            },
            "type": "object"
          },
          "type": "array"
        },
        "labels": {
          "items": {
            "additionalProperties": false,
            "properties": {
              "key": {
                "type": "string"
              },
              "source": {
                "type": "string"
              },
              "value": {
                "type": "string"
              }
            },
            "required": [
              "key"
            ],
            "type": "object"
          },
          "type": "array"
        },
        "nodeSelector": {
          "additionalProperties": false,
          "properties": {
            "matchExpressions": {
              "items": {
                "additionalProperties": false,
                "properties": {
                  "key": {
                    "type": "string"
                  },
                  "operator": {
                    "enum": [
                      "In",
                      "NotIn",
                      "Exists",
                      "DoesNotExist"
                    ],
                    "type": "string"
                  },
                  "values": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array",
                    "x-kubernetes-list-type": "atomic"
                  }
                },
                "required": [
                  "key",
                  "operator"
                ],
                "type": "object"
              },
              "type": "array",
              "x-kubernetes-list-type": "atomic"
            },
            "matchLabels": {
              "additionalProperties": {
                "maxLength": 63,
                "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                "type": "string"
              },
              "type": "object"
            }
          },
          "type": "object",
          "x-kubernetes-map-type": "atomic"
        }
      },
      "type": "object"
    },
    "specs": {
      "items": {
        "additionalProperties": false,
        "anyOf": [
          {
            "additionalProperties": false,
            "properties": {
              "ingress": {}
            },
            "required": [
              "ingress"
            ]
          },
          {
            "additionalProperties": false,
            "properties": {
              "ingressDeny": {}
            },
            "required": [
              "ingressDeny"
            ]
          },
          {
            "additionalProperties": false,
            "properties": {
              "egress": {}
            },
            "required": [
              "egress"
            ]
          },
          {
            "additionalProperties": false,
            "properties": {
              "egressDeny": {}
            },
            "required": [
              "egressDeny"
            ]
          }
        ],
        "oneOf": [
          {
            "additionalProperties": false,
            "properties": {
              "endpointSelector": {}
            },
            "required": [
              "endpointSelector"
            ]
          },
          {
            "additionalProperties": false,
            "properties": {
              "nodeSelector": {}
            },
            "required": [
              "nodeSelector"
            ]
          }
        ],
        "properties": {
          "description": {
            "type": "string"
          },
          "egress": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "authentication": {
                  "additionalProperties": false,
                  "properties": {
                    "mode": {
                      "enum": [
                        "disabled",
                        "required",
                        "test-always-fail"
                      ],
                      "type": "string"
                    }
                  },
                  "required": [
                    "mode"
                  ],
                  "type": "object"
                },
                "icmps": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "fields": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "family": {
                              "default": "IPv4",
                              "enum": [
                                "IPv4",
                                "IPv6"
                              ],
                              "type": "string"
                            },
                            "type": {
                              "anyOf": [
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "string"
                                }
                              ],
                              "pattern": "^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]|EchoReply|DestinationUnreachable|Redirect|Echo|RouterAdvertisement|RouterSelection|TimeExceeded|ParameterProblem|Timestamp|TimestampReply|Photuris|ExtendedEchoRequest|ExtendedEcho Reply|PacketTooBig|ParameterProblem|EchoRequest|MulticastListenerQuery|MulticastListenerReport|MulticastListenerDone|RouterSolicitation|RouterAdvertisement|NeighborSolicitation|NeighborAdvertisement|RedirectMessage|RouterRenumbering|ICMPNodeInformationQuery|ICMPNodeInformationResponse|InverseNeighborDiscoverySolicitation|InverseNeighborDiscoveryAdvertisement|HomeAgentAddressDiscoveryRequest|HomeAgentAddressDiscoveryReply|MobilePrefixSolicitation|MobilePrefixAdvertisement|DuplicateAddressRequestCodeSuffix|DuplicateAddressConfirmationCodeSuffix)$",
                              "x-kubernetes-int-or-string": true
                            }
                          },
                          "required": [
                            "type"
                          ],
                          "type": "object"
                        },
                        "maxItems": 40,
                        "type": "array"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "toCIDR": {
                  "items": {
                    "format": "cidr",
                    "type": "string"
                  },
                  "type": "array"
                },
                "toCIDRSet": {
                  "items": {
                    "additionalProperties": false,
                    "oneOf": [
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidr": {}
                        },
                        "required": [
                          "cidr"
                        ]
                      },
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidrGroupRef": {}
                        },
                        "required": [
                          "cidrGroupRef"
                        ]
                      },
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidrGroupSelector": {}
                        },
                        "required": [
                          "cidrGroupSelector"
                        ]
                      }
                    ],
                    "properties": {
                      "cidr": {
                        "format": "cidr",
                        "type": "string"
                      },
                      "cidrGroupRef": {
                        "maxLength": 253,
                        "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$",
                        "type": "string"
                      },
                      "cidrGroupSelector": {
                        "additionalProperties": false,
                        "properties": {
                          "matchExpressions": {
                            "items": {
                              "additionalProperties": false,
                              "properties": {
                                "key": {
                                  "type": "string"
                                },
                                "operator": {
                                  "enum": [
                                    "In",
                                    "NotIn",
                                    "Exists",
                                    "DoesNotExist"
                                  ],
                                  "type": "string"
                                },
                                "values": {
                                  "items": {
                                    "type": "string"
                                  },
                                  "type": "array",
                                  "x-kubernetes-list-type": "atomic"
                                }
                              },
                              "required": [
                                "key",
                                "operator"
                              ],
                              "type": "object"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          },
                          "matchLabels": {
                            "additionalProperties": {
                              "maxLength": 63,
                              "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                              "type": "string"
                            },
                            "type": "object"
                          }
                        },
                        "type": "object",
                        "x-kubernetes-map-type": "atomic"
                      },
                      "except": {
                        "items": {
                          "format": "cidr",
                          "type": "string"
                        },
                        "type": "array"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "toEndpoints": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "toEntities": {
                  "items": {
                    "enum": [
                      "all",
                      "world",
                      "cluster",
                      "host",
                      "init",
                      "ingress",
                      "unmanaged",
                      "remote-node",
                      "health",
                      "none",
                      "kube-apiserver"
                    ],
                    "type": "string"
                  },
                  "type": "array"
                },
                "toFQDNs": {
                  "items": {
                    "additionalProperties": false,
                    "oneOf": [
                      {
                        "additionalProperties": false,
                        "properties": {
                          "matchName": {}
                        },
                        "required": [
                          "matchName"
                        ]
                      },
                      {
                        "additionalProperties": false,
                        "properties": {
                          "matchPattern": {}
                        },
                        "required": [
                          "matchPattern"
                        ]
                      }
                    ],
                    "properties": {
                      "matchName": {
                        "maxLength": 255,
                        "pattern": "^([-a-zA-Z0-9_]+[.]?)+$",
                        "type": "string"
                      },
                      "matchPattern": {
                        "maxLength": 255,
                        "pattern": "^([-a-zA-Z0-9_*]+[.]?)+$",
                        "type": "string"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "toGroups": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "aws": {
                        "additionalProperties": false,
                        "properties": {
                          "labels": {
                            "additionalProperties": {
                              "type": "string"
                            },
                            "type": "object"
                          },
                          "region": {
                            "type": "string"
                          },
                          "securityGroupsIds": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array"
                          },
                          "securityGroupsNames": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array"
                          }
                        },
                        "type": "object"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "toNodes": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "toPorts": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "listener": {
                        "additionalProperties": false,
                        "properties": {
                          "envoyConfig": {
                            "additionalProperties": false,
                            "properties": {
                              "kind": {
                                "enum": [
                                  "CiliumEnvoyConfig",
                                  "CiliumClusterwideEnvoyConfig"
                                ],
                                "type": "string"
                              },
                              "name": {
                                "minLength": 1,
                                "type": "string"
                              }
                            },
                            "required": [
                              "name"
                            ],
                            "type": "object"
                          },
                          "name": {
                            "minLength": 1,
                            "type": "string"
                          },
                          "priority": {
                            "maximum": 100,
                            "minimum": 1,
                            "type": "integer"
                          }
                        },
                        "required": [
                          "envoyConfig",
                          "name"
                        ],
                        "type": "object"
                      },
                      "originatingTLS": {
                        "additionalProperties": false,
                        "properties": {
                          "certificate": {
                            "type": "string"
                          },
                          "privateKey": {
                            "type": "string"
                          },
                          "secret": {
                            "additionalProperties": false,
                            "properties": {
                              "name": {
                                "type": "string"
                              },
                              "namespace": {
                                "type": "string"
                              }
                            },
                            "required": [
                              "name"
                            ],
                            "type": "object"
                          },
                          "trustedCA": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "secret"
                        ],
                        "type": "object"
                      },
                      "ports": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "endPort": {
                              "format": "int32",
                              "maximum": 65535,
                              "minimum": 0,
                              "type": "integer"
                            },
                            "port": {
                              "pattern": "^(6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{4}|[0-9]{1,4})|([a-zA-Z0-9]-?)*[a-zA-Z](-?[a-zA-Z0-9])*$",
                              "type": "string"
                            },
                            "protocol": {
                              "enum": [
                                "TCP",
                                "UDP",
                                "SCTP",
                                "ANY"
                              ],
                              "type": "string"
                            }
                          },
                          "required": [
                            "port"
                          ],
                          "type": "object"
                        },
                        "maxItems": 40,
                        "type": "array"
                      },
                      "rules": {
                        "additionalProperties": false,
                        "oneOf": [
                          {
                            "additionalProperties": false,
                            "properties": {
                              "http": {}
                            },
                            "required": [
                              "http"
                            ]
                          },
                          {
                            "additionalProperties": false,
                            "properties": {
                              "kafka": {}
                            },
                            "required": [
                              "kafka"
                            ]
                          },
                          {
                            "additionalProperties": false,
                            "properties": {
                              "dns": {}
                            },
                            "required": [
                              "dns"
                            ]
                          },
                          {
                            "additionalProperties": false,
                            "properties": {
                              "l7proto": {}
                            },
                            "required": [
                              "l7proto"
                            ]
                          }
                        ],
                        "properties": {
                          "dns": {
                            "items": {
                              "additionalProperties": false,
                              "oneOf": [
                                {
                                  "additionalProperties": false,
                                  "properties": {
                                    "matchName": {}
                                  },
                                  "required": [
                                    "matchName"
                                  ]
                                },
                                {
                                  "additionalProperties": false,
                                  "properties": {
                                    "matchPattern": {}
                                  },
                                  "required": [
                                    "matchPattern"
                                  ]
                                }
                              ],
                              "properties": {
                                "matchName": {
                                  "maxLength": 255,
                                  "pattern": "^([-a-zA-Z0-9_]+[.]?)+$",
                                  "type": "string"
                                },
                                "matchPattern": {
                                  "maxLength": 255,
                                  "pattern": "^([-a-zA-Z0-9_*]+[.]?)+$",
                                  "type": "string"
                                }
                              },
                              "type": "object"
                            },
                            "type": "array"
                          },
                          "http": {
                            "items": {
                              "additionalProperties": false,
                              "properties": {
                                "headerMatches": {
                                  "items": {
                                    "additionalProperties": false,
                                    "properties": {
                                      "mismatch": {
                                        "enum": [
                                          "LOG",
                                          "ADD",
                                          "DELETE",
                                          "REPLACE"
                                        ],
                                        "type": "string"
                                      },
                                      "name": {
                                        "minLength": 1,
                                        "type": "string"
                                      },
                                      "secret": {
                                        "additionalProperties": false,
                                        "properties": {
                                          "name": {
                                            "type": "string"
                                          },
                                          "namespace": {
                                            "type": "string"
                                          }
                                        },
                                        "required": [
                                          "name"
                                        ],
                                        "type": "object"
                                      },
                                      "value": {
                                        "type": "string"
                                      }
                                    },
                                    "required": [
                                      "name"
                                    ],
                                    "type": "object"
                                  },
                                  "type": "array"
                                },
                                "headers": {
                                  "items": {
                                    "type": "string"
                                  },
                                  "type": "array"
                                },
                                "host": {
                                  "format": "idn-hostname",
                                  "type": "string"
                                },
                                "method": {
                                  "type": "string"
                                },
                                "path": {
                                  "type": "string"
                                }
                              },
                              "type": "object"
                            },
                            "type": "array"
                          },
                          "kafka": {
                            "items": {
                              "additionalProperties": false,
                              "properties": {
                                "apiKey": {
                                  "type": "string"
                                },
                                "apiVersion": {
                                  "type": "string"
                                },
                                "clientID": {
                                  "type": "string"
                                },
                                "role": {
                                  "enum": [
                                    "produce",
                                    "consume"
                                  ],
                                  "type": "string"
                                },
                                "topic": {
                                  "maxLength": 255,
                                  "type": "string"
                                }
                              },
                              "type": "object"
                            },
                            "type": "array"
                          },
                          "l7": {
                            "items": {
                              "additionalProperties": {
                                "type": "string"
                              },
                              "type": "object"
                            },
                            "type": "array"
                          },
                          "l7proto": {
                            "type": "string"
                          }
                        },
                        "type": "object"
                      },
                      "serverNames": {
                        "items": {
                          "type": "string"
                        },
                        "type": "array"
                      },
                      "terminatingTLS": {
                        "additionalProperties": false,
                        "properties": {
                          "certificate": {
                            "type": "string"
                          },
                          "privateKey": {
                            "type": "string"
                          },
                          "secret": {
                            "additionalProperties": false,
                            "properties": {
                              "name": {
                                "type": "string"
                              },
                              "namespace": {
                                "type": "string"
                              }
                            },
                            "required": [
                              "name"
                            ],
                            "type": "object"
                          },
                          "trustedCA": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "secret"
                        ],
                        "type": "object"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "toRequires": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "toServices": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "k8sService": {
                        "additionalProperties": false,
                        "properties": {
                          "namespace": {
                            "type": "string"
                          },
                          "serviceName": {
                            "type": "string"
                          }
                        },
                        "type": "object"
                      },
                      "k8sServiceSelector": {
                        "additionalProperties": false,
                        "properties": {
                          "namespace": {
                            "type": "string"
                          },
                          "selector": {
                            "additionalProperties": false,
                            "properties": {
                              "matchExpressions": {
                                "items": {
                                  "additionalProperties": false,
                                  "properties": {
                                    "key": {
                                      "type": "string"
                                    },
                                    "operator": {
                                      "enum": [
                                        "In",
                                        "NotIn",
                                        "Exists",
                                        "DoesNotExist"
                                      ],
                                      "type": "string"
                                    },
                                    "values": {
                                      "items": {
                                        "type": "string"
                                      },
                                      "type": "array",
                                      "x-kubernetes-list-type": "atomic"
                                    }
                                  },
                                  "required": [
                                    "key",
                                    "operator"
                                  ],
                                  "type": "object"
                                },
                                "type": "array",
                                "x-kubernetes-list-type": "atomic"
                              },
                              "matchLabels": {
                                "additionalProperties": {
                                  "maxLength": 63,
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                                  "type": "string"
                                },
                                "type": "object"
                              }
                            },
                            "type": "object",
                            "x-kubernetes-map-type": "atomic"
                          }
                        },
                        "required": [
                          "selector"
                        ],
                        "type": "object"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                }
              },
              "type": "object"
            },
            "type": "array"
          },
          "egressDeny": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "icmps": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "fields": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "family": {
                              "default": "IPv4",
                              "enum": [
                                "IPv4",
                                "IPv6"
                              ],
                              "type": "string"
                            },
                            "type": {
                              "anyOf": [
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "string"
                                }
                              ],
                              "pattern": "^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]|EchoReply|DestinationUnreachable|Redirect|Echo|RouterAdvertisement|RouterSelection|TimeExceeded|ParameterProblem|Timestamp|TimestampReply|Photuris|ExtendedEchoRequest|ExtendedEcho Reply|PacketTooBig|ParameterProblem|EchoRequest|MulticastListenerQuery|MulticastListenerReport|MulticastListenerDone|RouterSolicitation|RouterAdvertisement|NeighborSolicitation|NeighborAdvertisement|RedirectMessage|RouterRenumbering|ICMPNodeInformationQuery|ICMPNodeInformationResponse|InverseNeighborDiscoverySolicitation|InverseNeighborDiscoveryAdvertisement|HomeAgentAddressDiscoveryRequest|HomeAgentAddressDiscoveryReply|MobilePrefixSolicitation|MobilePrefixAdvertisement|DuplicateAddressRequestCodeSuffix|DuplicateAddressConfirmationCodeSuffix)$",
                              "x-kubernetes-int-or-string": true
                            }
                          },
                          "required": [
                            "type"
                          ],
                          "type": "object"
                        },
                        "maxItems": 40,
                        "type": "array"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "toCIDR": {
                  "items": {
                    "format": "cidr",
                    "type": "string"
                  },
                  "type": "array"
                },
                "toCIDRSet": {
                  "items": {
                    "additionalProperties": false,
                    "oneOf": [
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidr": {}
                        },
                        "required": [
                          "cidr"
                        ]
                      },
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidrGroupRef": {}
                        },
                        "required": [
                          "cidrGroupRef"
                        ]
                      },
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidrGroupSelector": {}
                        },
                        "required": [
                          "cidrGroupSelector"
                        ]
                      }
                    ],
                    "properties": {
                      "cidr": {
                        "format": "cidr",
                        "type": "string"
                      },
                      "cidrGroupRef": {
                        "maxLength": 253,
                        "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$",
                        "type": "string"
                      },
                      "cidrGroupSelector": {
                        "additionalProperties": false,
                        "properties": {
                          "matchExpressions": {
                            "items": {
                              "additionalProperties": false,
                              "properties": {
                                "key": {
                                  "type": "string"
                                },
                                "operator": {
                                  "enum": [
                                    "In",
                                    "NotIn",
                                    "Exists",
                                    "DoesNotExist"
                                  ],
                                  "type": "string"
                                },
                                "values": {
                                  "items": {
                                    "type": "string"
                                  },
                                  "type": "array",
                                  "x-kubernetes-list-type": "atomic"
                                }
                              },
                              "required": [
                                "key",
                                "operator"
                              ],
                              "type": "object"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          },
                          "matchLabels": {
                            "additionalProperties": {
                              "maxLength": 63,
                              "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                              "type": "string"
                            },
                            "type": "object"
                          }
                        },
                        "type": "object",
                        "x-kubernetes-map-type": "atomic"
                      },
                      "except": {
                        "items": {
                          "format": "cidr",
                          "type": "string"
                        },
                        "type": "array"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "toEndpoints": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "toEntities": {
                  "items": {
                    "enum": [
                      "all",
                      "world",
                      "cluster",
                      "host",
                      "init",
                      "ingress",
                      "unmanaged",
                      "remote-node",
                      "health",
                      "none",
                      "kube-apiserver"
                    ],
                    "type": "string"
                  },
                  "type": "array"
                },
                "toGroups": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "aws": {
                        "additionalProperties": false,
                        "properties": {
                          "labels": {
                            "additionalProperties": {
                              "type": "string"
                            },
                            "type": "object"
                          },
                          "region": {
                            "type": "string"
                          },
                          "securityGroupsIds": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array"
                          },
                          "securityGroupsNames": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array"
                          }
                        },
                        "type": "object"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "toNodes": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "toPorts": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "ports": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "endPort": {
                              "format": "int32",
                              "maximum": 65535,
                              "minimum": 0,
                              "type": "integer"
                            },
                            "port": {
                              "pattern": "^(6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{4}|[0-9]{1,4})|([a-zA-Z0-9]-?)*[a-zA-Z](-?[a-zA-Z0-9])*$",
                              "type": "string"
                            },
                            "protocol": {
                              "enum": [
                                "TCP",
                                "UDP",
                                "SCTP",
                                "ANY"
                              ],
                              "type": "string"
                            }
                          },
                          "required": [
                            "port"
                          ],
                          "type": "object"
                        },
                        "type": "array"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "toRequires": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "toServices": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "k8sService": {
                        "additionalProperties": false,
                        "properties": {
                          "namespace": {
                            "type": "string"
                          },
                          "serviceName": {
                            "type": "string"
                          }
                        },
                        "type": "object"
                      },
                      "k8sServiceSelector": {
                        "additionalProperties": false,
                        "properties": {
                          "namespace": {
                            "type": "string"
                          },
                          "selector": {
                            "additionalProperties": false,
                            "properties": {
                              "matchExpressions": {
                                "items": {
                                  "additionalProperties": false,
                                  "properties": {
                                    "key": {
                                      "type": "string"
                                    },
                                    "operator": {
                                      "enum": [
                                        "In",
                                        "NotIn",
                                        "Exists",
                                        "DoesNotExist"
                                      ],
                                      "type": "string"
                                    },
                                    "values": {
                                      "items": {
                                        "type": "string"
                                      },
                                      "type": "array",
                                      "x-kubernetes-list-type": "atomic"
                                    }
                                  },
                                  "required": [
                                    "key",
                                    "operator"
                                  ],
                                  "type": "object"
                                },
                                "type": "array",
                                "x-kubernetes-list-type": "atomic"
                              },
                              "matchLabels": {
                                "additionalProperties": {
                                  "maxLength": 63,
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                                  "type": "string"
                                },
                                "type": "object"
                              }
                            },
                            "type": "object",
                            "x-kubernetes-map-type": "atomic"
                          }
                        },
                        "required": [
                          "selector"
                        ],
                        "type": "object"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                }
              },
              "type": "object"
            },
            "type": "array"
          },
          "enableDefaultDeny": {
            "additionalProperties": false,
            "properties": {
              "egress": {
                "type": "boolean"
              },
              "ingress": {
                "type": "boolean"
              }
            },
            "type": "object"
          },
          "endpointSelector": {
            "additionalProperties": false,
            "properties": {
              "matchExpressions": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "key": {
                      "type": "string"
                    },
                    "operator": {
                      "enum": [
                        "In",
                        "NotIn",
                        "Exists",
                        "DoesNotExist"
                      ],
                      "type": "string"
                    },
                    "values": {
                      "items": {
                        "type": "string"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    }
                  },
                  "required": [
                    "key",
                    "operator"
                  ],
                  "type": "object"
                },
                "type": "array",
                "x-kubernetes-list-type": "atomic"
              },
              "matchLabels": {
                "additionalProperties": {
                  "maxLength": 63,
                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                  "type": "string"
                },
                "type": "object"
              }
            },
            "type": "object",
            "x-kubernetes-map-type": "atomic"
          },
          "ingress": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "authentication": {
                  "additionalProperties": false,
                  "properties": {
                    "mode": {
                      "enum": [
                        "disabled",
                        "required",
                        "test-always-fail"
                      ],
                      "type": "string"
                    }
                  },
                  "required": [
                    "mode"
                  ],
                  "type": "object"
                },
                "fromCIDR": {
                  "items": {
                    "format": "cidr",
                    "type": "string"
                  },
                  "type": "array"
                },
                "fromCIDRSet": {
                  "items": {
                    "additionalProperties": false,
                    "oneOf": [
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidr": {}
                        },
                        "required": [
                          "cidr"
                        ]
                      },
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidrGroupRef": {}
                        },
                        "required": [
                          "cidrGroupRef"
                        ]
                      },
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidrGroupSelector": {}
                        },
                        "required": [
                          "cidrGroupSelector"
                        ]
                      }
                    ],
                    "properties": {
                      "cidr": {
                        "format": "cidr",
                        "type": "string"
                      },
                      "cidrGroupRef": {
                        "maxLength": 253,
                        "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$",
                        "type": "string"
                      },
                      "cidrGroupSelector": {
                        "additionalProperties": false,
                        "properties": {
                          "matchExpressions": {
                            "items": {
                              "additionalProperties": false,
                              "properties": {
                                "key": {
                                  "type": "string"
                                },
                                "operator": {
                                  "enum": [
                                    "In",
                                    "NotIn",
                                    "Exists",
                                    "DoesNotExist"
                                  ],
                                  "type": "string"
                                },
                                "values": {
                                  "items": {
                                    "type": "string"
                                  },
                                  "type": "array",
                                  "x-kubernetes-list-type": "atomic"
                                }
                              },
                              "required": [
                                "key",
                                "operator"
                              ],
                              "type": "object"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          },
                          "matchLabels": {
                            "additionalProperties": {
                              "maxLength": 63,
                              "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                              "type": "string"
                            },
                            "type": "object"
                          }
                        },
                        "type": "object",
                        "x-kubernetes-map-type": "atomic"
                      },
                      "except": {
                        "items": {
                          "format": "cidr",
                          "type": "string"
                        },
                        "type": "array"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "fromEndpoints": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "fromEntities": {
                  "items": {
                    "enum": [
                      "all",
                      "world",
                      "cluster",
                      "host",
                      "init",
                      "ingress",
                      "unmanaged",
                      "remote-node",
                      "health",
                      "none",
                      "kube-apiserver"
                    ],
                    "type": "string"
                  },
                  "type": "array"
                },
                "fromGroups": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "aws": {
                        "additionalProperties": false,
                        "properties": {
                          "labels": {
                            "additionalProperties": {
                              "type": "string"
                            },
                            "type": "object"
                          },
                          "region": {
                            "type": "string"
                          },
                          "securityGroupsIds": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array"
                          },
                          "securityGroupsNames": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array"
                          }
                        },
                        "type": "object"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "fromNodes": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "fromRequires": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "icmps": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "fields": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "family": {
                              "default": "IPv4",
                              "enum": [
                                "IPv4",
                                "IPv6"
                              ],
                              "type": "string"
                            },
                            "type": {
                              "anyOf": [
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "string"
                                }
                              ],
                              "pattern": "^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]|EchoReply|DestinationUnreachable|Redirect|Echo|RouterAdvertisement|RouterSelection|TimeExceeded|ParameterProblem|Timestamp|TimestampReply|Photuris|ExtendedEchoRequest|ExtendedEcho Reply|PacketTooBig|ParameterProblem|EchoRequest|MulticastListenerQuery|MulticastListenerReport|MulticastListenerDone|RouterSolicitation|RouterAdvertisement|NeighborSolicitation|NeighborAdvertisement|RedirectMessage|RouterRenumbering|ICMPNodeInformationQuery|ICMPNodeInformationResponse|InverseNeighborDiscoverySolicitation|InverseNeighborDiscoveryAdvertisement|HomeAgentAddressDiscoveryRequest|HomeAgentAddressDiscoveryReply|MobilePrefixSolicitation|MobilePrefixAdvertisement|DuplicateAddressRequestCodeSuffix|DuplicateAddressConfirmationCodeSuffix)$",
                              "x-kubernetes-int-or-string": true
                            }
                          },
                          "required": [
                            "type"
                          ],
                          "type": "object"
                        },
                        "maxItems": 40,
                        "type": "array"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "toPorts": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "listener": {
                        "additionalProperties": false,
                        "properties": {
                          "envoyConfig": {
                            "additionalProperties": false,
                            "properties": {
                              "kind": {
                                "enum": [
                                  "CiliumEnvoyConfig",
                                  "CiliumClusterwideEnvoyConfig"
                                ],
                                "type": "string"
                              },
                              "name": {
                                "minLength": 1,
                                "type": "string"
                              }
                            },
                            "required": [
                              "name"
                            ],
                            "type": "object"
                          },
                          "name": {
                            "minLength": 1,
                            "type": "string"
                          },
                          "priority": {
                            "maximum": 100,
                            "minimum": 1,
                            "type": "integer"
                          }
                        },
                        "required": [
                          "envoyConfig",
                          "name"
                        ],
                        "type": "object"
                      },
                      "originatingTLS": {
                        "additionalProperties": false,
                        "properties": {
                          "certificate": {
                            "type": "string"
                          },
                          "privateKey": {
                            "type": "string"
                          },
                          "secret": {
                            "additionalProperties": false,
                            "properties": {
                              "name": {
                                "type": "string"
                              },
                              "namespace": {
                                "type": "string"
                              }
                            },
                            "required": [
                              "name"
                            ],
                            "type": "object"
                          },
                          "trustedCA": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "secret"
                        ],
                        "type": "object"
                      },
                      "ports": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "endPort": {
                              "format": "int32",
                              "maximum": 65535,
                              "minimum": 0,
                              "type": "integer"
                            },
                            "port": {
                              "pattern": "^(6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{4}|[0-9]{1,4})|([a-zA-Z0-9]-?)*[a-zA-Z](-?[a-zA-Z0-9])*$",
                              "type": "string"
                            },
                            "protocol": {
                              "enum": [
                                "TCP",
                                "UDP",
                                "SCTP",
                                "ANY"
                              ],
                              "type": "string"
                            }
                          },
                          "required": [
                            "port"
                          ],
                          "type": "object"
                        },
                        "maxItems": 40,
                        "type": "array"
                      },
                      "rules": {
                        "additionalProperties": false,
                        "oneOf": [
                          {
                            "additionalProperties": false,
                            "properties": {
                              "http": {}
                            },
                            "required": [
                              "http"
                            ]
                          },
                          {
                            "additionalProperties": false,
                            "properties": {
                              "kafka": {}
                            },
                            "required": [
                              "kafka"
                            ]
                          },
                          {
                            "additionalProperties": false,
                            "properties": {
                              "dns": {}
                            },
                            "required": [
                              "dns"
                            ]
                          },
                          {
                            "additionalProperties": false,
                            "properties": {
                              "l7proto": {}
                            },
                            "required": [
                              "l7proto"
                            ]
                          }
                        ],
                        "properties": {
                          "dns": {
                            "items": {
                              "additionalProperties": false,
                              "oneOf": [
                                {
                                  "additionalProperties": false,
                                  "properties": {
                                    "matchName": {}
                                  },
                                  "required": [
                                    "matchName"
                                  ]
                                },
                                {
                                  "additionalProperties": false,
                                  "properties": {
                                    "matchPattern": {}
                                  },
                                  "required": [
                                    "matchPattern"
                                  ]
                                }
                              ],
                              "properties": {
                                "matchName": {
                                  "maxLength": 255,
                                  "pattern": "^([-a-zA-Z0-9_]+[.]?)+$",
                                  "type": "string"
                                },
                                "matchPattern": {
                                  "maxLength": 255,
                                  "pattern": "^([-a-zA-Z0-9_*]+[.]?)+$",
                                  "type": "string"
                                }
                              },
                              "type": "object"
                            },
                            "type": "array"
                          },
                          "http": {
                            "items": {
                              "additionalProperties": false,
                              "properties": {
                                "headerMatches": {
                                  "items": {
                                    "additionalProperties": false,
                                    "properties": {
                                      "mismatch": {
                                        "enum": [
                                          "LOG",
                                          "ADD",
                                          "DELETE",
                                          "REPLACE"
                                        ],
                                        "type": "string"
                                      },
                                      "name": {
                                        "minLength": 1,
                                        "type": "string"
                                      },
                                      "secret": {
                                        "additionalProperties": false,
                                        "properties": {
                                          "name": {
                                            "type": "string"
                                          },
                                          "namespace": {
                                            "type": "string"
                                          }
                                        },
                                        "required": [
                                          "name"
                                        ],
                                        "type": "object"
                                      },
                                      "value": {
                                        "type": "string"
                                      }
                                    },
                                    "required": [
                                      "name"
                                    ],
                                    "type": "object"
                                  },
                                  "type": "array"
                                },
                                "headers": {
                                  "items": {
                                    "type": "string"
                                  },
                                  "type": "array"
                                },
                                "host": {
                                  "format": "idn-hostname",
                                  "type": "string"
                                },
                                "method": {
                                  "type": "string"
                                },
                                "path": {
                                  "type": "string"
                                }
                              },
                              "type": "object"
                            },
                            "type": "array"
                          },
                          "kafka": {
                            "items": {
                              "additionalProperties": false,
                              "properties": {
                                "apiKey": {
                                  "type": "string"
                                },
                                "apiVersion": {
                                  "type": "string"
                                },
                                "clientID": {
                                  "type": "string"
                                },
                                "role": {
                                  "enum": [
                                    "produce",
                                    "consume"
                                  ],
                                  "type": "string"
                                },
                                "topic": {
                                  "maxLength": 255,
                                  "type": "string"
                                }
                              },
                              "type": "object"
                            },
                            "type": "array"
                          },
                          "l7": {
                            "items": {
                              "additionalProperties": {
                                "type": "string"
                              },
                              "type": "object"
                            },
                            "type": "array"
                          },
                          "l7proto": {
                            "type": "string"
                          }
                        },
                        "type": "object"
                      },
                      "serverNames": {
                        "items": {
                          "type": "string"
                        },
                        "type": "array"
                      },
                      "terminatingTLS": {
                        "additionalProperties": false,
                        "properties": {
                          "certificate": {
                            "type": "string"
                          },
                          "privateKey": {
                            "type": "string"
                          },
                          "secret": {
                            "additionalProperties": false,
                            "properties": {
                              "name": {
                                "type": "string"
                              },
                              "namespace": {
                                "type": "string"
                              }
                            },
                            "required": [
                              "name"
                            ],
                            "type": "object"
                          },
                          "trustedCA": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "secret"
                        ],
                        "type": "object"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                }
              },
              "type": "object"
            },
            "type": "array"
          },
          "ingressDeny": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "fromCIDR": {
                  "items": {
                    "format": "cidr",
                    "type": "string"
                  },
                  "type": "array"
                },
                "fromCIDRSet": {
                  "items": {
                    "additionalProperties": false,
                    "oneOf": [
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidr": {}
                        },
                        "required": [
                          "cidr"
                        ]
                      },
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidrGroupRef": {}
                        },
                        "required": [
                          "cidrGroupRef"
                        ]
                      },
                      {
                        "additionalProperties": false,
                        "properties": {
                          "cidrGroupSelector": {}
                        },
                        "required": [
                          "cidrGroupSelector"
                        ]
                      }
                    ],
                    "properties": {
                      "cidr": {
                        "format": "cidr",
                        "type": "string"
                      },
                      "cidrGroupRef": {
                        "maxLength": 253,
                        "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$",
                        "type": "string"
                      },
                      "cidrGroupSelector": {
                        "additionalProperties": false,
                        "properties": {
                          "matchExpressions": {
                            "items": {
                              "additionalProperties": false,
                              "properties": {
                                "key": {
                                  "type": "string"
                                },
                                "operator": {
                                  "enum": [
                                    "In",
                                    "NotIn",
                                    "Exists",
                                    "DoesNotExist"
                                  ],
                                  "type": "string"
                                },
                                "values": {
                                  "items": {
                                    "type": "string"
                                  },
                                  "type": "array",
                                  "x-kubernetes-list-type": "atomic"
                                }
                              },
                              "required": [
                                "key",
                                "operator"
                              ],
                              "type": "object"
                            },
                            "type": "array",
                            "x-kubernetes-list-type": "atomic"
                          },
                          "matchLabels": {
                            "additionalProperties": {
                              "maxLength": 63,
                              "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                              "type": "string"
                            },
                            "type": "object"
                          }
                        },
                        "type": "object",
                        "x-kubernetes-map-type": "atomic"
                      },
                      "except": {
                        "items": {
                          "format": "cidr",
                          "type": "string"
                        },
                        "type": "array"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "fromEndpoints": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "fromEntities": {
                  "items": {
                    "enum": [
                      "all",
                      "world",
                      "cluster",
                      "host",
                      "init",
                      "ingress",
                      "unmanaged",
                      "remote-node",
                      "health",
                      "none",
                      "kube-apiserver"
                    ],
                    "type": "string"
                  },
                  "type": "array"
                },
                "fromGroups": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "aws": {
                        "additionalProperties": false,
                        "properties": {
                          "labels": {
                            "additionalProperties": {
                              "type": "string"
                            },
                            "type": "object"
                          },
                          "region": {
                            "type": "string"
                          },
                          "securityGroupsIds": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array"
                          },
                          "securityGroupsNames": {
                            "items": {
                              "type": "string"
                            },
                            "type": "array"
                          }
                        },
                        "type": "object"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "fromNodes": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "fromRequires": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "matchExpressions": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "key": {
                              "type": "string"
                            },
                            "operator": {
                              "enum": [
                                "In",
                                "NotIn",
                                "Exists",
                                "DoesNotExist"
                              ],
                              "type": "string"
                            },
                            "values": {
                              "items": {
                                "type": "string"
                              },
                              "type": "array",
                              "x-kubernetes-list-type": "atomic"
                            }
                          },
                          "required": [
                            "key",
                            "operator"
                          ],
                          "type": "object"
                        },
                        "type": "array",
                        "x-kubernetes-list-type": "atomic"
                      },
                      "matchLabels": {
                        "additionalProperties": {
                          "maxLength": 63,
                          "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                          "type": "string"
                        },
                        "type": "object"
                      }
                    },
                    "type": "object",
                    "x-kubernetes-map-type": "atomic"
                  },
                  "type": "array"
                },
                "icmps": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "fields": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "family": {
                              "default": "IPv4",
                              "enum": [
                                "IPv4",
                                "IPv6"
                              ],
                              "type": "string"
                            },
                            "type": {
                              "anyOf": [
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "string"
                                }
                              ],
                              "pattern": "^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]|EchoReply|DestinationUnreachable|Redirect|Echo|RouterAdvertisement|RouterSelection|TimeExceeded|ParameterProblem|Timestamp|TimestampReply|Photuris|ExtendedEchoRequest|ExtendedEcho Reply|PacketTooBig|ParameterProblem|EchoRequest|MulticastListenerQuery|MulticastListenerReport|MulticastListenerDone|RouterSolicitation|RouterAdvertisement|NeighborSolicitation|NeighborAdvertisement|RedirectMessage|RouterRenumbering|ICMPNodeInformationQuery|ICMPNodeInformationResponse|InverseNeighborDiscoverySolicitation|InverseNeighborDiscoveryAdvertisement|HomeAgentAddressDiscoveryRequest|HomeAgentAddressDiscoveryReply|MobilePrefixSolicitation|MobilePrefixAdvertisement|DuplicateAddressRequestCodeSuffix|DuplicateAddressConfirmationCodeSuffix)$",
                              "x-kubernetes-int-or-string": true
                            }
                          },
                          "required": [
                            "type"
                          ],
                          "type": "object"
                        },
                        "maxItems": 40,
                        "type": "array"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "toPorts": {
                  "items": {
                    "additionalProperties": false,
                    "properties": {
                      "ports": {
                        "items": {
                          "additionalProperties": false,
                          "properties": {
                            "endPort": {
                              "format": "int32",
                              "maximum": 65535,
                              "minimum": 0,
                              "type": "integer"
                            },
                            "port": {
                              "pattern": "^(6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{4}|[0-9]{1,4})|([a-zA-Z0-9]-?)*[a-zA-Z](-?[a-zA-Z0-9])*$",
                              "type": "string"
                            },
                            "protocol": {
                              "enum": [
                                "TCP",
                                "UDP",
                                "SCTP",
                                "ANY"
                              ],
                              "type": "string"
                            }
                          },
                          "required": [
                            "port"
                          ],
                          "type": "object"
                        },
                        "type": "array"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                }
              },
              "type": "object"
            },
            "type": "array"
          },
          "labels": {
            "items": {
              "additionalProperties": false,
              "properties": {
                "key": {
                  "type": "string"
                },
                "source": {
                  "type": "string"
                },
                "value": {
                  "type": "string"
                }
              },
              "required": [
                "key"
              ],
              "type": "object"
            },
            "type": "array"
          },
          "nodeSelector": {
            "additionalProperties": false,
            "properties": {
              "matchExpressions": {
                "items": {
                  "additionalProperties": false,
                  "properties": {
                    "key": {
                      "type": "string"
                    },
                    "operator": {
                      "enum": [
                        "In",
                        "NotIn",
                        "Exists",
                        "DoesNotExist"
                      ],
                      "type": "string"
                    },
                    "values": {
                      "items": {
                        "type": "string"
                      },
                      "type": "array",
                      "x-kubernetes-list-type": "atomic"
                    }
                  },
                  "required": [
                    "key",
                    "operator"
                  ],
                  "type": "object"
                },
                "type": "array",
                "x-kubernetes-list-type": "atomic"
              },
              "matchLabels": {
                "additionalProperties": {
                  "maxLength": 63,
                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$",
                  "type": "string"
                },
                "type": "object"
              }
            },
            "type": "object",
            "x-kubernetes-map-type": "atomic"
          }
        },
        "type": "object"
      },
      "type": "array"
    },
    "status": {
      "additionalProperties": false,
      "properties": {
        "conditions": {
          "items": {
            "additionalProperties": false,
            "properties": {
              "lastTransitionTime": {
                "format": "date-time",
                "type": "string"
              },
              "message": {
                "type": "string"
              },
              "reason": {
                "type": "string"
              },
              "status": {
                "type": "string"
              },
              "type": {
                "type": "string"
              }
            },
            "required": [
              "status",
              "type"
            ],
            "type": "object"
          },
          "type": "array",
          "x-kubernetes-list-map-keys": [
            "type"
          ],
          "x-kubernetes-list-type": "map"
        },
        "derivativePolicies": {
          "additionalProperties": {
            "properties": {
              "annotations": {
                "additionalProperties": {
                  "type": "string"
                },
                "type": "object"
              },
              "enforcing": {
                "type": "boolean"
              },
              "error": {
                "type": "string"
              },
              "lastUpdated": {
                "format": "date-time",
                "type": "string"
              },
              "localPolicyRevision": {
                "format": "int64",
                "type": "integer"
              },
              "ok": {
                "type": "boolean"
              }
            },
            "type": "object"
          },
          "type": "object"
        }
      },
      "type": "object"
    }
  },
  "required": [
    "metadata"
  ],
  "type": "object"
}
