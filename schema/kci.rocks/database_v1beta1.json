{
  "description": "Database is the Schema for the databases API",
  "type": "object",
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": "string"
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "description": "DatabaseSpec defines the desired state of Database",
      "type": "object",
      "required": [
        "backup",
        "deletionProtected",
        "instance",
        "secretName"
      ],
      "properties": {
        "backup": {
          "description": "DatabaseBackup defines the desired state of backup and schedule",
          "type": "object",
          "required": [
            "cron",
            "enable"
          ],
          "properties": {
            "cron": {
              "type": "string"
            },
            "enable": {
              "type": "boolean"
            }
          },
          "additionalProperties": false
        },
        "cleanup": {
          "type": "boolean"
        },
        "deletionProtected": {
          "type": "boolean"
        },
        "instance": {
          "type": "string"
        },
        "postgres": {
          "description": "Postgres struct should be used to provide resource that only applicable to postgres",
          "type": "object",
          "properties": {
            "dropPublicSchema": {
              "description": "If set to true, the public schema will be dropped after the database creation",
              "type": "boolean"
            },
            "extensions": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "schemas": {
              "description": "Specify schemas to be created. The user created by db-operator will have all access on them.",
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": false
        },
        "secretName": {
          "type": "string"
        },
        "secretsTemplates": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false
    },
    "status": {
      "description": "DatabaseStatus defines the observed state of Database",
      "type": "object",
      "required": [
        "database",
        "instanceRef",
        "phase",
        "status",
        "user"
      ],
      "properties": {
        "database": {
          "type": "string"
        },
        "instanceRef": {
          "description": "DbInstance is the Schema for the dbinstances API",
          "type": "object",
          "properties": {
            "apiVersion": {
              "description": "APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
              "type": "string"
            },
            "kind": {
              "description": "Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
              "type": "string"
            },
            "metadata": {
              "type": "object"
            },
            "spec": {
              "description": "DbInstanceSpec defines the desired state of DbInstance",
              "type": "object",
              "required": [
                "adminSecretRef",
                "engine"
              ],
              "properties": {
                "adminSecretRef": {
                  "description": "NamespacedName is a fork of the kubernetes api type of the same name. Sadly this is required because CRD structs must have all fields json tagged and the kubernetes type is not tagged.",
                  "type": "object",
                  "required": [
                    "Name",
                    "Namespace"
                  ],
                  "properties": {
                    "Name": {
                      "type": "string"
                    },
                    "Namespace": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                },
                "backup": {
                  "description": "DbInstanceBackup defines name of google bucket to use for storing database dumps for backup when backup is enabled",
                  "type": "object",
                  "required": [
                    "bucket"
                  ],
                  "properties": {
                    "bucket": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                },
                "engine": {
                  "description": "Important: Run \"make generate\" to regenerate code after modifying this file",
                  "type": "string"
                },
                "generic": {
                  "description": "GenericInstance is used when instance type is generic and describes necessary informations to use instance generic instance can be any backend, it must be reachable by described address and port",
                  "type": "object",
                  "required": [
                    "host",
                    "port"
                  ],
                  "properties": {
                    "backupHost": {
                      "description": "BackupHost address will be used for dumping database for backup Usually secondary address for primary-secondary setup or cluster lb address If it's not defined, above Host will be used as backup host address.",
                      "type": "string"
                    },
                    "host": {
                      "type": "string"
                    },
                    "port": {
                      "type": "integer"
                    },
                    "publicIp": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                },
                "google": {
                  "description": "GoogleInstance is used when instance type is Google Cloud SQL and describes necessary informations to use google API to create sql instances",
                  "type": "object",
                  "required": [
                    "configmapRef",
                    "instance"
                  ],
                  "properties": {
                    "apiEndpoint": {
                      "type": "string"
                    },
                    "clientSecretRef": {
                      "description": "NamespacedName is a fork of the kubernetes api type of the same name. Sadly this is required because CRD structs must have all fields json tagged and the kubernetes type is not tagged.",
                      "type": "object",
                      "required": [
                        "Name",
                        "Namespace"
                      ],
                      "properties": {
                        "Name": {
                          "type": "string"
                        },
                        "Namespace": {
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    },
                    "configmapRef": {
                      "description": "NamespacedName is a fork of the kubernetes api type of the same name. Sadly this is required because CRD structs must have all fields json tagged and the kubernetes type is not tagged.",
                      "type": "object",
                      "required": [
                        "Name",
                        "Namespace"
                      ],
                      "properties": {
                        "Name": {
                          "type": "string"
                        },
                        "Namespace": {
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    },
                    "instance": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                },
                "monitoring": {
                  "description": "DbInstanceMonitoring defines if exporter",
                  "type": "object",
                  "required": [
                    "enabled"
                  ],
                  "properties": {
                    "enabled": {
                      "type": "boolean"
                    }
                  },
                  "additionalProperties": false
                },
                "sslConnection": {
                  "description": "DbInstanceSSLConnection defines weather connection from db-operator to instance has to be ssl or not",
                  "type": "object",
                  "required": [
                    "enabled",
                    "skip-verify"
                  ],
                  "properties": {
                    "enabled": {
                      "type": "boolean"
                    },
                    "skip-verify": {
                      "description": "SkipVerity use SSL connection, but don't check against a CA",
                      "type": "boolean"
                    }
                  },
                  "additionalProperties": false
                }
              },
              "additionalProperties": false
            },
            "status": {
              "description": "DbInstanceStatus defines the observed state of DbInstance",
              "type": "object",
              "required": [
                "phase",
                "status"
              ],
              "properties": {
                "checksums": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "info": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "phase": {
                  "description": "Important: Run \"make generate\" to regenerate code after modifying this file",
                  "type": "string"
                },
                "status": {
                  "type": "boolean"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "monitorUserSecret": {
          "type": "string"
        },
        "phase": {
          "description": "Important: Run \"make generate\" to regenerate code after modifying this file Add custom validation using kubebuilder tags: https://book-v1.book.kubebuilder.io/beyond_basics/generating_crd.html",
          "type": "string"
        },
        "proxyStatus": {
          "description": "DatabaseProxyStatus defines whether proxy for database is enabled or not if so, provide information",
          "type": "object",
          "required": [
            "serviceName",
            "sqlPort",
            "status"
          ],
          "properties": {
            "serviceName": {
              "type": "string"
            },
            "sqlPort": {
              "type": "integer",
              "format": "int32"
            },
            "status": {
              "type": "boolean"
            }
          },
          "additionalProperties": false
        },
        "status": {
          "type": "boolean"
        },
        "user": {
          "type": "string"
        }
      },
      "additionalProperties": false
    }
  }
}
