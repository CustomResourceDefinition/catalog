{
  "description": "OpenStackCluster is the Schema for the openstackclusters API",
  "type": "object",
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#resources",
      "type": "string"
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds",
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "description": "OpenStackClusterSpec defines the desired state of OpenStackCluster",
      "type": "object",
      "properties": {
        "apiServerLoadBalancerAdditionalPorts": {
          "description": "APIServerLoadBalancerAdditionalPorts adds additional ports to the APIServerLoadBalancer",
          "type": "array",
          "items": {
            "type": "integer"
          }
        },
        "apiServerLoadBalancerFloatingIP": {
          "description": "APIServerLoadBalancerFloatingIP is the floatingIP which will be associated to the APIServer loadbalancer. The floatingIP will be created if it not already exists.",
          "type": "string"
        },
        "apiServerLoadBalancerPort": {
          "description": "APIServerLoadBalancerPort is the port on which the listener on the APIServer loadbalancer will be created",
          "type": "integer"
        },
        "caKeyPair": {
          "description": "CAKeyPair is the key pair for ca certs.",
          "type": "object",
          "properties": {
            "cert": {
              "description": "base64 encoded cert and key",
              "type": "string",
              "format": "byte"
            },
            "key": {
              "type": "string",
              "format": "byte"
            }
          },
          "additionalProperties": false
        },
        "cloudName": {
          "description": "The name of the cloud to use from the clouds secret",
          "type": "string"
        },
        "cloudsSecret": {
          "description": "The name of the secret containing the openstack credentials",
          "type": "object",
          "properties": {
            "name": {
              "description": "Name is unique within a namespace to reference a secret resource.",
              "type": "string"
            },
            "namespace": {
              "description": "Namespace defines the space within which the secret name must be unique.",
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "disablePortSecurity": {
          "description": "DisablePortSecurity disables the port security of the network created for the Kubernetes cluster, which also disables SecurityGroups",
          "type": "boolean"
        },
        "disableServerTags": {
          "description": "Default: True. In case of server tag errors, set to False",
          "type": "boolean"
        },
        "dnsNameservers": {
          "description": "DNSNameservers is the list of nameservers for OpenStack Subnet being created.",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "etcdCAKeyPair": {
          "description": "EtcdCAKeyPair is the key pair for etcd.",
          "type": "object",
          "properties": {
            "cert": {
              "description": "base64 encoded cert and key",
              "type": "string",
              "format": "byte"
            },
            "key": {
              "type": "string",
              "format": "byte"
            }
          },
          "additionalProperties": false
        },
        "externalNetworkId": {
          "description": "ExternalNetworkID is the ID of an external OpenStack Network. This is necessary to get public internet to the VMs.",
          "type": "string"
        },
        "externalRouterIPs": {
          "description": "ExternalRouterIPs is an array of externalIPs on the respective subnets. This is necessary if the router needs a fixed ip in a specific subnet.",
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "subnet"
            ],
            "properties": {
              "fixedIP": {
                "description": "The FixedIP in the corresponding subnet",
                "type": "string"
              },
              "subnet": {
                "description": "The subnet in which the FixedIP is used for the Gateway of this router",
                "type": "object",
                "properties": {
                  "filter": {
                    "description": "Filters for optional network query",
                    "type": "object",
                    "properties": {
                      "cidr": {
                        "type": "string"
                      },
                      "description": {
                        "type": "string"
                      },
                      "enableDhcp": {
                        "type": "boolean"
                      },
                      "gateway_ip": {
                        "type": "string"
                      },
                      "id": {
                        "type": "string"
                      },
                      "ipVersion": {
                        "type": "integer"
                      },
                      "ipv6AddressMode": {
                        "type": "string"
                      },
                      "ipv6RaMode": {
                        "type": "string"
                      },
                      "limit": {
                        "type": "integer"
                      },
                      "marker": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string"
                      },
                      "networkId": {
                        "type": "string"
                      },
                      "notTags": {
                        "type": "string"
                      },
                      "notTagsAny": {
                        "type": "string"
                      },
                      "projectId": {
                        "type": "string"
                      },
                      "sortDir": {
                        "type": "string"
                      },
                      "sortKey": {
                        "type": "string"
                      },
                      "subnetpoolId": {
                        "type": "string"
                      },
                      "tags": {
                        "type": "string"
                      },
                      "tagsAny": {
                        "type": "string"
                      },
                      "tenantId": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false
                  },
                  "uuid": {
                    "description": "The UUID of the network. Required if you omit the port attribute.",
                    "type": "string"
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          }
        },
        "frontProxyCAKeyPair": {
          "description": "FrontProxyCAKeyPair is the key pair for FrontProxyKeyPair.",
          "type": "object",
          "properties": {
            "cert": {
              "description": "base64 encoded cert and key",
              "type": "string",
              "format": "byte"
            },
            "key": {
              "type": "string",
              "format": "byte"
            }
          },
          "additionalProperties": false
        },
        "managedAPIServerLoadBalancer": {
          "description": "ManagedAPIServerLoadBalancer defines whether a LoadBalancer for the APIServer should be created. If set to true the following properties are mandatory: APIServerLoadBalancerFloatingIP, APIServerLoadBalancerPort",
          "type": "boolean"
        },
        "managedSecurityGroups": {
          "description": "ManagedSecurityGroups defines that kubernetes manages the OpenStack security groups for now, that means that we'll create two security groups, one allowing SSH and API access from everywhere, and another one that allows all traffic to/from machines belonging to that group. In the future, we could make this more flexible.",
          "type": "boolean"
        },
        "network": {
          "description": "If NodeCIDR cannot be set this can be used to detect an existing network.",
          "type": "object",
          "properties": {
            "adminStateUp": {
              "type": "boolean"
            },
            "description": {
              "type": "string"
            },
            "id": {
              "type": "string"
            },
            "limit": {
              "type": "integer"
            },
            "marker": {
              "type": "string"
            },
            "name": {
              "type": "string"
            },
            "notTags": {
              "type": "string"
            },
            "notTagsAny": {
              "type": "string"
            },
            "projectId": {
              "type": "string"
            },
            "shared": {
              "type": "boolean"
            },
            "sortDir": {
              "type": "string"
            },
            "sortKey": {
              "type": "string"
            },
            "status": {
              "type": "string"
            },
            "tags": {
              "type": "string"
            },
            "tagsAny": {
              "type": "string"
            },
            "tenantId": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "nodeCidr": {
          "description": "NodeCIDR is the OpenStack Subnet to be created. Cluster actuator will create a network, a subnet with NodeCIDR, and a router connected to this subnet. If you leave this empty, no network will be created.",
          "type": "string"
        },
        "saKeyPair": {
          "description": "SAKeyPair is the service account key pair.",
          "type": "object",
          "properties": {
            "cert": {
              "description": "base64 encoded cert and key",
              "type": "string",
              "format": "byte"
            },
            "key": {
              "type": "string",
              "format": "byte"
            }
          },
          "additionalProperties": false
        },
        "subnet": {
          "description": "If NodeCIDR cannot be set this can be used to detect an existing subnet.",
          "type": "object",
          "properties": {
            "cidr": {
              "type": "string"
            },
            "description": {
              "type": "string"
            },
            "enableDhcp": {
              "type": "boolean"
            },
            "gateway_ip": {
              "type": "string"
            },
            "id": {
              "type": "string"
            },
            "ipVersion": {
              "type": "integer"
            },
            "ipv6AddressMode": {
              "type": "string"
            },
            "ipv6RaMode": {
              "type": "string"
            },
            "limit": {
              "type": "integer"
            },
            "marker": {
              "type": "string"
            },
            "name": {
              "type": "string"
            },
            "networkId": {
              "type": "string"
            },
            "notTags": {
              "type": "string"
            },
            "notTagsAny": {
              "type": "string"
            },
            "projectId": {
              "type": "string"
            },
            "sortDir": {
              "type": "string"
            },
            "sortKey": {
              "type": "string"
            },
            "subnetpoolId": {
              "type": "string"
            },
            "tags": {
              "type": "string"
            },
            "tagsAny": {
              "type": "string"
            },
            "tenantId": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "tags": {
          "description": "Tags for all resources in cluster",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "useOctavia": {
          "description": "UseOctavia is weather LoadBalancer Service is Octavia or not",
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },
    "status": {
      "description": "OpenStackClusterStatus defines the observed state of OpenStackCluster",
      "type": "object",
      "required": [
        "ready"
      ],
      "properties": {
        "apiEndpoints": {
          "description": "APIEndpoints represents the endpoints to communicate with the control plane.",
          "type": "array",
          "items": {
            "description": "APIEndpoint represents a reachable Kubernetes API endpoint.",
            "type": "object",
            "required": [
              "host",
              "port"
            ],
            "properties": {
              "host": {
                "description": "The hostname on which the API server is serving.",
                "type": "string"
              },
              "port": {
                "description": "The port on which the API server is serving.",
                "type": "integer"
              }
            },
            "additionalProperties": false
          }
        },
        "controlPlaneSecurityGroup": {
          "description": "ControlPlaneSecurityGroups contains all the information about the OpenStack Security Group that needs to be applied to control plane nodes. TODO: Maybe instead of two properties, we add a property to the group?",
          "type": "object",
          "required": [
            "id",
            "name",
            "rules"
          ],
          "properties": {
            "id": {
              "type": "string"
            },
            "name": {
              "type": "string"
            },
            "rules": {
              "type": "array",
              "items": {
                "description": "SecurityGroupRule represent the basic information of the associated OpenStack Security Group Role.",
                "type": "object",
                "required": [
                  "direction",
                  "etherType",
                  "name",
                  "portRangeMax",
                  "portRangeMin",
                  "protocol",
                  "remoteGroupID",
                  "remoteIPPrefix",
                  "securityGroupID"
                ],
                "properties": {
                  "direction": {
                    "type": "string"
                  },
                  "etherType": {
                    "type": "string"
                  },
                  "name": {
                    "type": "string"
                  },
                  "portRangeMax": {
                    "type": "integer"
                  },
                  "portRangeMin": {
                    "type": "integer"
                  },
                  "protocol": {
                    "type": "string"
                  },
                  "remoteGroupID": {
                    "type": "string"
                  },
                  "remoteIPPrefix": {
                    "type": "string"
                  },
                  "securityGroupID": {
                    "type": "string"
                  }
                },
                "additionalProperties": false
              }
            }
          },
          "additionalProperties": false
        },
        "globalSecurityGroup": {
          "description": "GlobalSecurityGroup contains all the information about the OpenStack Security Group that needs to be applied to all nodes, both control plane and worker nodes.",
          "type": "object",
          "required": [
            "id",
            "name",
            "rules"
          ],
          "properties": {
            "id": {
              "type": "string"
            },
            "name": {
              "type": "string"
            },
            "rules": {
              "type": "array",
              "items": {
                "description": "SecurityGroupRule represent the basic information of the associated OpenStack Security Group Role.",
                "type": "object",
                "required": [
                  "direction",
                  "etherType",
                  "name",
                  "portRangeMax",
                  "portRangeMin",
                  "protocol",
                  "remoteGroupID",
                  "remoteIPPrefix",
                  "securityGroupID"
                ],
                "properties": {
                  "direction": {
                    "type": "string"
                  },
                  "etherType": {
                    "type": "string"
                  },
                  "name": {
                    "type": "string"
                  },
                  "portRangeMax": {
                    "type": "integer"
                  },
                  "portRangeMin": {
                    "type": "integer"
                  },
                  "protocol": {
                    "type": "string"
                  },
                  "remoteGroupID": {
                    "type": "string"
                  },
                  "remoteIPPrefix": {
                    "type": "string"
                  },
                  "securityGroupID": {
                    "type": "string"
                  }
                },
                "additionalProperties": false
              }
            }
          },
          "additionalProperties": false
        },
        "network": {
          "description": "Network contains all information about the created OpenStack Network. It includes Subnets and Router.",
          "type": "object",
          "required": [
            "id",
            "name"
          ],
          "properties": {
            "apiServerLoadBalancer": {
              "description": "Be careful when using APIServerLoadBalancer, because this field is optional and therefore not set in all cases",
              "type": "object",
              "required": [
                "id",
                "internalIP",
                "ip",
                "name"
              ],
              "properties": {
                "id": {
                  "type": "string"
                },
                "internalIP": {
                  "type": "string"
                },
                "ip": {
                  "type": "string"
                },
                "name": {
                  "type": "string"
                }
              },
              "additionalProperties": false
            },
            "id": {
              "type": "string"
            },
            "name": {
              "type": "string"
            },
            "router": {
              "description": "Router represents basic information about the associated OpenStack Neutron Router",
              "type": "object",
              "required": [
                "id",
                "name"
              ],
              "properties": {
                "id": {
                  "type": "string"
                },
                "name": {
                  "type": "string"
                }
              },
              "additionalProperties": false
            },
            "subnet": {
              "description": "Subnet represents basic information about the associated OpenStack Neutron Subnet",
              "type": "object",
              "required": [
                "cidr",
                "id",
                "name"
              ],
              "properties": {
                "cidr": {
                  "type": "string"
                },
                "id": {
                  "type": "string"
                },
                "name": {
                  "type": "string"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "ready": {
          "type": "boolean"
        }
      },
      "additionalProperties": false
    }
  }
}
