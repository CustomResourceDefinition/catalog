{
  "description": "Connector is the Schema for the connectors API",
  "type": "object",
  "required": [
    "spec"
  ],
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": "string"
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "description": "ConnectorSpec defines the desired state of Connector",
      "type": "object",
      "required": [
        "connectClusterRef",
        "connectorConfigs"
      ],
      "properties": {
        "action": {
          "description": "action specifies the action on the connector.",
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "restartTask": {
              "description": "restartTask specifies the information to restart task of the connector.",
              "type": "object",
              "required": [
                "taskID"
              ],
              "properties": {
                "taskID": {
                  "description": "taskID specifies the id of the start to be restarted.",
                  "type": "integer",
                  "format": "int32"
                }
              },
              "additionalProperties": false
            },
            "type": {
              "description": "type specifies the action type for the connector.",
              "type": "string",
              "enum": [
                "pause",
                "resume",
                "restart",
                "restartTask"
              ]
            }
          },
          "additionalProperties": false
        },
        "actionPolicy": {
          "description": "actionPolicy specifies the action policy on the connector.",
          "type": "object",
          "properties": {
            "restart": {
              "description": "restart defines the policy to restart the connector.",
              "type": "object",
              "required": [
                "type"
              ],
              "properties": {
                "maxRetries": {
                  "description": "maxRetries specifies the max number of tries to restart failed tasks when the `restartPolicy` type is `OnFailure`. The default value is `10`.",
                  "type": "integer",
                  "format": "int32",
                  "minimum": 1
                },
                "type": {
                  "description": "type specifies the policy type to restart connector tasks. Valid options are `OnFailure` and `Never`. Default value is `OnFailure`, which means it will restart automatically when a task fails if the `maxRetry` value is not reached.",
                  "type": "string",
                  "enum": [
                    "OnFailure",
                    "Never"
                  ]
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "certificateStoreConfigs": {
          "description": "certificateStoreConfigs specifies the CredentialStoreConfigs used by this connector.",
          "type": "array",
          "items": {
            "description": "ObjectRef specifies a reference another Confluent Platform CR",
            "type": "object",
            "required": [
              "name"
            ],
            "properties": {
              "name": {
                "description": "Name is the name of the referenced CR",
                "type": "string",
                "maxLength": 63,
                "minLength": 1,
                "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
              },
              "namespace": {
                "description": "Namespace of the CR. Defaults to the current namespace of the CR making the reference",
                "type": "string",
                "maxLength": 255,
                "minLength": 1,
                "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
              }
            },
            "additionalProperties": false
          }
        },
        "connectClusterRef": {
          "description": "connectClusterRef references the ConnectCluster to create a connector.",
          "type": "object",
          "required": [
            "name"
          ],
          "properties": {
            "name": {
              "description": "Name is the name of the referenced CR",
              "type": "string",
              "maxLength": 63,
              "minLength": 1,
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
            },
            "namespace": {
              "description": "Namespace of the CR. Defaults to the current namespace of the CR making the reference",
              "type": "string",
              "maxLength": 255,
              "minLength": 1,
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
            }
          },
          "additionalProperties": false
        },
        "connectorConfigs": {
          "description": "connectorConfigs specifies the configs for the connector.",
          "type": "object",
          "required": [
            "class",
            "taskMax"
          ],
          "properties": {
            "class": {
              "description": "class specifies the class name of the connector. The Connect cluster displays the supported class names in its status.",
              "type": "string",
              "minLength": 1
            },
            "configs": {
              "description": "configs is a map of string key and value pairs. It specifies the additional configurations for the connector.",
              "type": "object",
              "additionalProperties": {
                "type": "string"
              },
              "x-kubernetes-map-type": "granular"
            },
            "taskMax": {
              "description": "taskMax specifies the maximum number of tasks for the connector. It must be greater than 0. The connector may create fewer tasks if it cannot achieve this level of parallelism.",
              "type": "integer",
              "format": "int32",
              "minimum": 1
            }
          },
          "additionalProperties": false
        },
        "credentialStoreConfigs": {
          "description": "credentialStoreConfigs specifies the CredentialStoreConfigs used by this connector.",
          "type": "array",
          "items": {
            "description": "ObjectRef specifies a reference another Confluent Platform CR",
            "type": "object",
            "required": [
              "name"
            ],
            "properties": {
              "name": {
                "description": "Name is the name of the referenced CR",
                "type": "string",
                "maxLength": 63,
                "minLength": 1,
                "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
              },
              "namespace": {
                "description": "Namespace of the CR. Defaults to the current namespace of the CR making the reference",
                "type": "string",
                "maxLength": 255,
                "minLength": 1,
                "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
              }
            },
            "additionalProperties": false
          }
        },
        "name": {
          "description": "name specifies the connector name. If not configured, the Connector CR name is used as the connector name.",
          "type": "string",
          "maxLength": 63,
          "minLength": 1,
          "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$"
        }
      },
      "additionalProperties": false
    },
    "status": {
      "description": "ConnectorStatus defines the observed state of Connector.",
      "type": "object",
      "properties": {
        "conditions": {
          "description": "conditions specify the latest available observations of the current state.",
          "type": "array",
          "items": {
            "description": "Condition represents the latest available observations of the current state.",
            "type": "object",
            "required": [
              "type"
            ],
            "properties": {
              "lastTransitionTime": {
                "description": "lastTransitionTime shows the last time the condition was transitioned from one status to another.",
                "type": "string",
                "format": "date-time"
              },
              "lastUpdateTime": {
                "description": "lastUpdateTime shows the last time the condition was evaluated.",
                "type": "string",
                "format": "date-time"
              },
              "message": {
                "description": "message shows a human-readable message with details about the transition.",
                "type": "string"
              },
              "reason": {
                "description": "reason shows the reason for the last transition of the condition.",
                "type": "string"
              },
              "status": {
                "description": "status shows the status of the condition, one of `True`, `False`, or `Unknown`.",
                "type": "string"
              },
              "type": {
                "description": "type shows the condition type.",
                "type": "string"
              }
            },
            "additionalProperties": false
          }
        },
        "connector": {
          "description": "connector is the name of the connector.",
          "type": "string"
        },
        "failedTasks": {
          "description": "failedTasks is the map of connector tasks in the `FAILED` state.",
          "type": "object",
          "additionalProperties": {
            "description": "TaskStatus defines the connector task status.",
            "type": "object",
            "required": [
              "id"
            ],
            "properties": {
              "id": {
                "description": "Id is the id of the task.",
                "type": "integer",
                "format": "int32"
              },
              "retryCount": {
                "description": "retryCount is the number of retry attempts to restart the failed task.",
                "type": "integer",
                "format": "int32"
              },
              "workerID": {
                "description": "workerID is the workerId for the task.",
                "type": "string"
              }
            }
          },
          "x-kubernetes-map-type": "granular"
        },
        "failedTasksCount": {
          "description": "failedTasksCount is the number of failed tasks.",
          "type": "integer",
          "format": "int32"
        },
        "observedGeneration": {
          "description": "observedGeneration is the most recent generation observed for this app.",
          "type": "integer",
          "format": "int64"
        },
        "phase": {
          "description": "phase describes the state of the Application resource.",
          "type": "string",
          "default": "Unknown",
          "enum": [
            "Unknown",
            "Bound"
          ]
        },
        "provisionToConnectCluster": {
          "description": "provisionToConnectCluster is to connect cluster this connector belongs to. The format is: `\u003cConnect cluster namespace\u003e/\u003cConnect cluster name\u003e`",
          "type": "string"
        },
        "restartPolicy": {
          "description": "restartPolicy is the policy for restart connector/tasks.",
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "maxRetries": {
              "description": "maxRetries specifies the max number of tries to restart failed tasks when the `restartPolicy` type is `OnFailure`. The default value is `10`.",
              "type": "integer",
              "format": "int32",
              "minimum": 1
            },
            "type": {
              "description": "type specifies the policy type to restart connector tasks. Valid options are `OnFailure` and `Never`. Default value is `OnFailure`, which means it will restart automatically when a task fails if the `maxRetry` value is not reached.",
              "type": "string",
              "enum": [
                "OnFailure",
                "Never"
              ]
            }
          },
          "additionalProperties": false
        },
        "state": {
          "description": "state is the state of the application",
          "type": "string",
          "default": "Unknown",
          "enum": [
            "Unknown",
            "Created",
            "Provisioning",
            "Failed",
            "DeleteRequested",
            "Error"
          ]
        },
        "tasksReady": {
          "description": "tasksReady is the number of running tasks based on `taskMax`. The value is in the following format: `\u003cnumber of running tasks\u003e/\u003ctaskMax\u003e`",
          "type": "string"
        },
        "trace": {
          "description": "trace is the error trace message for the connector instance.",
          "type": "string"
        },
        "workerID": {
          "description": "workerID is the workerId of the connector instance.",
          "type": "string"
        }
      },
      "additionalProperties": false
    }
  }
}
