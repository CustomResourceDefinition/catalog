{
  "type": "object",
  "properties": {
    "apiVersion": {
      "type": "string"
    },
    "kind": {
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "type": "object",
      "properties": {
        "filters": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "aws": {
                "type": "object",
                "properties": {
                  "accountID": {
                    "type": "boolean"
                  },
                  "alias": {
                    "type": "string"
                  },
                  "amiID": {
                    "type": "boolean"
                  },
                  "az": {
                    "type": "boolean"
                  },
                  "ec2InstanceID": {
                    "type": "boolean"
                  },
                  "ec2InstanceType": {
                    "type": "boolean"
                  },
                  "hostName": {
                    "type": "boolean"
                  },
                  "imdsVersion": {
                    "type": "string",
                    "enum": [
                      "v1",
                      "v2"
                    ]
                  },
                  "privateIP": {
                    "type": "boolean"
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  },
                  "vpcID": {
                    "type": "boolean"
                  }
                },
                "additionalProperties": false
              },
              "customPlugin": {
                "type": "object",
                "properties": {
                  "config": {
                    "type": "string"
                  },
                  "yamlConfig": {
                    "type": "object",
                    "x-kubernetes-preserve-unknown-fields": true
                  }
                },
                "additionalProperties": false
              },
              "grep": {
                "type": "object",
                "properties": {
                  "alias": {
                    "type": "string"
                  },
                  "exclude": {
                    "type": "string"
                  },
                  "regex": {
                    "type": "string"
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  }
                },
                "additionalProperties": false
              },
              "kubernetes": {
                "type": "object",
                "properties": {
                  "alias": {
                    "type": "string"
                  },
                  "annotations": {
                    "type": "boolean"
                  },
                  "bufferSize": {
                    "type": "string",
                    "pattern": "^\\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$"
                  },
                  "cacheUseDockerId": {
                    "type": "boolean"
                  },
                  "dnsRetries": {
                    "type": "integer",
                    "format": "int32"
                  },
                  "dnsWaitTime": {
                    "type": "integer",
                    "format": "int32"
                  },
                  "dummyMeta": {
                    "type": "boolean"
                  },
                  "k8sLoggingExclude": {
                    "type": "boolean"
                  },
                  "k8sLoggingParser": {
                    "type": "boolean"
                  },
                  "keepLog": {
                    "type": "boolean"
                  },
                  "kubeCAFile": {
                    "type": "string"
                  },
                  "kubeCAPath": {
                    "type": "string"
                  },
                  "kubeMetaCacheTTL": {
                    "type": "string"
                  },
                  "kubeMetaNamespaceCacheTTL": {
                    "type": "integer",
                    "format": "int32"
                  },
                  "kubeMetaPreloadCacheDir": {
                    "type": "string"
                  },
                  "kubeTagPrefix": {
                    "type": "string"
                  },
                  "kubeTokenCommand": {
                    "type": "string"
                  },
                  "kubeTokenFile": {
                    "type": "string"
                  },
                  "kubeTokenTTL": {
                    "type": "string"
                  },
                  "kubeURL": {
                    "type": "string"
                  },
                  "kubeletHost": {
                    "type": "string"
                  },
                  "kubeletPort": {
                    "type": "integer",
                    "format": "int32"
                  },
                  "labels": {
                    "type": "boolean"
                  },
                  "mergeLog": {
                    "type": "boolean"
                  },
                  "mergeLogKey": {
                    "type": "string"
                  },
                  "mergeLogTrim": {
                    "type": "boolean"
                  },
                  "mergeParser": {
                    "type": "string"
                  },
                  "namespaceAnnotations": {
                    "type": "boolean"
                  },
                  "namespaceLabels": {
                    "type": "boolean"
                  },
                  "namespaceMetadataOnly": {
                    "type": "boolean"
                  },
                  "ownerReferences": {
                    "type": "boolean"
                  },
                  "regexParser": {
                    "type": "string"
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  },
                  "tlsDebug": {
                    "type": "integer",
                    "format": "int32"
                  },
                  "tlsVerify": {
                    "type": "boolean"
                  },
                  "useJournal": {
                    "type": "boolean"
                  },
                  "useKubelet": {
                    "type": "boolean"
                  },
                  "useTagForMeta": {
                    "type": "boolean"
                  }
                },
                "additionalProperties": false
              },
              "logToMetrics": {
                "type": "object",
                "properties": {
                  "addLabel": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "alias": {
                    "type": "string"
                  },
                  "bucket": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "discardLogs": {
                    "type": "boolean"
                  },
                  "emitterMemBufLimit": {
                    "type": "string"
                  },
                  "emitterName": {
                    "type": "string"
                  },
                  "exclude": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "kubernetesMode": {
                    "type": "boolean"
                  },
                  "labelField": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "metricDescription": {
                    "type": "string"
                  },
                  "metricMode": {
                    "type": "string"
                  },
                  "metricName": {
                    "type": "string"
                  },
                  "metricNamespace": {
                    "type": "string"
                  },
                  "metricSubsystem": {
                    "type": "string"
                  },
                  "regex": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  },
                  "tag": {
                    "type": "string"
                  },
                  "valueField": {
                    "type": "string"
                  }
                },
                "additionalProperties": false
              },
              "lua": {
                "type": "object",
                "required": [
                  "call"
                ],
                "properties": {
                  "alias": {
                    "type": "string"
                  },
                  "call": {
                    "type": "string"
                  },
                  "code": {
                    "type": "string"
                  },
                  "protectedMode": {
                    "type": "boolean"
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  },
                  "script": {
                    "type": "object",
                    "required": [
                      "key"
                    ],
                    "properties": {
                      "key": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string",
                        "default": ""
                      },
                      "optional": {
                        "type": "boolean"
                      }
                    },
                    "additionalProperties": false,
                    "x-kubernetes-map-type": "atomic"
                  },
                  "timeAsTable": {
                    "type": "boolean"
                  },
                  "typeArrayKey": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "typeIntKey": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                },
                "additionalProperties": false
              },
              "modify": {
                "type": "object",
                "properties": {
                  "alias": {
                    "type": "string"
                  },
                  "conditions": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "aKeyMatches": {
                          "type": "string"
                        },
                        "keyDoesNotExist": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "keyExists": {
                          "type": "string"
                        },
                        "keyValueDoesNotEqual": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "keyValueDoesNotMatch": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "keyValueEquals": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "keyValueMatches": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "matchingKeysDoNotHaveMatchingValues": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "matchingKeysHaveMatchingValues": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "noKeyMatches": {
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  },
                  "rules": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "add": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "copy": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "hardCopy": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "hardRename": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "remove": {
                          "type": "string"
                        },
                        "removeRegex": {
                          "type": "string"
                        },
                        "removeWildcard": {
                          "type": "string"
                        },
                        "rename": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "set": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        }
                      },
                      "additionalProperties": false
                    }
                  }
                },
                "additionalProperties": false
              },
              "multiline": {
                "type": "object",
                "required": [
                  "parser"
                ],
                "properties": {
                  "alias": {
                    "type": "string"
                  },
                  "buffer": {
                    "type": "boolean",
                    "default": false
                  },
                  "emitterMemBufLimit": {
                    "type": "integer",
                    "default": 10
                  },
                  "emitterName": {
                    "type": "string"
                  },
                  "emitterType": {
                    "type": "string",
                    "default": "memory",
                    "enum": [
                      "memory",
                      "filesystem"
                    ]
                  },
                  "flushMs": {
                    "type": "integer",
                    "default": 2000
                  },
                  "keyContent": {
                    "type": "string"
                  },
                  "mode": {
                    "type": "string",
                    "enum": [
                      "parser",
                      "partial_message"
                    ]
                  },
                  "parser": {
                    "type": "string"
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  }
                },
                "additionalProperties": false
              },
              "nest": {
                "type": "object",
                "properties": {
                  "addPrefix": {
                    "type": "string"
                  },
                  "alias": {
                    "type": "string"
                  },
                  "nestUnder": {
                    "type": "string"
                  },
                  "nestedUnder": {
                    "type": "string"
                  },
                  "operation": {
                    "type": "string",
                    "enum": [
                      "nest",
                      "lift"
                    ]
                  },
                  "removePrefix": {
                    "type": "string"
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  },
                  "wildcard": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                },
                "additionalProperties": false
              },
              "parser": {
                "type": "object",
                "properties": {
                  "alias": {
                    "type": "string"
                  },
                  "keyName": {
                    "type": "string"
                  },
                  "parser": {
                    "type": "string"
                  },
                  "preserveKey": {
                    "type": "boolean"
                  },
                  "reserveData": {
                    "type": "boolean"
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  },
                  "unescapeKey": {
                    "type": "boolean"
                  }
                },
                "additionalProperties": false
              },
              "recordModifier": {
                "type": "object",
                "properties": {
                  "alias": {
                    "type": "string"
                  },
                  "allowlistKeys": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "records": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "removeKeys": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  },
                  "uuidKeys": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "whitelistKeys": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                },
                "additionalProperties": false
              },
              "rewriteTag": {
                "type": "object",
                "properties": {
                  "alias": {
                    "type": "string"
                  },
                  "emitterMemBufLimit": {
                    "type": "string"
                  },
                  "emitterName": {
                    "type": "string"
                  },
                  "emitterStorageType": {
                    "type": "string"
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  },
                  "rules": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                },
                "additionalProperties": false
              },
              "throttle": {
                "type": "object",
                "properties": {
                  "alias": {
                    "type": "string"
                  },
                  "interval": {
                    "type": "string",
                    "pattern": "^\\d+(\\.[0-9]{0,2})?(s|m|h|d)?$"
                  },
                  "printStatus": {
                    "type": "boolean"
                  },
                  "rate": {
                    "type": "integer",
                    "format": "int64"
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  },
                  "window": {
                    "type": "integer",
                    "format": "int64"
                  }
                },
                "additionalProperties": false
              },
              "wasm": {
                "type": "object",
                "properties": {
                  "accessiblePaths": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "alias": {
                    "type": "string"
                  },
                  "eventFormat": {
                    "type": "string"
                  },
                  "functionName": {
                    "type": "string"
                  },
                  "retryLimit": {
                    "type": "string",
                    "pattern": "^(((f|F)alse)|(no_limits)|(no_retries)|([1-9]+[0-9]*))$"
                  },
                  "wasmHeapSize": {
                    "type": "string",
                    "pattern": "^\\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$"
                  },
                  "wasmPath": {
                    "type": "string"
                  },
                  "wasmStackSize": {
                    "type": "string",
                    "pattern": "^\\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$"
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          }
        },
        "logLevel": {
          "type": "string",
          "enum": [
            "off",
            "error",
            "warning",
            "info",
            "debug",
            "trace"
          ]
        },
        "match": {
          "type": "string"
        },
        "matchRegex": {
          "type": "string"
        },
        "ordinal": {
          "type": "integer",
          "format": "int32"
        }
      },
      "additionalProperties": false
    }
  }
}
