{
  "type": "object",
  "properties": {
    "spec": {
      "type": "object",
      "required": [
        "priority"
      ],
      "properties": {
        "appliedTo": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "externalEntitySelector": {
                "type": "object",
                "properties": {
                  "matchExpressions": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "key": {
                          "type": "string"
                        },
                        "operator": {
                          "type": "string",
                          "enum": [
                            "In",
                            "NotIn",
                            "Exists",
                            "DoesNotExist"
                          ]
                        },
                        "values": {
                          "type": "array",
                          "items": {
                            "type": "string",
                            "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                          }
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "matchLabels": {
                    "x-kubernetes-preserve-unknown-fields": true
                  }
                },
                "additionalProperties": false
              },
              "group": {
                "type": "string"
              },
              "podSelector": {
                "type": "object",
                "properties": {
                  "matchExpressions": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "key": {
                          "type": "string"
                        },
                        "operator": {
                          "type": "string",
                          "enum": [
                            "In",
                            "NotIn",
                            "Exists",
                            "DoesNotExist"
                          ]
                        },
                        "values": {
                          "type": "array",
                          "items": {
                            "type": "string",
                            "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                          }
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "matchLabels": {
                    "x-kubernetes-preserve-unknown-fields": true
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          }
        },
        "egress": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "action"
            ],
            "properties": {
              "action": {
                "type": "string",
                "enum": [
                  "Allow",
                  "Drop",
                  "Reject",
                  "Pass"
                ]
              },
              "appliedTo": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "group": {
                      "type": "string"
                    },
                    "podSelector": {
                      "type": "object",
                      "properties": {
                        "matchExpressions": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "type": "string",
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ]
                              },
                              "values": {
                                "type": "array",
                                "items": {
                                  "type": "string",
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                                }
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "matchLabels": {
                          "x-kubernetes-preserve-unknown-fields": true
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "additionalProperties": false
                }
              },
              "enableLogging": {
                "type": "boolean"
              },
              "l7Protocols": {
                "type": "array",
                "items": {
                  "type": "object",
                  "oneOf": [
                    {
                      "required": [
                        "http"
                      ]
                    },
                    {
                      "required": [
                        "tls"
                      ]
                    }
                  ],
                  "properties": {
                    "http": {
                      "type": "object",
                      "properties": {
                        "host": {
                          "type": "string"
                        },
                        "method": {
                          "type": "string",
                          "enum": [
                            "GET",
                            "POST",
                            "PUT",
                            "HEAD",
                            "DELETE",
                            "TRACE",
                            "OPTIONS",
                            "CONNECT",
                            "PATCH"
                          ]
                        },
                        "path": {
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    },
                    "tls": {
                      "type": "object",
                      "properties": {
                        "sni": {
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "additionalProperties": false
                }
              },
              "logLabel": {
                "type": "string",
                "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]{0,61})?[A-Za-z0-9])?$"
              },
              "name": {
                "type": "string"
              },
              "ports": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "endPort": {
                      "type": "integer"
                    },
                    "port": {
                      "x-kubernetes-int-or-string": true
                    },
                    "protocol": {
                      "type": "string",
                      "enum": [
                        "TCP",
                        "UDP",
                        "SCTP"
                      ]
                    },
                    "sourceEndPort": {
                      "type": "integer"
                    },
                    "sourcePort": {
                      "type": "integer"
                    }
                  },
                  "additionalProperties": false
                }
              },
              "protocols": {
                "type": "array",
                "items": {
                  "type": "object",
                  "oneOf": [
                    {
                      "required": [
                        "icmp"
                      ]
                    },
                    {
                      "required": [
                        "igmp"
                      ]
                    }
                  ],
                  "properties": {
                    "icmp": {
                      "type": "object",
                      "properties": {
                        "icmpCode": {
                          "type": "integer",
                          "maximum": 255,
                          "minimum": 0
                        },
                        "icmpType": {
                          "type": "integer",
                          "maximum": 255,
                          "minimum": 0
                        }
                      },
                      "additionalProperties": false
                    },
                    "igmp": {
                      "type": "object",
                      "properties": {
                        "groupAddress": {
                          "type": "string",
                          "oneOf": [
                            {
                              "format": "ipv4"
                            },
                            {
                              "format": "ipv6"
                            }
                          ]
                        },
                        "igmpType": {
                          "type": "integer",
                          "enum": [
                            18,
                            22,
                            34
                          ]
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "additionalProperties": false
                }
              },
              "to": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "externalEntitySelector": {
                      "type": "object",
                      "properties": {
                        "matchExpressions": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "type": "string",
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ]
                              },
                              "values": {
                                "type": "array",
                                "items": {
                                  "type": "string",
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                                }
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "matchLabels": {
                          "x-kubernetes-preserve-unknown-fields": true
                        }
                      },
                      "additionalProperties": false
                    },
                    "fqdn": {
                      "type": "string"
                    },
                    "group": {
                      "type": "string"
                    },
                    "ipBlock": {
                      "type": "object",
                      "properties": {
                        "cidr": {
                          "type": "string",
                          "format": "cidr"
                        }
                      },
                      "additionalProperties": false
                    },
                    "namespaceSelector": {
                      "type": "object",
                      "properties": {
                        "matchExpressions": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "type": "string",
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ]
                              },
                              "values": {
                                "type": "array",
                                "items": {
                                  "type": "string",
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                                }
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "matchLabels": {
                          "x-kubernetes-preserve-unknown-fields": true
                        }
                      },
                      "additionalProperties": false
                    },
                    "nodeSelector": {
                      "type": "object",
                      "properties": {
                        "matchExpressions": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "type": "string",
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ]
                              },
                              "values": {
                                "type": "array",
                                "items": {
                                  "type": "string",
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                                }
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "matchLabels": {
                          "x-kubernetes-preserve-unknown-fields": true
                        }
                      },
                      "additionalProperties": false
                    },
                    "podSelector": {
                      "type": "object",
                      "properties": {
                        "matchExpressions": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "type": "string",
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ]
                              },
                              "values": {
                                "type": "array",
                                "items": {
                                  "type": "string",
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                                }
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "matchLabels": {
                          "x-kubernetes-preserve-unknown-fields": true
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "additionalProperties": false
                }
              },
              "toServices": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": [
                    "name"
                  ],
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "namespace": {
                      "type": "string"
                    },
                    "scope": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                }
              }
            },
            "additionalProperties": false
          }
        },
        "ingress": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "action"
            ],
            "properties": {
              "action": {
                "type": "string",
                "enum": [
                  "Allow",
                  "Drop",
                  "Reject",
                  "Pass"
                ]
              },
              "appliedTo": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "group": {
                      "type": "string"
                    },
                    "podSelector": {
                      "type": "object",
                      "properties": {
                        "matchExpressions": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "type": "string",
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ]
                              },
                              "values": {
                                "type": "array",
                                "items": {
                                  "type": "string",
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                                }
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "matchLabels": {
                          "x-kubernetes-preserve-unknown-fields": true
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "additionalProperties": false
                }
              },
              "enableLogging": {
                "type": "boolean"
              },
              "from": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "externalEntitySelector": {
                      "type": "object",
                      "properties": {
                        "matchExpressions": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "type": "string",
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ]
                              },
                              "values": {
                                "type": "array",
                                "items": {
                                  "type": "string",
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                                }
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "matchLabels": {
                          "x-kubernetes-preserve-unknown-fields": true
                        }
                      },
                      "additionalProperties": false
                    },
                    "group": {
                      "type": "string"
                    },
                    "ipBlock": {
                      "type": "object",
                      "properties": {
                        "cidr": {
                          "type": "string",
                          "format": "cidr"
                        }
                      },
                      "additionalProperties": false
                    },
                    "namespaceSelector": {
                      "type": "object",
                      "properties": {
                        "matchExpressions": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "type": "string",
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ]
                              },
                              "values": {
                                "type": "array",
                                "items": {
                                  "type": "string",
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                                }
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "matchLabels": {
                          "x-kubernetes-preserve-unknown-fields": true
                        }
                      },
                      "additionalProperties": false
                    },
                    "nodeSelector": {
                      "type": "object",
                      "properties": {
                        "matchExpressions": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "type": "string",
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ]
                              },
                              "values": {
                                "type": "array",
                                "items": {
                                  "type": "string",
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                                }
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "matchLabels": {
                          "x-kubernetes-preserve-unknown-fields": true
                        }
                      },
                      "additionalProperties": false
                    },
                    "podSelector": {
                      "type": "object",
                      "properties": {
                        "matchExpressions": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "key": {
                                "type": "string"
                              },
                              "operator": {
                                "type": "string",
                                "enum": [
                                  "In",
                                  "NotIn",
                                  "Exists",
                                  "DoesNotExist"
                                ]
                              },
                              "values": {
                                "type": "array",
                                "items": {
                                  "type": "string",
                                  "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$"
                                }
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "matchLabels": {
                          "x-kubernetes-preserve-unknown-fields": true
                        }
                      },
                      "additionalProperties": false
                    },
                    "scope": {
                      "type": "string",
                      "enum": [
                        "Cluster",
                        "ClusterSet"
                      ]
                    }
                  },
                  "additionalProperties": false
                }
              },
              "l7Protocols": {
                "type": "array",
                "items": {
                  "type": "object",
                  "oneOf": [
                    {
                      "required": [
                        "http"
                      ]
                    },
                    {
                      "required": [
                        "tls"
                      ]
                    }
                  ],
                  "properties": {
                    "http": {
                      "type": "object",
                      "properties": {
                        "host": {
                          "type": "string"
                        },
                        "method": {
                          "type": "string",
                          "enum": [
                            "GET",
                            "POST",
                            "PUT",
                            "HEAD",
                            "DELETE",
                            "TRACE",
                            "OPTIONS",
                            "CONNECT",
                            "PATCH"
                          ]
                        },
                        "path": {
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    },
                    "tls": {
                      "type": "object",
                      "properties": {
                        "sni": {
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "additionalProperties": false
                }
              },
              "logLabel": {
                "type": "string",
                "pattern": "^(([A-Za-z0-9][-A-Za-z0-9_.]{0,61})?[A-Za-z0-9])?$"
              },
              "name": {
                "type": "string"
              },
              "ports": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "endPort": {
                      "type": "integer"
                    },
                    "port": {
                      "x-kubernetes-int-or-string": true
                    },
                    "protocol": {
                      "type": "string",
                      "enum": [
                        "TCP",
                        "UDP",
                        "SCTP"
                      ]
                    },
                    "sourceEndPort": {
                      "type": "integer"
                    },
                    "sourcePort": {
                      "type": "integer"
                    }
                  },
                  "additionalProperties": false
                }
              },
              "protocols": {
                "type": "array",
                "items": {
                  "type": "object",
                  "oneOf": [
                    {
                      "required": [
                        "icmp"
                      ]
                    },
                    {
                      "required": [
                        "igmp"
                      ]
                    }
                  ],
                  "properties": {
                    "icmp": {
                      "type": "object",
                      "properties": {
                        "icmpCode": {
                          "type": "integer",
                          "maximum": 255,
                          "minimum": 0
                        },
                        "icmpType": {
                          "type": "integer",
                          "maximum": 255,
                          "minimum": 0
                        }
                      },
                      "additionalProperties": false
                    },
                    "igmp": {
                      "type": "object",
                      "properties": {
                        "groupAddress": {
                          "type": "string",
                          "oneOf": [
                            {
                              "format": "ipv4"
                            },
                            {
                              "format": "ipv6"
                            }
                          ]
                        },
                        "igmpType": {
                          "type": "integer",
                          "enum": [
                            17
                          ]
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "additionalProperties": false
                }
              }
            },
            "additionalProperties": false
          }
        },
        "priority": {
          "type": "number",
          "format": "float",
          "maximum": 10000,
          "minimum": 1
        },
        "tier": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "status": {
      "type": "object",
      "properties": {
        "conditions": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "lastTransitionTime": {
                "type": "string"
              },
              "message": {
                "type": "string"
              },
              "reason": {
                "type": "string"
              },
              "status": {
                "type": "string"
              },
              "type": {
                "type": "string"
              }
            },
            "additionalProperties": false
          }
        },
        "currentNodesRealized": {
          "type": "integer"
        },
        "desiredNodesRealized": {
          "type": "integer"
        },
        "observedGeneration": {
          "type": "integer"
        },
        "phase": {
          "type": "string"
        }
      },
      "additionalProperties": false
    }
  }
}
