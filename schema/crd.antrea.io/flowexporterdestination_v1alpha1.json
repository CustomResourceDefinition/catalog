{
  "type": "object",
  "required": [
    "spec"
  ],
  "properties": {
    "spec": {
      "type": "object",
      "required": [
        "address",
        "protocol"
      ],
      "properties": {
        "activeFlowExportTimeoutSeconds": {
          "description": "Provide the active flow export timeout in seconds, which is the timeout after which a flow record is sent to the collector for active flows. Thus, for flows with a continuous stream of packets, a flow record will be exported to the collector once the elapsed time since the last export event is equal to the value of this timeout.\n",
          "type": "integer",
          "format": "int32",
          "default": 5,
          "minimum": 1
        },
        "address": {
          "description": "The flow collector address including port as a string.\nExample: - flow-aggregator/flow-aggregator:14739 - 10.244.10.10:4739\n",
          "type": "string",
          "pattern": "^.+:[0-9]+$"
        },
        "filter": {
          "type": "object",
          "properties": {
            "protocols": {
              "description": "Filter for only flows whose protocol which match this filter. The default is accept all protocols if unset or nil.\nSupported values are [tcp, udp, sctp].\n",
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "tcp",
                  "udp",
                  "sctp"
                ]
              }
            }
          },
          "additionalProperties": false
        },
        "idleFlowExportTimeoutSeconds": {
          "description": "Provide the idle flow export timeout in seconds, which is the timeout after which a flow record is sent to the collector for idle flows. A flow is considered idle if no packet matching this flow has been observed since the last export event.\n",
          "type": "integer",
          "format": "int32",
          "default": 15,
          "minimum": 1
        },
        "protocol": {
          "description": "The protocol used to send flow details.\nExactly one must be defined and non-nil.\n",
          "type": "object",
          "oneOf": [
            {
              "required": [
                "ipfix"
              ]
            },
            {
              "required": [
                "grpc"
              ]
            }
          ],
          "properties": {
            "grpc": {
              "description": "Configuration for using gRPC protocol.",
              "type": "object"
            },
            "ipfix": {
              "description": "Configuration for using IPFIX protocol.",
              "type": "object",
              "required": [
                "transport"
              ],
              "properties": {
                "transport": {
                  "type": "string",
                  "enum": [
                    "tcp",
                    "udp",
                    "tls"
                  ]
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "tlsConfig": {
          "type": "object",
          "required": [
            "caConfigMap"
          ],
          "properties": {
            "caConfigMap": {
              "description": "Specify the location of the ConfigMap containing the CA certificate used to authenticate the collector service. The ConfigMap must store the certificate under the key 'ca.crt'. To ensure flow exporter will have access to this resource it must be granted the proper RBAC permissions.\n",
              "type": "object",
              "required": [
                "namespace",
                "name"
              ],
              "properties": {
                "name": {
                  "description": "Name of the ConfigMap containing the CA certificate.",
                  "type": "string",
                  "minLength": 1
                },
                "namespace": {
                  "description": "Namespace of the ConfigMap containing the CA certificate.",
                  "type": "string",
                  "minLength": 1
                }
              },
              "additionalProperties": false
            },
            "clientSecret": {
              "description": "Specify the location of the Secret containing the client certificate and private key for mTLS. The Secret must contain the keys 'tls.crt' and 'tls.key'. If omitted, client authentication will be disabled. To ensure flow exporter will have access to this resource it must be granted the proper RBAC permissions.\n",
              "type": "object",
              "required": [
                "namespace",
                "name"
              ],
              "properties": {
                "name": {
                  "description": "Name of the Secret containing the client certificate/key.",
                  "type": "string",
                  "minLength": 1
                },
                "namespace": {
                  "description": "Namespace of the Secret containing the client certificate/key.",
                  "type": "string",
                  "minLength": 1
                }
              },
              "additionalProperties": false
            },
            "minTLSVersion": {
              "description": "minTLSVersion specifies which version of TLS the client should accept from the server. This defaults to VersionTLS12 if unspecified.\n",
              "type": "string",
              "default": "VersionTLS12",
              "enum": [
                "VersionTLS12",
                "VersionTLS13"
              ]
            },
            "serverName": {
              "description": "serverName is used to verify the hostname on the returned certificate. If specified it will be included in the client's handshake (SNI) to support virtual hosting unless it is an IP address. If this field is omitted, the hostname used for certificate  verification will default to the provided server address (spec.address).\n",
              "type": "string",
              "minLength": 1
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  }
}
