{
  "description": "Schema defines the CRD for a Redpanda schema.",
  "type": "object",
  "required": [
    "spec"
  ],
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object.\nServers should convert recognized schemas to the latest internal value, and\nmay reject unrecognized values.\nMore info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": "string"
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents.\nServers may infer this from the endpoint the client submits requests to.\nCannot be updated.\nIn CamelCase.\nMore info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "description": "Defines the desired state of the Redpanda schema.",
      "type": "object",
      "required": [
        "cluster",
        "text"
      ],
      "properties": {
        "cluster": {
          "description": "ClusterSource is a reference to the cluster hosting the schema registry.\nIt is used in constructing the client created to configure a cluster.",
          "type": "object",
          "properties": {
            "clusterRef": {
              "description": "ClusterRef is a reference to the cluster where the object should be created.\nIt is used in constructing the client created to configure a cluster.\nThis takes precedence over StaticConfigurationSource.",
              "type": "object",
              "required": [
                "name"
              ],
              "properties": {
                "name": {
                  "description": "Name specifies the name of the cluster being referenced.",
                  "type": "string"
                }
              },
              "additionalProperties": false
            },
            "staticConfiguration": {
              "description": "StaticConfiguration holds connection parameters to Kafka and Admin APIs.",
              "type": "object",
              "properties": {
                "admin": {
                  "description": "AdminAPISpec is the configuration information for communicating with the Admin\nAPI of a Redpanda cluster where the object should be created.",
                  "type": "object",
                  "required": [
                    "urls"
                  ],
                  "properties": {
                    "sasl": {
                      "description": "Defines authentication configuration settings for Redpanda clusters that have authentication enabled.",
                      "type": "object",
                      "required": [
                        "mechanism"
                      ],
                      "properties": {
                        "mechanism": {
                          "description": "Specifies the SASL/SCRAM authentication mechanism.",
                          "type": "string"
                        },
                        "passwordSecretRef": {
                          "description": "Specifies the password.",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "token": {
                          "description": "Specifies token for token-based authentication (only used if no username/password are provided).",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "username": {
                          "description": "Specifies the username.",
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    },
                    "tls": {
                      "description": "Defines TLS configuration settings for Redpanda clusters that have TLS enabled.",
                      "type": "object",
                      "properties": {
                        "caCertSecretRef": {
                          "description": "CaCert is the reference for certificate authority used to establish TLS connection to Redpanda",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "certSecretRef": {
                          "description": "Cert is the reference for client public certificate to establish mTLS connection to Redpanda",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "insecureSkipTlsVerify": {
                          "description": "InsecureSkipTLSVerify can skip verifying Redpanda self-signed certificate when establish TLS connection to Redpanda",
                          "type": "boolean"
                        },
                        "keySecretRef": {
                          "description": "Key is the reference for client private certificate to establish mTLS connection to Redpanda",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "additionalProperties": false
                    },
                    "urls": {
                      "description": "Specifies a list of broker addresses in the format \u003chost\u003e:\u003cport\u003e",
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                },
                "kafka": {
                  "description": "Kafka is the configuration information for communicating with the Kafka\nAPI of a Redpanda cluster where the object should be created.",
                  "type": "object",
                  "required": [
                    "brokers"
                  ],
                  "properties": {
                    "brokers": {
                      "description": "Specifies a list of broker addresses in the format \u003chost\u003e:\u003cport\u003e",
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    "sasl": {
                      "description": "Defines authentication configuration settings for Redpanda clusters that have authentication enabled.",
                      "type": "object",
                      "required": [
                        "mechanism"
                      ],
                      "properties": {
                        "awsMskIam": {
                          "description": "KafkaSASLAWSMskIam is the config for AWS IAM SASL mechanism,\nsee: https://docs.aws.amazon.com/msk/latest/developerguide/iam-access-control.html",
                          "type": "object",
                          "required": [
                            "accessKey",
                            "secretKeySecretRef",
                            "sessionTokenSecretRef",
                            "userAgent"
                          ],
                          "properties": {
                            "accessKey": {
                              "type": "string"
                            },
                            "secretKeySecretRef": {
                              "description": "SecretKeyRef contains enough information to inspect or modify the referred Secret data\nSee https://pkg.go.dev/k8s.io/api/core/v1#ObjectReference.",
                              "type": "object",
                              "required": [
                                "name"
                              ],
                              "properties": {
                                "key": {
                                  "description": "Key in Secret data to get value from",
                                  "type": "string"
                                },
                                "name": {
                                  "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                                  "type": "string"
                                }
                              },
                              "additionalProperties": false
                            },
                            "sessionTokenSecretRef": {
                              "description": "SessionToken, if non-empty, is a session / security token to use for authentication.\nSee: https://docs.aws.amazon.com/STS/latest/APIReference/welcome.html",
                              "type": "object",
                              "required": [
                                "name"
                              ],
                              "properties": {
                                "key": {
                                  "description": "Key in Secret data to get value from",
                                  "type": "string"
                                },
                                "name": {
                                  "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                                  "type": "string"
                                }
                              },
                              "additionalProperties": false
                            },
                            "userAgent": {
                              "description": "UserAgent is the user agent to for the client to use when connecting\nto Kafka, overriding the default \"franz-go/\u003cruntime.Version()\u003e/\u003chostname\u003e\".\n\nSetting a UserAgent allows authorizing based on the aws:UserAgent\ncondition key; see the following link for more details:\nhttps://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-useragent",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "gssapi": {
                          "description": "KafkaSASLGSSAPI represents the Kafka Kerberos config.",
                          "type": "object",
                          "required": [
                            "authType",
                            "enableFast",
                            "kerberosConfigPath",
                            "keyTabPath",
                            "passwordSecretRef",
                            "realm",
                            "serviceName",
                            "username"
                          ],
                          "properties": {
                            "authType": {
                              "type": "string"
                            },
                            "enableFast": {
                              "description": "EnableFAST enables FAST, which is a pre-authentication framework for Kerberos.\nIt includes a mechanism for tunneling pre-authentication exchanges using armored KDC messages.\nFAST provides increased resistance to passive password guessing attacks.",
                              "type": "boolean"
                            },
                            "kerberosConfigPath": {
                              "type": "string"
                            },
                            "keyTabPath": {
                              "type": "string"
                            },
                            "passwordSecretRef": {
                              "description": "SecretKeyRef contains enough information to inspect or modify the referred Secret data\nSee https://pkg.go.dev/k8s.io/api/core/v1#ObjectReference.",
                              "type": "object",
                              "required": [
                                "name"
                              ],
                              "properties": {
                                "key": {
                                  "description": "Key in Secret data to get value from",
                                  "type": "string"
                                },
                                "name": {
                                  "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                                  "type": "string"
                                }
                              },
                              "additionalProperties": false
                            },
                            "realm": {
                              "type": "string"
                            },
                            "serviceName": {
                              "type": "string"
                            },
                            "username": {
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "mechanism": {
                          "description": "Specifies the SASL/SCRAM authentication mechanism.",
                          "type": "string"
                        },
                        "oauth": {
                          "description": "KafkaSASLOAuthBearer is the config struct for the SASL OAuthBearer mechanism",
                          "type": "object",
                          "required": [
                            "tokenSecretRef"
                          ],
                          "properties": {
                            "tokenSecretRef": {
                              "description": "SecretKeyRef contains enough information to inspect or modify the referred Secret data\nSee https://pkg.go.dev/k8s.io/api/core/v1#ObjectReference.",
                              "type": "object",
                              "required": [
                                "name"
                              ],
                              "properties": {
                                "key": {
                                  "description": "Key in Secret data to get value from",
                                  "type": "string"
                                },
                                "name": {
                                  "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                                  "type": "string"
                                }
                              },
                              "additionalProperties": false
                            }
                          },
                          "additionalProperties": false
                        },
                        "passwordSecretRef": {
                          "description": "Specifies the password.",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "username": {
                          "description": "Specifies the username.",
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    },
                    "tls": {
                      "description": "Defines TLS configuration settings for Redpanda clusters that have TLS enabled.",
                      "type": "object",
                      "properties": {
                        "caCertSecretRef": {
                          "description": "CaCert is the reference for certificate authority used to establish TLS connection to Redpanda",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "certSecretRef": {
                          "description": "Cert is the reference for client public certificate to establish mTLS connection to Redpanda",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "insecureSkipTlsVerify": {
                          "description": "InsecureSkipTLSVerify can skip verifying Redpanda self-signed certificate when establish TLS connection to Redpanda",
                          "type": "boolean"
                        },
                        "keySecretRef": {
                          "description": "Key is the reference for client private certificate to establish mTLS connection to Redpanda",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "additionalProperties": false
                },
                "schemaRegistry": {
                  "description": "SchemaRegistry is the configuration information for communicating with the Schema Registry\nAPI of a Redpanda cluster where the object should be created.",
                  "type": "object",
                  "required": [
                    "urls"
                  ],
                  "properties": {
                    "sasl": {
                      "description": "Defines authentication configuration settings for Redpanda clusters that have authentication enabled.",
                      "type": "object",
                      "required": [
                        "mechanism"
                      ],
                      "properties": {
                        "mechanism": {
                          "description": "Specifies the SASL/SCRAM authentication mechanism.",
                          "type": "string"
                        },
                        "passwordSecretRef": {
                          "description": "Specifies the password.",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "token": {
                          "description": "SecretKeyRef contains enough information to inspect or modify the referred Secret data\nSee https://pkg.go.dev/k8s.io/api/core/v1#ObjectReference.",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "username": {
                          "description": "Specifies the username.",
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    },
                    "tls": {
                      "description": "Defines TLS configuration settings for Redpanda clusters that have TLS enabled.",
                      "type": "object",
                      "properties": {
                        "caCertSecretRef": {
                          "description": "CaCert is the reference for certificate authority used to establish TLS connection to Redpanda",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "certSecretRef": {
                          "description": "Cert is the reference for client public certificate to establish mTLS connection to Redpanda",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        },
                        "insecureSkipTlsVerify": {
                          "description": "InsecureSkipTLSVerify can skip verifying Redpanda self-signed certificate when establish TLS connection to Redpanda",
                          "type": "boolean"
                        },
                        "keySecretRef": {
                          "description": "Key is the reference for client private certificate to establish mTLS connection to Redpanda",
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "key": {
                              "description": "Key in Secret data to get value from",
                              "type": "string"
                            },
                            "name": {
                              "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "additionalProperties": false
                    },
                    "urls": {
                      "description": "Specifies a list of broker addresses in the format \u003chost\u003e:\u003cport\u003e",
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false,
          "x-kubernetes-validations": [
            {
              "rule": "!has(self.staticConfiguration) || has(self.staticConfiguration.schemaRegistry)",
              "message": "spec.cluster.staticConfiguration.schemaRegistry: required value"
            },
            {
              "rule": "has(self.clusterRef) || has(self.staticConfiguration)",
              "message": "either clusterRef or staticConfiguration must be set"
            },
            {
              "rule": "self == oldSelf",
              "message": "ClusterSource is immutable"
            }
          ]
        },
        "compatibilityLevel": {
          "description": "CompatibilityLevel sets the compatibility level for the given schema",
          "type": "string",
          "default": "Backward",
          "enum": [
            "None",
            "Backward",
            "BackwardTransitive",
            "Forward",
            "ForwardTransitive",
            "Full",
            "FullTransitive"
          ]
        },
        "references": {
          "description": "References declares other schemas this schema references. See the\ndocs on SchemaReference for more details.",
          "type": "array",
          "items": {
            "description": "SchemaReference is a way for a one schema to reference another. The\ndetails for how referencing is done are type specific; for example,\nJSON objects that use the key \"$ref\" can refer to another schema via\nURL.",
            "type": "object",
            "required": [
              "name",
              "subject",
              "version"
            ],
            "properties": {
              "name": {
                "type": "string"
              },
              "subject": {
                "type": "string"
              },
              "version": {
                "type": "integer"
              }
            },
            "additionalProperties": false
          }
        },
        "schemaType": {
          "description": "Type is the type of a schema. The default type is avro.",
          "type": "string",
          "default": "avro",
          "enum": [
            "avro",
            "protobuf",
            "json"
          ]
        },
        "text": {
          "description": "Text is the actual unescaped text of a schema.",
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "status": {
      "description": "Represents the current status of the Redpanda schema.",
      "type": "object",
      "default": {
        "conditions": [
          {
            "lastTransitionTime": "1970-01-01T00:00:00Z",
            "message": "Waiting for controller",
            "reason": "Pending",
            "status": "Unknown",
            "type": "Synced"
          }
        ]
      },
      "properties": {
        "conditions": {
          "description": "Conditions holds the conditions for the Redpanda schema.",
          "type": "array",
          "items": {
            "description": "Condition contains details for one aspect of the current state of this API Resource.",
            "type": "object",
            "required": [
              "lastTransitionTime",
              "message",
              "reason",
              "status",
              "type"
            ],
            "properties": {
              "lastTransitionTime": {
                "description": "lastTransitionTime is the last time the condition transitioned from one status to another.\nThis should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.",
                "type": "string",
                "format": "date-time"
              },
              "message": {
                "description": "message is a human readable message indicating details about the transition.\nThis may be an empty string.",
                "type": "string",
                "maxLength": 32768
              },
              "observedGeneration": {
                "description": "observedGeneration represents the .metadata.generation that the condition was set based upon.\nFor instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date\nwith respect to the current state of the instance.",
                "type": "integer",
                "format": "int64",
                "minimum": 0
              },
              "reason": {
                "description": "reason contains a programmatic identifier indicating the reason for the condition's last transition.\nProducers of specific condition types may define expected values and meanings for this field,\nand whether the values are considered a guaranteed API.\nThe value should be a CamelCase string.\nThis field may not be empty.",
                "type": "string",
                "maxLength": 1024,
                "minLength": 1,
                "pattern": "^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$"
              },
              "status": {
                "description": "status of the condition, one of True, False, Unknown.",
                "type": "string",
                "enum": [
                  "True",
                  "False",
                  "Unknown"
                ]
              },
              "type": {
                "description": "type of condition in CamelCase or in foo.example.com/CamelCase.",
                "type": "string",
                "maxLength": 316,
                "pattern": "^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$"
              }
            },
            "additionalProperties": false
          }
        },
        "observedGeneration": {
          "description": "Specifies the last observed generation.",
          "type": "integer",
          "format": "int64"
        },
        "schemaHash": {
          "description": "SchemaHash is the hashed value of the schema synced to the cluster",
          "type": "string"
        },
        "versions": {
          "description": "Versions shows the versions of a given schema",
          "type": "array",
          "items": {
            "type": "integer"
          }
        }
      },
      "additionalProperties": false
    }
  }
}
