{
  "type": "object",
  "required": [
    "spec"
  ],
  "properties": {
    "apiVersion": {
      "type": "string"
    },
    "kind": {
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "type": "object",
      "required": [
        "name",
        "organization",
        "token"
      ],
      "properties": {
        "agentPool": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "pattern": "^apool-[a-zA-Z0-9]+$"
            },
            "name": {
              "type": "string",
              "minLength": 1
            }
          },
          "additionalProperties": false
        },
        "allowDestroyPlan": {
          "type": "boolean",
          "default": true
        },
        "applyMethod": {
          "type": "string",
          "default": "manual",
          "pattern": "^(auto|manual)$"
        },
        "applyRunTrigger": {
          "type": "string",
          "default": "manual",
          "pattern": "^(auto|manual)$"
        },
        "deletionPolicy": {
          "type": "string",
          "default": "retain",
          "enum": [
            "retain",
            "soft",
            "destroy",
            "force"
          ]
        },
        "description": {
          "type": "string",
          "minLength": 1
        },
        "environmentVariables": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": [
              "name"
            ],
            "properties": {
              "description": {
                "type": "string",
                "minLength": 1
              },
              "hcl": {
                "type": "boolean",
                "default": false
              },
              "name": {
                "type": "string",
                "minLength": 1
              },
              "sensitive": {
                "type": "boolean",
                "default": false
              },
              "value": {
                "type": "string",
                "minLength": 1
              },
              "valueFrom": {
                "type": "object",
                "properties": {
                  "configMapKeyRef": {
                    "type": "object",
                    "required": [
                      "key"
                    ],
                    "properties": {
                      "key": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string",
                        "default": ""
                      },
                      "optional": {
                        "type": "boolean"
                      }
                    },
                    "additionalProperties": false,
                    "x-kubernetes-map-type": "atomic"
                  },
                  "secretKeyRef": {
                    "type": "object",
                    "required": [
                      "key"
                    ],
                    "properties": {
                      "key": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string",
                        "default": ""
                      },
                      "optional": {
                        "type": "boolean"
                      }
                    },
                    "additionalProperties": false,
                    "x-kubernetes-map-type": "atomic"
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          }
        },
        "executionMode": {
          "type": "string",
          "default": "remote",
          "pattern": "^(agent|local|remote)$"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "notifications": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": [
              "name",
              "type"
            ],
            "properties": {
              "emailAddresses": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "string"
                }
              },
              "emailUsers": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "string"
                }
              },
              "enabled": {
                "type": "boolean",
                "default": true
              },
              "name": {
                "type": "string",
                "minLength": 1
              },
              "token": {
                "type": "string",
                "minLength": 1
              },
              "triggers": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "string",
                  "enum": [
                    "run:applying",
                    "assessment:check_failure",
                    "run:completed",
                    "run:created",
                    "assessment:drifted",
                    "run:errored",
                    "assessment:failed",
                    "run:needs_attention",
                    "run:planning"
                  ]
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "email",
                  "generic",
                  "microsoft-teams",
                  "slack"
                ]
              },
              "url": {
                "type": "string",
                "pattern": "^https?://.*"
              }
            },
            "additionalProperties": false
          }
        },
        "organization": {
          "type": "string",
          "minLength": 1
        },
        "project": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "pattern": "^prj-[a-zA-Z0-9]+$"
            },
            "name": {
              "type": "string",
              "minLength": 1
            }
          },
          "additionalProperties": false
        },
        "remoteStateSharing": {
          "type": "object",
          "properties": {
            "allWorkspaces": {
              "type": "boolean",
              "default": false
            },
            "workspaces": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string",
                    "pattern": "^ws-[a-zA-Z0-9]+$"
                  },
                  "name": {
                    "type": "string",
                    "minLength": 1
                  }
                },
                "additionalProperties": false
              }
            }
          },
          "additionalProperties": false
        },
        "runTasks": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "properties": {
              "enforcementLevel": {
                "type": "string",
                "default": "advisory",
                "pattern": "^(advisory|mandatory)$"
              },
              "id": {
                "type": "string",
                "pattern": "^task-[a-zA-Z0-9]+$"
              },
              "name": {
                "type": "string",
                "minLength": 1
              },
              "stage": {
                "type": "string",
                "default": "post_plan",
                "pattern": "^(pre_apply|pre_plan|post_plan)$"
              }
            },
            "additionalProperties": false
          }
        },
        "runTriggers": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "pattern": "^ws-[a-zA-Z0-9]+$"
              },
              "name": {
                "type": "string",
                "minLength": 1
              }
            },
            "additionalProperties": false
          }
        },
        "sshKey": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "pattern": "^sshkey-[a-zA-Z0-9]+$"
            },
            "name": {
              "type": "string",
              "minLength": 1
            }
          },
          "additionalProperties": false
        },
        "tags": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "string",
            "pattern": "^[A-Za-z0-9][A-Za-z0-9:_-]*$"
          }
        },
        "teamAccess": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": [
              "access",
              "team"
            ],
            "properties": {
              "access": {
                "type": "string",
                "pattern": "^(admin|custom|plan|read|write)$"
              },
              "custom": {
                "type": "object",
                "properties": {
                  "runTasks": {
                    "type": "boolean"
                  },
                  "runs": {
                    "type": "string",
                    "default": "read",
                    "pattern": "^(apply|plan|read)$"
                  },
                  "sentinel": {
                    "type": "string",
                    "default": "none",
                    "pattern": "^(none|read)$"
                  },
                  "stateVersions": {
                    "type": "string",
                    "default": "none",
                    "pattern": "^(none|read|read-outputs|write)$"
                  },
                  "variables": {
                    "type": "string",
                    "default": "none",
                    "pattern": "^(none|read|write)$"
                  },
                  "workspaceLocking": {
                    "type": "boolean",
                    "default": false
                  }
                },
                "additionalProperties": false
              },
              "team": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string",
                    "pattern": "^team-[a-zA-Z0-9]+$"
                  },
                  "name": {
                    "type": "string",
                    "minLength": 1
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          }
        },
        "terraformVariables": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": [
              "name"
            ],
            "properties": {
              "description": {
                "type": "string",
                "minLength": 1
              },
              "hcl": {
                "type": "boolean",
                "default": false
              },
              "name": {
                "type": "string",
                "minLength": 1
              },
              "sensitive": {
                "type": "boolean",
                "default": false
              },
              "value": {
                "type": "string",
                "minLength": 1
              },
              "valueFrom": {
                "type": "object",
                "properties": {
                  "configMapKeyRef": {
                    "type": "object",
                    "required": [
                      "key"
                    ],
                    "properties": {
                      "key": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string",
                        "default": ""
                      },
                      "optional": {
                        "type": "boolean"
                      }
                    },
                    "additionalProperties": false,
                    "x-kubernetes-map-type": "atomic"
                  },
                  "secretKeyRef": {
                    "type": "object",
                    "required": [
                      "key"
                    ],
                    "properties": {
                      "key": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string",
                        "default": ""
                      },
                      "optional": {
                        "type": "boolean"
                      }
                    },
                    "additionalProperties": false,
                    "x-kubernetes-map-type": "atomic"
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          }
        },
        "terraformVersion": {
          "type": "string",
          "pattern": "^\\d{1}\\.\\d{1,2}\\.\\d{1,2}$"
        },
        "token": {
          "type": "object",
          "required": [
            "secretKeyRef"
          ],
          "properties": {
            "secretKeyRef": {
              "type": "object",
              "required": [
                "key"
              ],
              "properties": {
                "key": {
                  "type": "string"
                },
                "name": {
                  "type": "string",
                  "default": ""
                },
                "optional": {
                  "type": "boolean"
                }
              },
              "additionalProperties": false,
              "x-kubernetes-map-type": "atomic"
            }
          },
          "additionalProperties": false
        },
        "variableSets": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "pattern": "varset-[a-zA-Z0-9]+$"
              },
              "name": {
                "type": "string",
                "minLength": 1
              }
            },
            "additionalProperties": false
          }
        },
        "versionControl": {
          "type": "object",
          "properties": {
            "branch": {
              "type": "string",
              "minLength": 1
            },
            "enableFileTriggers": {
              "type": "boolean",
              "default": false
            },
            "oAuthTokenID": {
              "type": "string",
              "pattern": "^ot-[a-zA-Z0-9]+$"
            },
            "repository": {
              "type": "string",
              "minLength": 1
            },
            "speculativePlans": {
              "type": "boolean",
              "default": true
            },
            "triggerPatterns": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "string"
              }
            },
            "triggerPrefixes": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": false
        },
        "workingDirectory": {
          "type": "string",
          "minLength": 1
        }
      },
      "additionalProperties": false
    },
    "status": {
      "type": "object",
      "required": [
        "workspaceID"
      ],
      "properties": {
        "defaultProjectID": {
          "type": "string"
        },
        "destroyRunID": {
          "type": "string"
        },
        "observedGeneration": {
          "type": "integer",
          "format": "int64"
        },
        "plan": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "status": {
              "type": "string"
            },
            "terraformVersion": {
              "type": "string",
              "pattern": "^\\d{1}\\.\\d{1,2}\\.\\d{1,2}$"
            }
          },
          "additionalProperties": false
        },
        "runStatus": {
          "type": "object",
          "properties": {
            "configurationVersion": {
              "type": "string"
            },
            "id": {
              "type": "string"
            },
            "outputRunID": {
              "type": "string"
            },
            "status": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "sshKeyID": {
          "type": "string"
        },
        "terraformVersion": {
          "type": "string",
          "pattern": "^\\d{1}\\.\\d{1,2}\\.\\d{1,2}$"
        },
        "updateAt": {
          "type": "integer",
          "format": "int64"
        },
        "variableSet": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "name": {
                "type": "string"
              }
            },
            "additionalProperties": false
          }
        },
        "variables": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "category",
              "id",
              "name",
              "valueID",
              "versionID"
            ],
            "properties": {
              "category": {
                "type": "string"
              },
              "id": {
                "type": "string"
              },
              "name": {
                "type": "string"
              },
              "valueID": {
                "type": "string"
              },
              "versionID": {
                "type": "string"
              }
            },
            "additionalProperties": false
          }
        },
        "workspaceID": {
          "type": "string"
        }
      },
      "additionalProperties": false
    }
  }
}
