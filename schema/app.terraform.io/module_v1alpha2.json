{
  "description": "Module implements API-driven Run Workflows.\nMore information:\n  - https://developer.hashicorp.com/terraform/cloud-docs/run/api",
  "type": "object",
  "required": [
    "spec"
  ],
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object.\nServers should convert recognized schemas to the latest internal value, and\nmay reject unrecognized values.\nMore info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": "string"
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents.\nServers may infer this from the endpoint the client submits requests to.\nCannot be updated.\nIn CamelCase.\nMore info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "description": "ModuleSpec defines the desired state of Module.",
      "type": "object",
      "required": [
        "module",
        "organization",
        "token",
        "workspace"
      ],
      "properties": {
        "deletionPolicy": {
          "description": "Deletion Policy defines the strategies for resource deletion in the Kubernetes operator.\nIt controls how the operator should handle the deletion of resources when triggered by\na user action or system event.\n\nThere is one possible value:\n- `retain`: When the custom resource is deleted, the associated module is retained. `destroyOnDeletion` must be set to false.\n- `destroy`: Executes a destroy operation. Removes all resources and the module.\nDefault: `retain`.",
          "type": "string",
          "default": "retain",
          "enum": [
            "retain",
            "destroy"
          ]
        },
        "destroyOnDeletion": {
          "description": "DEPRECATED: Specify whether or not to execute a Destroy run when the object is deleted from the Kubernetes.\nDefault: `false`.",
          "type": "boolean",
          "default": false
        },
        "module": {
          "description": "Module source and version to execute.",
          "type": "object",
          "required": [
            "source"
          ],
          "properties": {
            "source": {
              "description": "Non local Terraform module source.\nMore information:\n  - https://developer.hashicorp.com/terraform/language/modules/sources",
              "type": "string",
              "minLength": 1
            },
            "version": {
              "description": "Terraform module version.",
              "type": "string",
              "minLength": 1
            }
          },
          "additionalProperties": false
        },
        "name": {
          "description": "Name of the module that will be uploaded and executed.\nDefault: `this`.",
          "type": "string",
          "default": "this",
          "minLength": 1
        },
        "organization": {
          "description": "Organization name where the Workspace will be created.\nMore information:\n  - https://developer.hashicorp.com/terraform/cloud-docs/users-teams-organizations/organizations",
          "type": "string",
          "minLength": 1
        },
        "outputs": {
          "description": "Module outputs to store in ConfigMap(non-sensitive) or Secret(sensitive).",
          "type": "array",
          "minItems": 1,
          "items": {
            "description": "Module outputs to store in ConfigMap(non-sensitive) or Secret(sensitive).",
            "type": "object",
            "required": [
              "name"
            ],
            "properties": {
              "name": {
                "description": "Output name must match with the module output.",
                "type": "string",
                "minLength": 1
              },
              "sensitive": {
                "description": "Specify whether or not the output is sensitive.\nDefault: `false`.",
                "type": "boolean",
                "default": false
              }
            },
            "additionalProperties": false
          }
        },
        "restartedAt": {
          "description": "Allows executing a new Run without changing any Workspace or Module attributes.\nExample: kubectl patch \u003cKIND\u003e \u003cNAME\u003e --type=merge --patch '{\"spec\": {\"restartedAt\": \"'\\`date -u -Iseconds\\`'\"}}'",
          "type": "string",
          "minLength": 1
        },
        "token": {
          "description": "API Token to be used for API calls.",
          "type": "object",
          "required": [
            "secretKeyRef"
          ],
          "properties": {
            "secretKeyRef": {
              "description": "Selects a key of a secret in the workspace's namespace",
              "type": "object",
              "required": [
                "key"
              ],
              "properties": {
                "key": {
                  "description": "The key of the secret to select from.  Must be a valid secret key.",
                  "type": "string"
                },
                "name": {
                  "description": "Name of the referent.\nThis field is effectively required, but due to backwards compatibility is\nallowed to be empty. Instances of this type with an empty value here are\nalmost certainly wrong.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
                  "type": "string",
                  "default": ""
                },
                "optional": {
                  "description": "Specify whether the Secret or its key must be defined",
                  "type": "boolean"
                }
              },
              "additionalProperties": false,
              "x-kubernetes-map-type": "atomic"
            }
          },
          "additionalProperties": false
        },
        "variables": {
          "description": "Variables to pass to the module, they must exist in the Workspace.",
          "type": "array",
          "minItems": 1,
          "items": {
            "description": "Variables to pass to the module.",
            "type": "object",
            "required": [
              "name"
            ],
            "properties": {
              "name": {
                "description": "Variable name must exist in the Workspace.",
                "type": "string",
                "minLength": 1
              }
            },
            "additionalProperties": false
          }
        },
        "workspace": {
          "description": "Workspace to execute the module.",
          "type": "object",
          "properties": {
            "id": {
              "description": "Module Workspace ID.\nMust match pattern: `^ws-[a-zA-Z0-9]+$`",
              "type": "string",
              "pattern": "^ws-[a-zA-Z0-9]+$"
            },
            "name": {
              "description": "Module Workspace Name.",
              "type": "string",
              "minLength": 1
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "status": {
      "description": "ModuleStatus defines the observed state of Module.",
      "type": "object",
      "required": [
        "observedGeneration",
        "workspaceID"
      ],
      "properties": {
        "configurationVersion": {
          "description": "A configuration version is a resource used to reference the uploaded configuration files.\nMore information:\n  - https://developer.hashicorp.com/terraform/cloud-docs/api-docs/configuration-versions\n  - https://developer.hashicorp.com/terraform/cloud-docs/run/api",
          "type": "object",
          "required": [
            "id",
            "status"
          ],
          "properties": {
            "id": {
              "description": "Configuration Version ID.",
              "type": "string"
            },
            "status": {
              "description": "Configuration Version Status.",
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "destroyRunID": {
          "description": "Workspace Destroy Run ID.",
          "type": "string"
        },
        "observedGeneration": {
          "description": "Real world state generation.",
          "type": "integer",
          "format": "int64"
        },
        "output": {
          "description": "Module Outputs status.",
          "type": "object",
          "required": [
            "runID"
          ],
          "properties": {
            "runID": {
              "description": "Run ID of the latest run that updated the outputs.",
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "run": {
          "description": "Workspace Runs status.\nMore information:\n  - https://developer.hashicorp.com/terraform/cloud-docs/run/states",
          "type": "object",
          "properties": {
            "configurationVersion": {
              "description": "The configuration version of this run.",
              "type": "string"
            },
            "id": {
              "description": "Current(both active and finished) HCP Terraform run ID.",
              "type": "string"
            },
            "outputRunID": {
              "description": "Run ID of the latest run that could update the outputs.",
              "type": "string"
            },
            "status": {
              "description": "Current(both active and finished) HCP Terraform run status.",
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "workspaceID": {
          "description": "Workspace ID where the module is running.",
          "type": "string"
        }
      },
      "additionalProperties": false
    }
  }
}
