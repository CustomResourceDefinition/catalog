{
  "description": "Workflow describes a set of actions to be run on a specific Hardware. Workflows execute once and should be considered ephemeral.",
  "type": "object",
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": "string"
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "type": "object",
      "properties": {
        "hardwareRef": {
          "description": "HardwareRef is a reference to a Hardware resource this workflow will execute on. If no namespace is specified the Workflow's namespace is assumed.",
          "type": "object",
          "properties": {
            "name": {
              "description": "Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names TODO: Add other useful fields. apiVersion, kind, uid?",
              "type": "string"
            }
          },
          "additionalProperties": false,
          "x-kubernetes-map-type": "atomic"
        },
        "templateParams": {
          "description": "TemplateParams are a list of key-value pairs that are injected into templates at render time. TemplateParams are exposed to templates using a top level .Params key. \n For example, TemplateParams = {\"foo\": \"bar\"}, the foo key can be accessed via .Params.foo.",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        },
        "templateRef": {
          "description": "TemplateRef is a reference to a Template resource used to render workflow actions. If no namespace is specified the Workflow's namespace is assumed.",
          "type": "object",
          "properties": {
            "name": {
              "description": "Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names TODO: Add other useful fields. apiVersion, kind, uid?",
              "type": "string"
            }
          },
          "additionalProperties": false,
          "x-kubernetes-map-type": "atomic"
        },
        "timeout": {
          "description": "TimeoutSeconds defines the time the workflow has to complete. The timer begins when the first action is requested. When set to 0, no timeout is applied.",
          "type": "integer",
          "format": "int64",
          "default": 0,
          "minimum": 0
        }
      },
      "additionalProperties": false
    },
    "status": {
      "type": "object",
      "required": [
        "actions",
        "conditions"
      ],
      "properties": {
        "actions": {
          "description": "Actions is a list of action states.",
          "type": "array",
          "items": {
            "description": "ActionStatus describes status information about an action.",
            "type": "object",
            "required": [
              "id"
            ],
            "properties": {
              "failureMessage": {
                "description": "FailureMessage is a free-form user friendly message describing why the Action entered the ActionStateFailed state. Typically, this is an elaboration on the Reason.",
                "type": "string"
              },
              "failureReason": {
                "description": "FailureReason is a short CamelCase word or phrase describing why the Action entered ActionStateFailed.",
                "type": "string"
              },
              "id": {
                "description": "ID uniquely identifies the action status.",
                "type": "string"
              },
              "lastTransitioned": {
                "description": "LastTransition is the observed time when State transitioned last.",
                "type": "string",
                "format": "date-time"
              },
              "rendered": {
                "description": "Rendered is the rendered action.",
                "type": "object",
                "required": [
                  "image",
                  "name"
                ],
                "properties": {
                  "args": {
                    "description": "Args are a set of arguments to be passed to the command executed by the container on launch.",
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "cmd": {
                    "description": "Cmd defines the command to use when launching the image. It overrides the default command of the action. It must be a unix path to an executable program.",
                    "type": "string",
                    "pattern": "^(/[^/ ]*)+/?$"
                  },
                  "env": {
                    "description": "Env defines environment variables used when launching the container.",
                    "type": "object",
                    "additionalProperties": {
                      "type": "string"
                    }
                  },
                  "image": {
                    "description": "Image is an OCI image.",
                    "type": "string"
                  },
                  "name": {
                    "description": "Name is a name for the action.",
                    "type": "string"
                  },
                  "namespaces": {
                    "description": "Namespace defines the Linux namespaces this container should execute in.",
                    "type": "object",
                    "properties": {
                      "network": {
                        "description": "Network defines the network namespace.",
                        "type": "string"
                      },
                      "pid": {
                        "description": "PID defines the PID namespace",
                        "type": "integer"
                      }
                    },
                    "additionalProperties": false
                  },
                  "volumes": {
                    "description": "Volumes defines the volumes to mount into the container.",
                    "type": "array",
                    "items": {
                      "description": "Volume is a specification for mounting a volume in an action. Volumes take the form {SRC-VOLUME-NAME | SRC-HOST-DIR}:TGT-CONTAINER-DIR:OPTIONS. When specifying a VOLUME-NAME that does not exist it will be created for you. Examples: \n Read-only bind mount bound to /data \n /etc/data:/data:ro \n Writable volume name bound to /data \n shared_volume:/data \n See https://docs.docker.com/storage/volumes/ for additional details.",
                      "type": "string"
                    }
                  }
                },
                "additionalProperties": false
              },
              "startedAt": {
                "description": "StartedAt is the time the action was started as reported by the client. Nil indicates the Action has not started.",
                "type": "string",
                "format": "date-time"
              },
              "state": {
                "description": "State describes the current state of the action.",
                "type": "string"
              }
            },
            "additionalProperties": false
          }
        },
        "conditions": {
          "description": "Conditions details a set of observations about the Workflow.",
          "type": "array",
          "items": {
            "description": "Condition defines an observation on a resource that is generally attainable by inspecting other status fields.",
            "type": "object",
            "required": [
              "lastTransitionTime",
              "status",
              "type"
            ],
            "properties": {
              "lastTransitionTime": {
                "description": "LastTransition is the last time the condition transitioned from one status to another.",
                "type": "string",
                "format": "date-time"
              },
              "message": {
                "description": "Message is a human readable message indicating details about the last transition.",
                "type": "string"
              },
              "reason": {
                "description": "Reason is a short CamelCase description for the conditions last transition.",
                "type": "string"
              },
              "status": {
                "description": "Status of the condition.",
                "type": "string"
              },
              "type": {
                "description": "Type of condition.",
                "type": "string"
              }
            },
            "additionalProperties": false
          }
        },
        "lastTransitioned": {
          "description": "LastTransition is the observed time when State transitioned last.",
          "type": "string",
          "format": "date-time"
        },
        "startedAt": {
          "description": "StartedAt is the time the first action was requested. Nil indicates the Workflow has not started.",
          "type": "string",
          "format": "date-time"
        },
        "state": {
          "description": "State describes the current state of the workflow. For the workflow to enter the WorkflowStateSucceeded state all actions must be in ActionStateSucceeded. The Workflow will enter a WorkflowStateFailed if 1 or more Actions fails.",
          "type": "string"
        }
      },
      "additionalProperties": false
    }
  }
}
