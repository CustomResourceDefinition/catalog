{
  "description": "TestWorkflowExecution is the Schema for the workflows API",
  "type": "object",
  "required": [
    "spec"
  ],
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object.\nServers should convert recognized schemas to the latest internal value, and\nmay reject unrecognized values.\nMore info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": "string"
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents.\nServers may infer this from the endpoint the client submits requests to.\nCannot be updated.\nIn CamelCase.\nMore info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "description": "TestWorkflowExecution specification",
      "type": "object",
      "required": [
        "testWorkflow"
      ],
      "properties": {
        "executionRequest": {
          "description": "TestWorkflowExecutionRequest contains TestWorkflow execution parameters",
          "type": "object",
          "properties": {
            "config": {
              "type": "object",
              "additionalProperties": {
                "anyOf": [
                  {
                    "type": "integer"
                  },
                  {
                    "type": "string"
                  }
                ],
                "x-kubernetes-int-or-string": true
              }
            },
            "disableWebhooks": {
              "description": "whether webhooks should be disabled for this execution",
              "type": "boolean"
            },
            "name": {
              "description": "custom execution name",
              "type": "string"
            },
            "runningContext": {
              "description": "running context for the test workflow execution (Pro edition only)",
              "type": "object",
              "required": [
                "actor",
                "interface"
              ],
              "properties": {
                "actor": {
                  "description": "running context actor for test workflow execution",
                  "type": "object",
                  "required": [
                    "type"
                  ],
                  "properties": {
                    "email": {
                      "description": "actor email",
                      "type": "string"
                    },
                    "executionId": {
                      "description": "test workflow execution id",
                      "type": "string"
                    },
                    "executionPath": {
                      "description": "all test workflow execution ids starting from the root",
                      "type": "string"
                    },
                    "executionReference": {
                      "description": "reference test workflow execution id",
                      "type": "string"
                    },
                    "name": {
                      "description": "actor name",
                      "type": "string"
                    },
                    "type": {
                      "description": "supported actors for test workflow running context",
                      "type": "string",
                      "enum": [
                        "cron",
                        "testtrigger",
                        "user",
                        "testworkflow",
                        "testworkflowexecution",
                        "program"
                      ]
                    }
                  },
                  "additionalProperties": false
                },
                "interface": {
                  "description": "running context interface for test workflow execution",
                  "type": "object",
                  "required": [
                    "type"
                  ],
                  "properties": {
                    "name": {
                      "description": "interface name",
                      "type": "string"
                    },
                    "type": {
                      "description": "supported interfaces for test workflow running context",
                      "type": "string",
                      "enum": [
                        "cli",
                        "ui",
                        "api",
                        "ci/cd",
                        "internal"
                      ]
                    }
                  },
                  "additionalProperties": false
                }
              },
              "additionalProperties": false
            },
            "tags": {
              "description": "test workflow execution tags",
              "type": "object",
              "additionalProperties": {
                "type": "string"
              }
            },
            "target": {
              "description": "Targets helps decide on which runner the execution is scheduled.",
              "type": "object",
              "properties": {
                "match": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                },
                "not": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                },
                "replicate": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              },
              "additionalProperties": false
            },
            "testWorkflowExecutionName": {
              "description": "test workflow execution name started the test workflow execution",
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "testWorkflow": {
          "description": "LocalObjectReference contains enough information to let you locate the\nreferenced object inside the same namespace.",
          "type": "object",
          "properties": {
            "name": {
              "description": "Name of the referent.\nThis field is effectively required, but due to backwards compatibility is\nallowed to be empty. Instances of this type with an empty value here are\nalmost certainly wrong.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names",
              "type": "string",
              "default": ""
            }
          },
          "additionalProperties": false,
          "x-kubernetes-map-type": "atomic"
        }
      },
      "additionalProperties": false
    },
    "status": {
      "description": "TestWorkflowExecutionStatus specification",
      "type": "object",
      "properties": {
        "generation": {
          "description": "test workflow execution generation",
          "type": "integer",
          "format": "int64"
        },
        "latestExecution": {
          "description": "INSERT ADDITIONAL STATUS FIELD - define observed state of cluster\nImportant: Run \"make\" to regenerate code after modifying this file",
          "type": "object",
          "required": [
            "id",
            "name",
            "workflow"
          ],
          "properties": {
            "disableWebhooks": {
              "description": "whether webhooks should be disabled for this execution",
              "type": "boolean"
            },
            "id": {
              "description": "unique execution identifier",
              "type": "string"
            },
            "name": {
              "description": "execution name",
              "type": "string"
            },
            "namespace": {
              "description": "execution namespace",
              "type": "string"
            },
            "number": {
              "description": "sequence number for the execution",
              "type": "integer",
              "format": "int32"
            },
            "output": {
              "description": "additional information from the steps, like referenced executed tests or artifacts",
              "type": "array",
              "items": {
                "description": "TestWorkflowOutput defines output of TestWorkflow",
                "type": "object",
                "properties": {
                  "name": {
                    "description": "output kind name",
                    "type": "string"
                  },
                  "ref": {
                    "description": "step reference",
                    "type": "string"
                  },
                  "value": {
                    "description": "value returned",
                    "type": "object",
                    "x-kubernetes-preserve-unknown-fields": true
                  }
                },
                "additionalProperties": false
              }
            },
            "reports": {
              "description": "generated reports from the steps, like junit",
              "type": "array",
              "items": {
                "description": "TestWorkflowReport contains report of TestWorkflow",
                "type": "object",
                "properties": {
                  "file": {
                    "description": "file path to full report in artifact storage",
                    "type": "string"
                  },
                  "kind": {
                    "description": "report kind/type",
                    "type": "string"
                  },
                  "ref": {
                    "description": "step reference",
                    "type": "string"
                  },
                  "summary": {
                    "description": "TestWorkflowReportSummary contains report summary of TestWorkflow",
                    "type": "object",
                    "properties": {
                      "duration": {
                        "description": "total duration of all test cases in milliseconds",
                        "type": "integer",
                        "format": "int64"
                      },
                      "errored": {
                        "description": "number of error test cases",
                        "type": "integer",
                        "format": "int32"
                      },
                      "failed": {
                        "description": "number of failed test cases",
                        "type": "integer",
                        "format": "int32"
                      },
                      "passed": {
                        "description": "number of passed test cases",
                        "type": "integer",
                        "format": "int32"
                      },
                      "skipped": {
                        "description": "number of skipped test cases",
                        "type": "integer",
                        "format": "int32"
                      },
                      "tests": {
                        "description": "total number of test cases",
                        "type": "integer",
                        "format": "int32"
                      }
                    },
                    "additionalProperties": false
                  }
                },
                "additionalProperties": false
              }
            },
            "resolvedWorkflow": {
              "x-kubernetes-preserve-unknown-fields": true
            },
            "resourceAggregations": {
              "description": "resource metrics aggregations (min, max, avg, stddev)",
              "type": "object",
              "properties": {
                "global": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "object",
                    "additionalProperties": {
                      "description": "TestWorkflowExecutionResourceAggregations contains resource metrics aggregations",
                      "type": "object",
                      "properties": {
                        "avg": {
                          "type": "number"
                        },
                        "max": {
                          "type": "number"
                        },
                        "min": {
                          "type": "number"
                        },
                        "stddev": {
                          "type": "number"
                        },
                        "total": {
                          "type": "number"
                        }
                      }
                    }
                  }
                },
                "step": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "aggregations": {
                        "description": "resource metrics aggregations grouped by measurement and field",
                        "type": "object",
                        "additionalProperties": {
                          "type": "object",
                          "additionalProperties": {
                            "description": "TestWorkflowExecutionResourceAggregations contains resource metrics aggregations",
                            "type": "object",
                            "properties": {
                              "avg": {
                                "type": "number"
                              },
                              "max": {
                                "type": "number"
                              },
                              "min": {
                                "type": "number"
                              },
                              "stddev": {
                                "type": "number"
                              },
                              "total": {
                                "type": "number"
                              }
                            }
                          }
                        }
                      },
                      "ref": {
                        "description": "step reference",
                        "type": "string"
                      }
                    },
                    "additionalProperties": false
                  }
                }
              },
              "additionalProperties": false
            },
            "result": {
              "description": "TestWorkflowResult contains result of TestWorkflow",
              "type": "object",
              "required": [
                "predictedStatus",
                "status"
              ],
              "properties": {
                "duration": {
                  "description": "Go-formatted (human-readable) duration",
                  "type": "string"
                },
                "durationMs": {
                  "description": "Duration in milliseconds",
                  "type": "integer",
                  "format": "int32"
                },
                "finishedAt": {
                  "description": "when the pod has been completed",
                  "type": "string",
                  "format": "date-time"
                },
                "initialization": {
                  "description": "TestWorkflowStepResult contains step result of TestWorkflow",
                  "type": "object",
                  "properties": {
                    "errorMessage": {
                      "type": "string"
                    },
                    "exitCode": {
                      "type": "integer",
                      "format": "int64"
                    },
                    "finishedAt": {
                      "description": "when the container was finished",
                      "type": "string",
                      "format": "date-time"
                    },
                    "queuedAt": {
                      "description": "when the container was created",
                      "type": "string",
                      "format": "date-time"
                    },
                    "startedAt": {
                      "description": "when the container was started",
                      "type": "string",
                      "format": "date-time"
                    },
                    "status": {
                      "description": "TestWorkfloStepwStatus has step status of TestWorkflow",
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                },
                "pausedMs": {
                  "description": "Pause duration in milliseconds",
                  "type": "integer",
                  "format": "int32"
                },
                "pauses": {
                  "type": "array",
                  "items": {
                    "description": "TestWorkflowPause defines pause of TestWorkflow",
                    "type": "object",
                    "required": [
                      "pausedAt",
                      "ref"
                    ],
                    "properties": {
                      "pausedAt": {
                        "description": "when the pause has started",
                        "type": "string",
                        "format": "date-time"
                      },
                      "ref": {
                        "description": "step at which it was paused",
                        "type": "string"
                      },
                      "resumedAt": {
                        "description": "when the pause has ended",
                        "type": "string",
                        "format": "date-time"
                      }
                    },
                    "additionalProperties": false
                  }
                },
                "predictedStatus": {
                  "description": "TestWorkflowStatus has status of TestWorkflow",
                  "type": "string",
                  "enum": [
                    "queued",
                    "running",
                    "paused",
                    "passed",
                    "failed",
                    "aborted"
                  ]
                },
                "queuedAt": {
                  "description": "when the pod was created",
                  "type": "string",
                  "format": "date-time"
                },
                "startedAt": {
                  "description": "when the pod has been successfully assigned",
                  "type": "string",
                  "format": "date-time"
                },
                "status": {
                  "description": "TestWorkflowStatus has status of TestWorkflow",
                  "type": "string",
                  "enum": [
                    "queued",
                    "running",
                    "paused",
                    "passed",
                    "failed",
                    "aborted"
                  ]
                },
                "steps": {
                  "type": "object",
                  "additionalProperties": {
                    "description": "TestWorkflowStepResult contains step result of TestWorkflow",
                    "type": "object",
                    "properties": {
                      "errorMessage": {
                        "type": "string"
                      },
                      "exitCode": {
                        "type": "integer",
                        "format": "int64"
                      },
                      "finishedAt": {
                        "description": "when the container was finished",
                        "type": "string",
                        "format": "date-time"
                      },
                      "queuedAt": {
                        "description": "when the container was created",
                        "type": "string",
                        "format": "date-time"
                      },
                      "startedAt": {
                        "description": "when the container was started",
                        "type": "string",
                        "format": "date-time"
                      },
                      "status": {
                        "description": "TestWorkfloStepwStatus has step status of TestWorkflow",
                        "type": "string"
                      }
                    }
                  }
                },
                "totalDuration": {
                  "description": "Go-formatted (human-readable) total duration (incl. pause)",
                  "type": "string"
                },
                "totalDurationMs": {
                  "description": "Total duration in milliseconds (incl. pause)",
                  "type": "integer",
                  "format": "int32"
                }
              },
              "additionalProperties": false
            },
            "runningContext": {
              "description": "running context for the test workflow execution (Pro edition only)",
              "type": "object",
              "required": [
                "actor",
                "interface"
              ],
              "properties": {
                "actor": {
                  "description": "running context actor for test workflow execution",
                  "type": "object",
                  "required": [
                    "type"
                  ],
                  "properties": {
                    "email": {
                      "description": "actor email",
                      "type": "string"
                    },
                    "executionId": {
                      "description": "test workflow execution id",
                      "type": "string"
                    },
                    "executionPath": {
                      "description": "all test workflow execution ids starting from the root",
                      "type": "string"
                    },
                    "executionReference": {
                      "description": "reference test workflow execution id",
                      "type": "string"
                    },
                    "name": {
                      "description": "actor name",
                      "type": "string"
                    },
                    "type": {
                      "description": "supported actors for test workflow running context",
                      "type": "string",
                      "enum": [
                        "cron",
                        "testtrigger",
                        "user",
                        "testworkflow",
                        "testworkflowexecution",
                        "program"
                      ]
                    }
                  },
                  "additionalProperties": false
                },
                "interface": {
                  "description": "running context interface for test workflow execution",
                  "type": "object",
                  "required": [
                    "type"
                  ],
                  "properties": {
                    "name": {
                      "description": "interface name",
                      "type": "string"
                    },
                    "type": {
                      "description": "supported interfaces for test workflow running context",
                      "type": "string",
                      "enum": [
                        "cli",
                        "ui",
                        "api",
                        "ci/cd",
                        "internal"
                      ]
                    }
                  },
                  "additionalProperties": false
                }
              },
              "additionalProperties": false
            },
            "scheduledAt": {
              "description": "when the execution has been scheduled to run",
              "type": "string",
              "format": "date-time"
            },
            "signature": {
              "description": "structured tree of steps",
              "type": "array",
              "items": {
                "description": "TestWorkflowSignature has signature of TestWorkflow",
                "type": "object",
                "properties": {
                  "category": {
                    "description": "step category, that may be used as name fallback",
                    "type": "string"
                  },
                  "children": {
                    "x-kubernetes-preserve-unknown-fields": true
                  },
                  "name": {
                    "description": "step name",
                    "type": "string"
                  },
                  "negative": {
                    "description": "is the step/group meant to be negative",
                    "type": "boolean"
                  },
                  "optional": {
                    "description": "is the step/group meant to be optional",
                    "type": "boolean"
                  },
                  "ref": {
                    "description": "step reference",
                    "type": "string"
                  }
                },
                "additionalProperties": false
              }
            },
            "statusAt": {
              "description": "when the execution result's status has changed last time (queued, passed, failed)",
              "type": "string",
              "format": "date-time"
            },
            "tags": {
              "description": "test workflow execution tags",
              "type": "object",
              "additionalProperties": {
                "type": "string"
              }
            },
            "testWorkflowExecutionName": {
              "description": "test workflow execution name started the test workflow execution",
              "type": "string"
            },
            "workflow": {
              "x-kubernetes-preserve-unknown-fields": true
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  }
}
