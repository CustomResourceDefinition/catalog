{
  "type": "object",
  "properties": {
    "apiVersion": {
      "type": "string"
    },
    "kind": {
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "type": "object",
      "required": [
        "selector"
      ],
      "properties": {
        "allowed": {
          "type": "object",
          "properties": {
            "commonName": {
              "type": "object",
              "properties": {
                "required": {
                  "type": "boolean"
                },
                "validations": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": [
                      "rule"
                    ],
                    "properties": {
                      "message": {
                        "type": "string"
                      },
                      "rule": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false
                  },
                  "x-kubernetes-list-map-keys": [
                    "rule"
                  ],
                  "x-kubernetes-list-type": "map"
                },
                "value": {
                  "type": "string"
                }
              },
              "additionalProperties": false
            },
            "dnsNames": {
              "type": "object",
              "properties": {
                "required": {
                  "type": "boolean"
                },
                "validations": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": [
                      "rule"
                    ],
                    "properties": {
                      "message": {
                        "type": "string"
                      },
                      "rule": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false
                  },
                  "x-kubernetes-list-map-keys": [
                    "rule"
                  ],
                  "x-kubernetes-list-type": "map"
                },
                "values": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              },
              "additionalProperties": false
            },
            "emailAddresses": {
              "type": "object",
              "properties": {
                "required": {
                  "type": "boolean"
                },
                "validations": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": [
                      "rule"
                    ],
                    "properties": {
                      "message": {
                        "type": "string"
                      },
                      "rule": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false
                  },
                  "x-kubernetes-list-map-keys": [
                    "rule"
                  ],
                  "x-kubernetes-list-type": "map"
                },
                "values": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              },
              "additionalProperties": false
            },
            "ipAddresses": {
              "type": "object",
              "properties": {
                "required": {
                  "type": "boolean"
                },
                "validations": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": [
                      "rule"
                    ],
                    "properties": {
                      "message": {
                        "type": "string"
                      },
                      "rule": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false
                  },
                  "x-kubernetes-list-map-keys": [
                    "rule"
                  ],
                  "x-kubernetes-list-type": "map"
                },
                "values": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              },
              "additionalProperties": false
            },
            "isCA": {
              "type": "boolean"
            },
            "subject": {
              "type": "object",
              "properties": {
                "countries": {
                  "type": "object",
                  "properties": {
                    "required": {
                      "type": "boolean"
                    },
                    "validations": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "rule"
                        ],
                        "properties": {
                          "message": {
                            "type": "string"
                          },
                          "rule": {
                            "type": "string"
                          }
                        },
                        "additionalProperties": false
                      },
                      "x-kubernetes-list-map-keys": [
                        "rule"
                      ],
                      "x-kubernetes-list-type": "map"
                    },
                    "values": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                },
                "localities": {
                  "type": "object",
                  "properties": {
                    "required": {
                      "type": "boolean"
                    },
                    "validations": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "rule"
                        ],
                        "properties": {
                          "message": {
                            "type": "string"
                          },
                          "rule": {
                            "type": "string"
                          }
                        },
                        "additionalProperties": false
                      },
                      "x-kubernetes-list-map-keys": [
                        "rule"
                      ],
                      "x-kubernetes-list-type": "map"
                    },
                    "values": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                },
                "organizationalUnits": {
                  "type": "object",
                  "properties": {
                    "required": {
                      "type": "boolean"
                    },
                    "validations": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "rule"
                        ],
                        "properties": {
                          "message": {
                            "type": "string"
                          },
                          "rule": {
                            "type": "string"
                          }
                        },
                        "additionalProperties": false
                      },
                      "x-kubernetes-list-map-keys": [
                        "rule"
                      ],
                      "x-kubernetes-list-type": "map"
                    },
                    "values": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                },
                "organizations": {
                  "type": "object",
                  "properties": {
                    "required": {
                      "type": "boolean"
                    },
                    "validations": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "rule"
                        ],
                        "properties": {
                          "message": {
                            "type": "string"
                          },
                          "rule": {
                            "type": "string"
                          }
                        },
                        "additionalProperties": false
                      },
                      "x-kubernetes-list-map-keys": [
                        "rule"
                      ],
                      "x-kubernetes-list-type": "map"
                    },
                    "values": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                },
                "postalCodes": {
                  "type": "object",
                  "properties": {
                    "required": {
                      "type": "boolean"
                    },
                    "validations": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "rule"
                        ],
                        "properties": {
                          "message": {
                            "type": "string"
                          },
                          "rule": {
                            "type": "string"
                          }
                        },
                        "additionalProperties": false
                      },
                      "x-kubernetes-list-map-keys": [
                        "rule"
                      ],
                      "x-kubernetes-list-type": "map"
                    },
                    "values": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                },
                "provinces": {
                  "type": "object",
                  "properties": {
                    "required": {
                      "type": "boolean"
                    },
                    "validations": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "rule"
                        ],
                        "properties": {
                          "message": {
                            "type": "string"
                          },
                          "rule": {
                            "type": "string"
                          }
                        },
                        "additionalProperties": false
                      },
                      "x-kubernetes-list-map-keys": [
                        "rule"
                      ],
                      "x-kubernetes-list-type": "map"
                    },
                    "values": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                },
                "serialNumber": {
                  "type": "object",
                  "properties": {
                    "required": {
                      "type": "boolean"
                    },
                    "validations": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "rule"
                        ],
                        "properties": {
                          "message": {
                            "type": "string"
                          },
                          "rule": {
                            "type": "string"
                          }
                        },
                        "additionalProperties": false
                      },
                      "x-kubernetes-list-map-keys": [
                        "rule"
                      ],
                      "x-kubernetes-list-type": "map"
                    },
                    "value": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                },
                "streetAddresses": {
                  "type": "object",
                  "properties": {
                    "required": {
                      "type": "boolean"
                    },
                    "validations": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "rule"
                        ],
                        "properties": {
                          "message": {
                            "type": "string"
                          },
                          "rule": {
                            "type": "string"
                          }
                        },
                        "additionalProperties": false
                      },
                      "x-kubernetes-list-map-keys": [
                        "rule"
                      ],
                      "x-kubernetes-list-type": "map"
                    },
                    "values": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                }
              },
              "additionalProperties": false
            },
            "uris": {
              "type": "object",
              "properties": {
                "required": {
                  "type": "boolean"
                },
                "validations": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": [
                      "rule"
                    ],
                    "properties": {
                      "message": {
                        "type": "string"
                      },
                      "rule": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false
                  },
                  "x-kubernetes-list-map-keys": [
                    "rule"
                  ],
                  "x-kubernetes-list-type": "map"
                },
                "values": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              },
              "additionalProperties": false
            },
            "usages": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "signing",
                  "digital signature",
                  "content commitment",
                  "key encipherment",
                  "key agreement",
                  "data encipherment",
                  "cert sign",
                  "crl sign",
                  "encipher only",
                  "decipher only",
                  "any",
                  "server auth",
                  "client auth",
                  "code signing",
                  "email protection",
                  "s/mime",
                  "ipsec end system",
                  "ipsec tunnel",
                  "ipsec user",
                  "timestamping",
                  "ocsp signing",
                  "microsoft sgc",
                  "netscape sgc"
                ]
              }
            }
          },
          "additionalProperties": false
        },
        "constraints": {
          "type": "object",
          "properties": {
            "maxDuration": {
              "type": "string"
            },
            "minDuration": {
              "type": "string"
            },
            "privateKey": {
              "type": "object",
              "properties": {
                "algorithm": {
                  "type": "string",
                  "enum": [
                    "RSA",
                    "ECDSA",
                    "Ed25519"
                  ]
                },
                "maxSize": {
                  "type": "integer"
                },
                "minSize": {
                  "type": "integer"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "plugins": {
          "type": "object",
          "additionalProperties": {
            "description": "CertificateRequestPolicyPluginData is configuration needed by the plugin\napprover to evaluate a CertificateRequest on this policy.",
            "type": "object",
            "properties": {
              "values": {
                "description": "Values define a set of well-known, to the plugin, key value pairs that\nare required for the plugin to successfully evaluate a request based on\nthis policy.",
                "type": "object",
                "additionalProperties": {
                  "type": "string"
                }
              }
            }
          }
        },
        "selector": {
          "type": "object",
          "properties": {
            "issuerRef": {
              "type": "object",
              "properties": {
                "group": {
                  "type": "string"
                },
                "kind": {
                  "type": "string"
                },
                "name": {
                  "type": "string"
                }
              },
              "additionalProperties": false
            },
            "namespace": {
              "type": "object",
              "properties": {
                "matchLabels": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "matchNames": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "status": {
      "type": "object",
      "properties": {
        "conditions": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "status",
              "type"
            ],
            "properties": {
              "lastTransitionTime": {
                "type": "string",
                "format": "date-time"
              },
              "message": {
                "type": "string"
              },
              "observedGeneration": {
                "type": "integer",
                "format": "int64"
              },
              "reason": {
                "type": "string"
              },
              "status": {
                "type": "string"
              },
              "type": {
                "type": "string"
              }
            },
            "additionalProperties": false
          },
          "x-kubernetes-list-map-keys": [
            "type"
          ],
          "x-kubernetes-list-type": "map"
        }
      },
      "additionalProperties": false
    }
  }
}
