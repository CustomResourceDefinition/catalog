{
  "type": "object",
  "properties": {
    "apiVersion": {
      "type": "string"
    },
    "kind": {
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "type": "object",
      "required": [
        "prefix",
        "service"
      ],
      "properties": {
        "add_linkerd_headers": {
          "type": "boolean"
        },
        "add_request_headers": {
          "type": "object",
          "additionalProperties": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "boolean"
              },
              {
                "type": "object"
              }
            ]
          }
        },
        "add_response_headers": {
          "type": "object",
          "additionalProperties": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "boolean"
              },
              {
                "type": "object"
              }
            ]
          }
        },
        "allow_upgrade": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "ambassador_id": {
          "items": {
            "type": "string"
          },
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array"
            }
          ]
        },
        "auth_context_extensions": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        },
        "auto_host_rewrite": {
          "type": "boolean"
        },
        "bypass_auth": {
          "type": "boolean"
        },
        "bypass_error_response_overrides": {
          "type": "boolean"
        },
        "case_sensitive": {
          "type": "boolean"
        },
        "circuit_breakers": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "max_connections": {
                "type": "integer"
              },
              "max_pending_requests": {
                "type": "integer"
              },
              "max_requests": {
                "type": "integer"
              },
              "max_retries": {
                "type": "integer"
              },
              "priority": {
                "type": "string",
                "enum": [
                  "default",
                  "high"
                ]
              }
            },
            "additionalProperties": false
          }
        },
        "cluster_idle_timeout_ms": {
          "type": "integer"
        },
        "cluster_max_connection_lifetime_ms": {
          "type": "integer"
        },
        "cluster_tag": {
          "type": "string"
        },
        "connect_timeout_ms": {
          "type": "integer"
        },
        "cors": {
          "type": "object",
          "properties": {
            "credentials": {
              "type": "boolean"
            },
            "exposed_headers": {
              "items": {
                "type": "string"
              },
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "array"
                }
              ]
            },
            "headers": {
              "items": {
                "type": "string"
              },
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "array"
                }
              ]
            },
            "max_age": {
              "type": "string"
            },
            "methods": {
              "items": {
                "type": "string"
              },
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "array"
                }
              ]
            },
            "origins": {
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "array"
                }
              ]
            }
          },
          "additionalProperties": false
        },
        "dns_type": {
          "type": "string"
        },
        "docs": {
          "type": "object",
          "properties": {
            "display_name": {
              "type": "string"
            },
            "ignored": {
              "type": "boolean"
            },
            "path": {
              "type": "string"
            },
            "timeout_ms": {
              "type": "integer"
            },
            "url": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "enable_ipv4": {
          "type": "boolean"
        },
        "enable_ipv6": {
          "type": "boolean"
        },
        "envoy_override": {
          "type": "object"
        },
        "error_response_overrides": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": [
              "body",
              "on_status_code"
            ],
            "properties": {
              "body": {
                "type": "object",
                "properties": {
                  "content_type": {
                    "type": "string"
                  },
                  "json_format": {
                    "type": "object",
                    "additionalProperties": {
                      "type": "string"
                    }
                  },
                  "text_format": {
                    "type": "string"
                  },
                  "text_format_source": {
                    "type": "object",
                    "properties": {
                      "filename": {
                        "type": "string"
                      }
                    },
                    "additionalProperties": false
                  }
                },
                "additionalProperties": false
              },
              "on_status_code": {
                "type": "integer",
                "maximum": 599,
                "minimum": 400
              }
            },
            "additionalProperties": false
          }
        },
        "grpc": {
          "type": "boolean"
        },
        "headers": {
          "type": "object",
          "additionalProperties": {
            "description": "BoolOrString is a type that can hold a Boolean or a string.",
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "boolean"
              }
            ]
          }
        },
        "host": {
          "type": "string"
        },
        "host_redirect": {
          "type": "boolean"
        },
        "host_regex": {
          "type": "boolean"
        },
        "host_rewrite": {
          "type": "string"
        },
        "idle_timeout_ms": {
          "type": "integer"
        },
        "keepalive": {
          "type": "object",
          "properties": {
            "idle_time": {
              "type": "integer"
            },
            "interval": {
              "type": "integer"
            },
            "probes": {
              "type": "integer"
            }
          },
          "additionalProperties": false
        },
        "labels": {
          "type": "object",
          "additionalProperties": {
            "description": "A MappingLabelGroupsArray is an array of MappingLabelGroups. I know, complex.",
            "type": "array",
            "items": {
              "description": "A MappingLabelGroup is a single element of a MappingLabelGroupsArray: a second map, where the key is a human-readable name that identifies the group.",
              "type": "object",
              "additionalProperties": {
                "description": "A MappingLabelsArray is the value in the MappingLabelGroup: an array of label specifiers.",
                "type": "array",
                "items": {
                  "description": "A MappingLabelSpecifier (finally!) defines a single label. There are multiple kinds of label, so this is more complex than we'd like it to be. See the remarks about schema on custom types in `./common.go`."
                }
              }
            }
          }
        },
        "load_balancer": {
          "type": "object",
          "required": [
            "policy"
          ],
          "properties": {
            "cookie": {
              "type": "object",
              "required": [
                "name"
              ],
              "properties": {
                "name": {
                  "type": "string"
                },
                "path": {
                  "type": "string"
                },
                "ttl": {
                  "type": "string"
                }
              },
              "additionalProperties": false
            },
            "header": {
              "type": "string"
            },
            "policy": {
              "type": "string",
              "enum": [
                "round_robin",
                "ring_hash",
                "maglev",
                "least_request"
              ]
            },
            "source_ip": {
              "type": "boolean"
            }
          },
          "additionalProperties": false
        },
        "method": {
          "type": "string"
        },
        "method_regex": {
          "type": "boolean"
        },
        "modules": {
          "type": "array",
          "items": {
            "type": "object"
          }
        },
        "outlier_detection": {
          "type": "string"
        },
        "path_redirect": {
          "type": "string"
        },
        "precedence": {
          "type": "integer"
        },
        "prefix": {
          "type": "string"
        },
        "prefix_exact": {
          "type": "boolean"
        },
        "prefix_redirect": {
          "type": "string"
        },
        "prefix_regex": {
          "type": "boolean"
        },
        "priority": {
          "type": "string"
        },
        "query_parameters": {
          "type": "object",
          "additionalProperties": {
            "description": "BoolOrString is a type that can hold a Boolean or a string.",
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "boolean"
              }
            ]
          }
        },
        "redirect_response_code": {
          "type": "integer",
          "enum": [
            301,
            302,
            303,
            307,
            308
          ]
        },
        "regex_headers": {
          "type": "object",
          "additionalProperties": {
            "description": "BoolOrString is a type that can hold a Boolean or a string.",
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "boolean"
              }
            ]
          }
        },
        "regex_query_parameters": {
          "type": "object",
          "additionalProperties": {
            "description": "BoolOrString is a type that can hold a Boolean or a string.",
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "boolean"
              }
            ]
          }
        },
        "regex_redirect": {
          "type": "object",
          "additionalProperties": {
            "description": "BoolOrString is a type that can hold a Boolean or a string.",
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "boolean"
              }
            ]
          }
        },
        "regex_rewrite": {
          "type": "object",
          "additionalProperties": {
            "description": "BoolOrString is a type that can hold a Boolean or a string.",
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "boolean"
              }
            ]
          }
        },
        "remove_request_headers": {
          "items": {
            "type": "string"
          },
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array"
            }
          ]
        },
        "remove_response_headers": {
          "items": {
            "type": "string"
          },
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array"
            }
          ]
        },
        "resolver": {
          "type": "string"
        },
        "respect_dns_ttl": {
          "type": "boolean"
        },
        "retry_policy": {
          "type": "object",
          "properties": {
            "num_retries": {
              "type": "integer"
            },
            "per_try_timeout": {
              "type": "string"
            },
            "retry_on": {
              "type": "string",
              "enum": [
                "5xx",
                "gateway-error",
                "connect-failure",
                "retriable-4xx",
                "refused-stream",
                "retriable-status-codes"
              ]
            }
          },
          "additionalProperties": false
        },
        "rewrite": {
          "type": "string"
        },
        "service": {
          "type": "string"
        },
        "shadow": {
          "type": "boolean"
        },
        "timeout_ms": {
          "type": "integer"
        },
        "tls": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "boolean"
            }
          ]
        },
        "use_websocket": {
          "type": "boolean"
        },
        "weight": {
          "type": "integer"
        }
      },
      "additionalProperties": false
    },
    "status": {
      "type": "object",
      "properties": {
        "reason": {
          "type": "string"
        },
        "state": {
          "type": "string",
          "enum": [
            "",
            "Inactive",
            "Running"
          ]
        }
      },
      "additionalProperties": false
    }
  }
}
