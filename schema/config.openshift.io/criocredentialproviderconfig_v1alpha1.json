{
  "description": "CRIOCredentialProviderConfig holds cluster-wide singleton resource configurations for CRI-O credential provider, the name of this instance is \"cluster\". CRI-O credential provider is a binary shipped with CRI-O that provides a way to obtain container image pull credentials from external sources.\nFor example, it can be used to fetch mirror registry credentials from secrets resources in the cluster within the same namespace the pod will be running in.\nCRIOCredentialProviderConfig configuration specifies the pod image sources registries that should trigger the CRI-O credential provider execution, which will resolve the CRI-O mirror configurations and obtain the necessary credentials for pod creation.\nNote: Configuration changes will only take effect after the kubelet restarts, which is automatically managed by the cluster during rollout.\n\nThe resource is a singleton named \"cluster\".\n\nCompatibility level 4: No compatibility is provided, the API can change at any point for any reason. These capabilities should not be used by applications needing long term support.",
  "type": "object",
  "required": [
    "spec"
  ],
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object.\nServers should convert recognized schemas to the latest internal value, and\nmay reject unrecognized values.\nMore info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": "string"
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents.\nServers may infer this from the endpoint the client submits requests to.\nCannot be updated.\nIn CamelCase.\nMore info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": "string"
    },
    "metadata": {
      "type": "object"
    },
    "spec": {
      "description": "spec defines the desired configuration of the CRI-O Credential Provider.\nThis field is required and must be provided when creating the resource.",
      "type": "object",
      "minProperties": 0,
      "properties": {
        "matchImages": {
          "description": "matchImages is a list of string patterns used to determine whether\nthe CRI-O credential provider should be invoked for a given image. This list is\npassed to the kubelet CredentialProviderConfig, and if any pattern matches\nthe requested image, CRI-O credential provider will be invoked to obtain credentials for pulling\nthat image or its mirrors.\nDepending on the platform, the CRI-O credential provider may be installed alongside an existing platform specific provider.\nConflicts between the existing platform specific provider image match configuration and this list will be handled by\nthe following precedence rule: credentials from built-in kubelet providers (e.g., ECR, GCR, ACR) take precedence over those\nfrom the CRIOCredentialProviderConfig when both match the same image.\nTo avoid uncertainty, it is recommended to avoid configuring your private image patterns to overlap with\nexisting platform specific provider config(e.g., the entries from https://github.com/openshift/machine-config-operator/blob/main/templates/common/aws/files/etc-kubernetes-credential-providers-ecr-credential-provider.yaml).\nYou can check the resource's Status conditions\nto see if any entries were ignored due to exact matches with known built-in provider patterns.\n\nThis field is optional, the items of the list must contain between 1 and 50 entries.\nThe list is treated as a set, so duplicate entries are not allowed.\n\nFor more details, see:\nhttps://kubernetes.io/docs/tasks/administer-cluster/kubelet-credential-provider/\nhttps://github.com/cri-o/crio-credential-provider#architecture\n\nEach entry in matchImages is a pattern which can optionally contain a port and a path. Each entry must be no longer than 512 characters.\nWildcards ('*') are supported for full subdomain labels, such as '*.k8s.io' or 'k8s.*.io',\nand for top-level domains, such as 'k8s.*' (which matches 'k8s.io' or 'k8s.net').\nA global wildcard '*' (matching any domain) is not allowed.\nWildcards may replace an entire hostname label (e.g., *.example.com), but they cannot appear within a label (e.g., f*oo.example.com) and are not allowed in the port or path.\nFor example, 'example.*.com' is valid, but 'exa*mple.*.com' is not.\nEach wildcard matches only a single domain label,\nso '*.io' does **not** match '*.k8s.io'.\n\nA match exists between an image and a matchImage when all of the below are true:\nBoth contain the same number of domain parts and each part matches.\nThe URL path of an matchImages must be a prefix of the target image URL path.\nIf the matchImages contains a port, then the port must match in the image as well.\n\nExample values of matchImages:\n- 123456789.dkr.ecr.us-east-1.amazonaws.com\n- *.azurecr.io\n- gcr.io\n- *.*.registry.io\n- registry.io:8080/path",
          "type": "array",
          "maxItems": 50,
          "minItems": 1,
          "items": {
            "description": "MatchImage is a string pattern used to match container image registry addresses.\nIt must be a valid fully qualified domain name with optional wildcard, port, and path.\nThe maximum length is 512 characters.\n\nWildcards ('*') are supported for full subdomain labels and top-level domains.\nEach entry can optionally contain a port (e.g., :8080) and a path (e.g., /path).\nWildcards are not allowed in the port or path portions.\n\nExamples:\n- \"registry.io\" - matches exactly registry.io\n- \"*.azurecr.io\" - matches any single subdomain of azurecr.io\n- \"registry.io:8080/path\" - matches with specific port and path prefix",
            "type": "string",
            "maxLength": 512,
            "minLength": 1,
            "x-kubernetes-validations": [
              {
                "rule": "self != '*'",
                "message": "global wildcard '*' is not allowed"
              },
              {
                "rule": "self.matches('^((\\\\*|[a-z0-9]([a-z0-9-]*[a-z0-9])?)(\\\\.(\\\\*|[a-z0-9]([a-z0-9-]*[a-z0-9])?))*)(:[0-9]+)?(/[-a-z0-9._/]*)?$')",
                "message": "invalid matchImages value, must be a valid fully qualified domain name in lowercase with optional wildcard, port, and path"
              }
            ]
          },
          "x-kubernetes-list-type": "set"
        }
      },
      "additionalProperties": false
    },
    "status": {
      "description": "status represents the current state of the CRIOCredentialProviderConfig.\nWhen omitted or nil, it indicates that the status has not yet been set by the controller.\nThe controller will populate this field with validation conditions and operational state.",
      "type": "object",
      "minProperties": 1,
      "properties": {
        "conditions": {
          "description": "conditions represent the latest available observations of the configuration state.\nWhen omitted, it indicates that no conditions have been reported yet.\nThe maximum number of conditions is 16.\nConditions are stored as a map keyed by condition type, ensuring uniqueness.\n\nExpected condition types include:\n\"Validated\": indicates whether the matchImages configuration is valid",
          "type": "array",
          "maxItems": 16,
          "minItems": 1,
          "items": {
            "description": "Condition contains details for one aspect of the current state of this API Resource.",
            "type": "object",
            "required": [
              "lastTransitionTime",
              "message",
              "reason",
              "status",
              "type"
            ],
            "properties": {
              "lastTransitionTime": {
                "description": "lastTransitionTime is the last time the condition transitioned from one status to another.\nThis should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.",
                "type": "string",
                "format": "date-time"
              },
              "message": {
                "description": "message is a human readable message indicating details about the transition.\nThis may be an empty string.",
                "type": "string",
                "maxLength": 32768
              },
              "observedGeneration": {
                "description": "observedGeneration represents the .metadata.generation that the condition was set based upon.\nFor instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date\nwith respect to the current state of the instance.",
                "type": "integer",
                "format": "int64",
                "minimum": 0
              },
              "reason": {
                "description": "reason contains a programmatic identifier indicating the reason for the condition's last transition.\nProducers of specific condition types may define expected values and meanings for this field,\nand whether the values are considered a guaranteed API.\nThe value should be a CamelCase string.\nThis field may not be empty.",
                "type": "string",
                "maxLength": 1024,
                "minLength": 1,
                "pattern": "^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$"
              },
              "status": {
                "description": "status of the condition, one of True, False, Unknown.",
                "type": "string",
                "enum": [
                  "True",
                  "False",
                  "Unknown"
                ]
              },
              "type": {
                "description": "type of condition in CamelCase or in foo.example.com/CamelCase.",
                "type": "string",
                "maxLength": 316,
                "pattern": "^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$"
              }
            },
            "additionalProperties": false
          },
          "x-kubernetes-list-map-keys": [
            "type"
          ],
          "x-kubernetes-list-type": "map"
        }
      },
      "additionalProperties": false
    }
  },
  "x-kubernetes-validations": [
    {
      "rule": "self.metadata.name == 'cluster'",
      "message": "criocredentialproviderconfig is a singleton, .metadata.name must be 'cluster'"
    }
  ]
}
